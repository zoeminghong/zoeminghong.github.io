<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[æŽ¨èä¹¦ç±]]></title>
    <url>%2F2017%2F12%2F21%2Fbooks%2F</url>
    <content type="text"><![CDATA[åªæƒ³ç»™ä½ æœ€å¥½çš„ AIæ™ºèƒ½æ—¶ä»£ï¼šå¤§æ•°æ®ä¸Žæ™ºèƒ½é©å‘½é‡æ–°å®šä¹‰æœªæ¥ æ·±åº¦å­¦ä¹ ]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ç½‘å…³è°ƒä¼˜æŒ‡å¯¼ä¹¦]]></title>
    <url>%2F2017%2F12%2F21%2Fspringcloud%E7%BD%91%E5%85%B3%E8%B0%83%E4%BC%9820171221%2F</url>
    <content type="text"><![CDATA[ç”±äºŽæœ€è¿‘åœ¨ä½¿ç”¨Spring Cloudçš„Zuulç½‘å…³çš„è¿‡ç¨‹ä¸­ï¼Œå‘çŽ°è¶…æ—¶çš„å¯èƒ½æ€§å¾ˆå¤šï¼Œå‡ºäºŽæ€§èƒ½çš„è°ƒä¼˜ï¼Œæ‰€æœ‰æƒ³é€šè¿‡æµ‹è¯•ï¼Œäº†è§£ä¸€äº›å‚æ•°çš„ä½œç”¨ã€‚åœ¨æ–‡ç« æœ€åŽè´´ä¸ŠæŽ¨èæ–¹æ¡ˆã€‚ å…ˆçœ‹ä¸€ä¸ªé—®é¢˜ï¼š execution.isolation.thread.timeoutInMilliseconds åˆ°è¾¾å½“å‰æ—¶é—´åŽï¼Œä¼šè§¦å‘ç†”æ–­ï¼Œè°ƒç”¨fallbackæ–¹æ³•ï¼Œå¦‚æžœä¸å­˜åœ¨fallbackæ–¹æ³•ï¼Œä¼šæŠ¥é”™è¯¯ 12345&#123; "code": "500", "message": "[Internal Server Error]getStores timed-out and fallback failed.", "body": null&#125; ç»“æžœï¼š 123com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.client.ClientException: nullCaused by: java.net.SocketTimeoutException: Read timed out è¯´æ˜Žï¼šä¸‹é¢zuulæ˜¯ç½‘å…³é…ç½®ï¼Œserviceæ˜¯ç½‘å…³ä»£ç†ä¸‹çš„ä¸€ä¸ªæœåŠ¡ Case1zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 2000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 1000 serviceï¼Œå»¶æ—¶2s ç¬¬ä¸€æ¬¡è®¿é—®çš„æ—¶å€™ 12com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.client.ClientException: Load balancer does not have available server for client: hystrix-example ç¬¬äºŒæ¬¡è®¿é—®çš„æ—¶å€™ 12345678910com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.hystrix.exception.HystrixRuntimeException: hystrix-example timed-out and no fallback available.Caused by: java.util.concurrent.TimeoutException: null###result&#123; &quot;code&quot;: &quot;500&quot;, &quot;message&quot;: &quot;[Internal Server Error]TIMEOUT&quot;, &quot;body&quot;: null&#125; Case2zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 4000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 1000 serviceï¼Œå»¶æ—¶2s 12345678910com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.hystrix.exception.HystrixRuntimeException: hystrix-example timed-out and no fallback available.Caused by: java.util.concurrent.TimeoutException: null###result&#123; &quot;code&quot;: &quot;500&quot;, &quot;message&quot;: &quot;[Internal Server Error]TIMEOUT&quot;, &quot;body&quot;: null&#125; Case3zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 4000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 1000 serviceï¼Œå»¶æ—¶0.5s æ­£å¸¸ Case4zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 4000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 1000 serviceï¼Œå»¶æ—¶2s 123456789hystrix: command: default: execution: timeout: enabled: true isolation: thread: timeoutInMilliseconds: 60000 12345678910com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.hystrix.exception.HystrixRuntimeException: hystrix-example timed-out and no fallback available.Caused by: java.util.concurrent.TimeoutException: null###result&#123; &quot;code&quot;: &quot;500&quot;, &quot;message&quot;: &quot;[Internal Server Error]TIMEOUT&quot;, &quot;body&quot;: null&#125; ç»“è®ºï¼š hystrixè¶…æ—¶æ—¶é—´åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®æ—¶æ— æ•ˆçš„ 123456789hystrix: command: default: execution: timeout: enabled: true isolation: thread: timeoutInMilliseconds: 60000 hystrixé»˜è®¤è¶…æ—¶æ—¶é—´å››1sï¼Œå¦‚æžœæœåŠ¡æ‰§è¡Œæ—¶é—´è¶…è¿‡1så°±ä¼šè¿›è¡Œç†”æ–­ï¼Œå¦‚æžœæ²¡æœ‰fallbackï¼Œå°±ä¼šå¯¼è‡´TIMEOUTé”™è¯¯ Case5zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 500 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 2000 serviceï¼Œå»¶æ—¶0.5s æ­£å¸¸ Case6zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 400 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 400 serviceï¼Œå»¶æ—¶0.5s 12345678910com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.client.ClientException: nullCaused by: java.lang.RuntimeException: java.net.SocketTimeoutException: Read timed outCaused by: java.net.SocketTimeoutException: Read timed out####reuslt&#123; &quot;code&quot;: &quot;500&quot;, &quot;message&quot;: &quot;[Internal Server Error]GENERAL&quot;, &quot;body&quot;: null&#125; Case7zuulï¼Œå»¶æ—¶3s 1234ribbon: ConnectTimeout: 400 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 600 serviceï¼Œå»¶æ—¶0.5s æ­£å¸¸ ç»“è®ºï¼š ribbon.readtimeoutè¶…æ—¶ä¼šå¯¼è‡´SocketTimeoutException: Read timed outé—®é¢˜ã€‚ Case8zuulï¼Œå»¶æ—¶3s 12345678910ribbon: ConnectTimeout: 1000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 20000zuul: host: # è¿žæŽ¥è¶…æ—¶æ—¶é—´ connect-timeout-millis: 3000 # å“åº”è¶…æ—¶æ—¶é—´ socket-timeout-millis: 100 serviceï¼Œå»¶æ—¶0.5s æ­£å¸¸ ç»“è®ºï¼šsocket-timeout-milliså¯¹è¯·æ±‚æ—¶é—´æ²¡æœ‰å½±å“ Case9zuulï¼Œå»¶æ—¶3s 12345678910111213hystrix: command: default: execution: isolation: thread: # è¯·æŒ‰å®žé™…æƒ…å†µè®¾ç½®é…ç½® timeoutInMilliseconds: 600ribbon: ConnectTimeout: 1000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 20000 serviceï¼Œå»¶æ—¶0.5s æ­£å¸¸ Case10zuulï¼Œå»¶æ—¶3s 12345678910111213hystrix: command: default: execution: isolation: thread: # è¯·æŒ‰å®žé™…æƒ…å†µè®¾ç½®é…ç½® timeoutInMilliseconds: 400ribbon: ConnectTimeout: 1000 # è¯·æŒ‰å®žé™…æƒ…å†µé…ç½® ReadTimeout: 20000 serviceï¼Œå»¶æ—¶0.5s 12345678910com.netflix.zuul.exception.ZuulException: Forwarding errorCaused by: com.netflix.hystrix.exception.HystrixRuntimeException: hystrix-example timed-out and no fallback available.Caused by: java.util.concurrent.TimeoutException: null###result&#123; &quot;code&quot;: &quot;500&quot;, &quot;message&quot;: &quot;[Internal Server Error]TIMEOUT&quot;, &quot;body&quot;: null&#125; ç»“è®ºï¼š Hystrixçš„è¶…æ—¶æ—¶é—´æ˜¯å¯¹æ¬¡èŠ‚ç‚¹çš„è¯·æ±‚æ—¶é—´çš„è¿›è¡Œç†”æ–­ zuulï¼Œå»¶æ—¶3s serviceï¼Œå»¶æ—¶0.5s 12Caused by: com.netflix.hystrix.exception.HystrixRuntimeException: hystrix-example could not be queued for execution and no fallback available.error 500 : REJECTED_THREAD_EXECUTION æ€»ç»“ï¼š Hystrixçš„è¶…æ—¶é…ç½®æ˜¯æœåŠ¡è°ƒç”¨å…¶ä»–æœåŠ¡æ—¶å€™ï¼Œæœ‰æ•ˆï¼Œå¯¹æœåŠ¡è‡ªèº«æ˜¯æ²¡æœ‰ä½œç”¨ã€‚e.g. A-&gt;Bï¼Œæ˜¯å¯¹Aè¯·æ±‚Bè¿™ä¸ªè¯·æ±‚æœ‰æ•ˆï¼Œå¯¹è®¿é—®Aæœ¬èº«çš„è¯·æ±‚æ˜¯æ²¡æœ‰ä½œç”¨çš„ã€‚ ç½‘å…³åœ¨å¯åŠ¨åˆæœŸï¼Œä¼šå­˜åœ¨ä¸ç¨³å®šï¼Œç”šè‡³å­˜åœ¨é©¬ä¸Šç†”æ–­çš„å¯èƒ½ï¼Œä½†åœ¨ä¹‹åŽï¼Œä¼šæ¢å¤æ­£å¸¸æ°´å¹³ã€‚ com.netflix.client.ClientException: Load balancer does not have available server for client: hystrix-exampleæ˜¯æœåŠ¡å¯åŠ¨è¿˜æ²¡å®Œå…¨ï¼Œæˆ–è€…ï¼Œå¦‚æžœä½¿ç”¨äº†ribbon.eureka.eabled=falseä¹Ÿä¼šå‡ºçŽ°è¿™ä¸ªé—®é¢˜ã€‚ æœåŠ¡å¯åŠ¨æ—¶å€™ï¼ŒæŽ¨èç½‘å…³æœ€åŽå¯åŠ¨ æŽ¨èä½¿ç”¨æ–¹æ¡ˆï¼š 123456789101112131415161718192021222324252627zuul: okhttp: enabled: true # ä½¿ç”¨okhttpæ–¹å¼è¯·æ±‚ï¼Œæ­£å¸¸æ¥è¯´okhttpæ¯”è¾ƒé€Ÿåº¦å¿«ä¸€ç‚¹ semaphore: max-semaphores: 500 # å¹¶å‘å¤„ç†æ•°ï¼Œå€¼è¶Šå¤§è¶Šå¥½ï¼Œä½†åˆ°åˆ°è¾¾ä¸€ä¸ªä¸´ç•Œç‚¹ä¹‹åŽï¼Œå°±ä¸ä¼šæé«˜å“åº”é€Ÿåº¦äº† host: socket-timeout-millis: 30000 # socketè¶…æ—¶æ—¶é—´ï¼Œå¦‚æžœä½¿ç”¨service-idæ–¹å¼æ˜¯ä¸ç”¨é…ç½®çš„ connect-timeout-millis: 30000 # è¿žæŽ¥æ—¶é—´semaphores max-total-connections: 5000 # æœ€å¤§è¿žæŽ¥æ•°ï¼Œå€¼è¶Šå¤§è¶Šå¥½ï¼Œä½†åˆ°åˆ°è¾¾ä¸€ä¸ªä¸´ç•Œç‚¹ä¹‹åŽï¼Œå°±ä¸ä¼šæé«˜å“åº”é€Ÿåº¦äº† max-per-route-connections: 5 # æ¯ä¸ªrouteræœ€å¤§è¿žæŽ¥æ•°ï¼Œé™ä½Žè¯·æ±‚æ—¶é—´ï¼Œè¶Šå°è¶Šå¥½ï¼Œä½†è¾¾åˆ°ä¸€å®šå±‚çº§å°±æ²¡ç”¨äº†hystrix: command: default: execution: isolation: thread: timeoutInMilliseconds: 30000 # Hystrixè¶…æ—¶æ—¶é—´ strategy: THREADribbon: ReadTimeout: 20000 # å¤„ç†æ—¶é—´ ConnectTimeout: 20000 # è¿žæŽ¥æ—¶é—´ MaxAutoRetries: 0 #æœ€å¤§è‡ªåŠ¨é‡è¯•æ¬¡æ•° MaxAutoRetriesNextServer: 1 # æ¢å®žä¾‹é‡è¯•æ¬¡æ•° MaxTotalHttpConnections: 2000 # æœ€å¤§httpè¿žæŽ¥æ•°ï¼Œè¶Šå¤§è¶Šå¥½ï¼Œä½†åˆ°åˆ°è¾¾ä¸€ä¸ªä¸´ç•Œç‚¹ä¹‹åŽï¼Œå°±ä¸ä¼šæé«˜å“åº”é€Ÿåº¦äº† MaxConnectionsPerHost: 1000 # æ¯ä¸ªhostè¿žæŽ¥æ•° æ³¨æ„è¯´æ˜Žï¼š timeout-in-millisecondsè¿™æ ·ç¼–å†™æ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œéœ€è¦æ”¹ä¸ºtimeoutInMillisecondsï¼Œèµ·åˆè®¤ä¸ºæ˜¯Springçš„BUGï¼Œä¹‹åŽï¼Œå‘çŽ°ç”±äºŽdefaultæ˜¯ä¸€ä¸ªkeyï¼Œæ˜¯ä¸€ä¸ªMapç±»åž‹ï¼Œä¾ç…§æºç ä¸­ä½¿ç”¨çš„æ˜¯timeoutInMillisecondsï¼Œæ‰€ä»¥å¿…é¡»timeoutInMillisecondsã€‚ æ‹“å±•å­¦ä¹ ï¼šhttp://www.spring4all.com/article/351 http://m635674608.iteye.com/blog/2389666 http://cloud.spring.io/spring-cloud-netflix/single/spring-cloud-netflix.html#how-to-configure-hystrix-thread-pools http://tietang.wang/2016/02/25/hystrix/Hystrix%E5%8F%82%E6%95%B0%E8%AF%A6%E8%A7%A3/ https://github.com/spring-cloud/spring-cloud-netflix/issues/327 zuulæ€§èƒ½æµ‹è¯•]]></content>
      <tags>
        <tag>spring-cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Bookmark]]></title>
    <url>%2F2017%2F12%2F14%2Fbookmark%2F</url>
    <content type="text"><![CDATA[é«˜è´¨é‡ç½‘ç«™æ•´åˆåˆ°è¿™é‡Œ~~ å‰ç«¯ES6ES6 æ ¸å¿ƒç‰¹æ€§ ES6åœ¨WebStromä¸­çš„ç›¸å…³é…ç½® å‰ç«¯åŸºç¡€è¿›é˜¶ï¼ˆåä¸‰ï¼‰ï¼šé€å½»æŽŒæ¡Promiseçš„ä½¿ç”¨ï¼Œè¯»è¿™ç¯‡å°±å¤Ÿäº† NodeNodeJSå…¥é—¨ WebpackWebpackå‚»ç“œå¼æŒ‡å—ï¼ˆä¸€ï¼‰ Webpackå‚»ç“œæŒ‡å—ï¼ˆäºŒï¼‰å¼€å‘å’Œéƒ¨ç½²æŠ€å·§ å…¥é—¨Webpackï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº† webpack-dev-serverä»‹ç»åŠé…ç½® webpack æ’ä»¶ï¼š html-webpack-plugin ä½¿ç”¨webpackæž„å»ºå¤šé¡µé¢åº”ç”¨ gulp + webpack æž„å»ºå¤šé¡µé¢å‰ç«¯é¡¹ç›® webpackå…¥å‘ä¹‹æ—…ï¼ˆä¸€ï¼‰ä¸æ˜¯å¼€å§‹çš„å¼€å§‹ webpackå…¥å‘ä¹‹æ—…ï¼ˆäºŒï¼‰loaderå…¥é—¨ webpackå…¥å‘ä¹‹æ—…ï¼ˆä¸‰ï¼‰webpack.configå…¥é—¨ webpackå…¥å‘ä¹‹æ—…ï¼ˆå››ï¼‰æ‰¬å¸†èµ·èˆª webpackå…¥å‘ä¹‹æ—…ï¼ˆäº”ï¼‰åŠ è½½vueå•æ–‡ä»¶ç»„ä»¶ webpackå…¥å‘ä¹‹æ—…ï¼ˆå…­ï¼‰é…åˆvue-routerå®žçŽ°SPA webpackä½¿ç”¨ä¼˜åŒ– æ‰‹æŠŠæ‰‹æ·±å…¥ç†è§£ webpack dev middleware åŽŸç†èˆ‡ç›¸é—œ plugins å…¥é—¨Webpackï¼Œçœ‹è¿™ç¯‡å°±å¤Ÿäº† è¯·ç»ƒå®Œè¿™16ä¸ªwebpackå°ä¾‹å­ FullPagejQueryå…¨å±æ»šåŠ¨æ’ä»¶fullPage.js FullPage.jså…¨å±æ»šåŠ¨æ’ä»¶å­¦ä¹ æ€»ç»“ Vueå»¶è¿ŸåŠ è½½(Lazyload)ä¸‰ç§å®žçŽ°æ–¹å¼ å›¾è§£ Flexbox 2 - æ·±å…¥ç†è§£ Vueä¸­router-linkä»‹ç» æ‰‹æŠŠæ‰‹æ•™ä½ å°è£…ä¸€ä¸ªvue component å…¶ä»–ä½ ä¸çŸ¥é“çš„ XMLHttpRequest JAVAJDKJava8_Stream 10ç§ç®€å•çš„Javaæ€§èƒ½ä¼˜åŒ– Javaä¸­Exceptionçš„ç§ç±» è°åœ¨å…³å¿ƒtoStringçš„æ€§èƒ½ï¼Ÿ æ·±å…¥ç†è§£Javaï¼šå†…éƒ¨ç±» ã€Šæ·±å…¥ç†è§£Javaé›†åˆæ¡†æž¶ã€‹ç³»åˆ—æ–‡ç« ï¼ˆå·²å…¨éƒ¨æ›´æ–°å®Œæ¯•ï¼‰ åŽŸç , åç , è¡¥ç  è¯¦è§£ SpringframeWork Springç¼“å­˜æ³¨è§£@Cache,@CachePut , @CacheEvictï¼Œ@CacheConfigä½¿ç”¨ æ·±å…¥ç†è§£åˆ†å¸ƒå¼äº‹åŠ¡ springMVCä¸­æ–‡æ–‡æ¡£ Microserviceå¾®æœåŠ¡ï¼ˆMicroserviceï¼‰é‚£ç‚¹äº‹ Dubbo åšå®¢ Spring Boot[Spring Boot ç³»åˆ—] é›†æˆmavenå’ŒSpring bootçš„profile ä¸“é¢˜ SpringBootä¹‹redis Springbootæœ€å…¨é…ç½®æ–‡ä»¶ Springboot å…¥é—¨ Spring-Boot-Reference-Guideä¸­æ–‡ Spring CloudSpring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆä¸€ï¼‰æœåŠ¡æ³¨å†Œä¸Žå‘çŽ° Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆäºŒï¼‰æœåŠ¡æ¶ˆè´¹è€… Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆä¸‰ï¼‰æ–­è·¯å™¨ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆå››ï¼‰åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆå››ï¼‰åˆ†å¸ƒå¼é…ç½®ä¸­å¿ƒï¼ˆç»­ï¼‰ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆäº”ï¼‰æœåŠ¡ç½‘å…³ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆå…­ï¼‰é«˜å¯ç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆä¸ƒï¼‰æ¶ˆæ¯æ€»çº¿ Spring Cloudæž„å»ºå¾®æœåŠ¡æž¶æž„ï¼ˆä¸ƒï¼‰æ¶ˆæ¯æ€»çº¿ï¼ˆç»­ï¼šKafkaï¼‰ ä½¿ç”¨Spring Cloudä¸ŽDockerå®žæˆ˜å¾®æœåŠ¡ å²ä¸Šæœ€ç®€å•çš„SpringCloudæ•™ç¨‹: dockeréƒ¨ç½²spring cloudé¡¹ç›® spring cloud config è¯¦è§£ RestTemplateçš„é€†è¢­ä¹‹è·¯ï¼Œä»Žå‘é€è¯·æ±‚åˆ°è´Ÿè½½å‡è¡¡ Spring RestTemplateä¸­å‡ ç§å¸¸è§çš„è¯·æ±‚æ–¹å¼ Spring Cloudæºç åˆ†æžï¼ˆäºŒï¼‰Ribbon MybatisSpringBoot å¿«é€Ÿæ•´åˆMybatisï¼ˆåŽ»XMLåŒ–+æ³¨è§£è¿›é˜¶ï¼‰ å…¶ä»–OAuth 2.0 è®¤è¯çš„åŽŸç†ä¸Žå®žè·µ ä¼˜ç§€ç¨‹åºå‘˜ä¸å¾—ä¸çŸ¥é“çš„20ä¸ªä½è¿ç®—æŠ€å·§ æ•°æ®åº“æ•°æ®åº“è¯»å†™åˆ†ç¦»å’Œè´Ÿè½½å‡è¡¡ç­–ç•¥ Mysqlä¸»ä»ŽJavaç«¯å®žçŽ° H2æ•°æ®åº“å‡½æ•°åŠæ•°æ®ç±»åž‹æ¦‚è¿° MySQLå…¥é—¨æ•™ç¨‹ å¤§æ•°æ®å¤§æ•°æ®å…¥é—¨ æœºå™¨å­¦ä¹ å´æ©è¾¾æ–¯å¦ç¦æœºå™¨å­¦ä¹  æŽ¨èäº› AI å­¦ä¹ çš„ä¹¦ç±å’Œèµ„æ–™ PPTä¼˜è´¨å†…å®¹Open-Source License iconfont åšå®¢ç¤¾åŒºSpringCloudä¸­å›½ç¤¾åŒº ImportNew Spring Bootç³»åˆ—æ–‡ç«  å¾®æœåŠ¡ç­‰æž¶æž„åˆ†äº« é˜¿é‡Œå·´å·´ä¸­é—´ä»·å›¢é˜Ÿåšå®¢ æŽ˜é‡‘é«˜è´¨é‡æŠ€æœ¯ç¤¾åŒº çƒ­é“¾ itèµ„è®¯ï¼Œèšåˆ æŠ€æœ¯å…¬ä¼—å·èšåˆ csdn æžå®¢å¤´æ¡æŠ€æœ¯ é˜¿é‡Œå·´å·´æŠ€æœ¯æ²™é¾™ https://wanqu.co/ å”¯å“ä¼šæŠ€æœ¯å¤§ç‰› å°ç±³ç¨‹åºå‘˜ï¼ˆå°ç±³å‘å±•é‡Œç¨‹æŠ€æœ¯ï¼‰ java jvmæŠ€æœ¯ç­‰ å¾®ä¿¡èšåˆï¼Œå­¦ä¹ .å·¥å…·æ ç›® ç¾Žå›¢æŠ€æœ¯åšå®¢ï¼Œå¤§æ‰¹é‡è®¢å•ç›¸å…³ ibmä¸­å›½javaï¼Œé«˜è´¨é‡åšå®¢ å¼ å¼€æ¶›åšå®¢ï¼Œspringç­‰äº¬ä¸œæŠ€æœ¯ é˜¿é‡ŒmysqlæŠ€æœ¯ä¸“å®¶ é˜¿é‡Œæ•°æ®åº“å†…æ ¸æœˆæŠ¥ è®¡ç®—æœºä¹¦ç±ç»å…¸å®žæˆ˜ç³»åˆ—å’ŒåŠ¨ç‰©ä¹¦ é»‘å®¢å¤§ä¼šèµ„æ–™ çº¯æ´çš„å¾®ç¬‘ ä¼˜ç§€é¡¹ç›®SpringBoot&amp;&amp;Cloud SpringBootå’ŒSpringCloudå­¦ä¹  go-library 30åˆ†é’Ÿå…¥é—¨ hsweb ä¸€ä¸ªç”¨äºŽå¿«é€Ÿæ­å»ºä¼ä¸šåŽå°ç®¡ç†ç³»ç»Ÿçš„åŸºç¡€é¡¹ç›®,é›†æˆä¸€æ½å­ä¾¿æ·åŠŸèƒ½å¦‚:é€šç”¨å¢žåˆ æ”¹æŸ¥ï¼Œåœ¨çº¿ä»£ç ç”Ÿæˆï¼Œæƒé™ç®¡ç†(å¯æŽ§åˆ¶åˆ°åˆ—å’Œè¡Œ)ï¼ŒåŠ¨æ€å¤šæ•°æ®æºåˆ†å¸ƒå¼äº‹åŠ¡ï¼ŒåŠ¨æ€è„šæœ¬ï¼ŒåŠ¨æ€å®šæ—¶ä»»åŠ¡ï¼Œåœ¨çº¿æ•°æ®åº“ç»´æŠ¤ç­‰ç­‰. åŸºäºŽ spring-boot,mybaits handbook æ”¾ç½®æˆ‘çš„ç¬”è®°ã€æœé›†ã€æ‘˜å½•ã€å®žè·µï¼Œä¿æŒå¥½å¥‡å¿ƒã€‚è¿™é‡Œå°±æ˜¯ä¸ªéšè®°ï¼Œæ¶‰çŒŽæŠ€æœ¯çŸ¥è¯†ç‚¹å¹¿è€Œä¸ç²¾ï¼Œä¸èƒ½ä¿è¯æ­£ç¡®ï¼Œçœ‹æ–‡éœ€è°¨æ…Žï¼ŒåŽæžœå¾ˆä¸¥é‡ã€‚]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Feign å¦‚ä½•æ”¯æŒè¿›è¡Œæ–‡ä»¶ä¸Šä¼ ]]></title>
    <url>%2F2017%2F12%2F01%2Fspringcloudfegin20171201%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘ï¼Œåˆ«çš„é¡¹ç›®ç»„æå‡ºéœ€è¦SDKï¼Œå°±åˆ©ç”¨Feignåšäº†ä¸€ä¸ªï¼Œåœ¨æ­¤æœŸé—´å‘çŽ°ä¸Šä¼ æ–‡ä»¶æ˜¯ä¸€ä¸ªå‘ï¼Œæ­£å¸¸çš„å®žçŽ°æ˜¯æ— æ³•æ”¯æŒæ–‡ä»¶ä¸Šä¼ ï¼Œéœ€è¦è¿›è¡Œå¯¹èµ„æºæœ‰ä¸€ä¸ªConvertã€‚ä¸ºäº†é¿å…å¤§å®¶åƒæˆ‘ä¸€æ ·ï¼Œç»§ç»­æŽ‰å‘é‡Œï¼Œå°±å‡ºçŽ°äº†è¿™ç¯‡æ–‡ç« çš„åˆè¡·ã€‚ å…¥é—¨ åœ¨SDKå·¥ç¨‹å¤„ï¼Œæ·»åŠ åŒ…ä¾èµ– 12345678910&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign.form&lt;/groupId&gt; &lt;artifactId&gt;feign-form&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;io.github.openfeign.form&lt;/groupId&gt; &lt;artifactId&gt;feign-form-spring&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt;&lt;/dependency&gt; åœ¨SDKå·¥ç¨‹å¤„ï¼Œåˆ›å»ºä¸€ä¸ªConfiguration 123456789101112131415161718192021import feign.codec.Encoder;import feign.form.spring.SpringFormEncoder;import org.springframework.beans.factory.ObjectFactory;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.boot.autoconfigure.web.HttpMessageConverters;import org.springframework.cloud.netflix.feign.support.SpringEncoder;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;@Configurationpublic class MultipartSupportConfig &#123; @Autowired private ObjectFactory&lt;HttpMessageConverters&gt; messageConverters; @Bean public Encoder feignFormEncoder() &#123; return new SpringFormEncoder(new SpringEncoder(messageConverters)); &#125;&#125; æœŸåˆåœ¨ç½‘ä¸Šçœ‹åˆ°æ˜¯ä½¿ç”¨ä¸‹æ–¹çš„æ³¨å…¥æ–¹å¼ï¼Œä¸€ç›´ä¸æˆåŠŸï¼Œåœ¨èµ°å¤´éƒ¨è·¯ä¸‹ï¼Œå°è¯•äº†ðŸ‘†è€…æ–¹æ¡ˆæˆåŠŸäº†ã€‚ 1234@FeignClient(name = "demo",configuration=MultipartSupportConfig.class)public interface SignBaseCommonClient &#123; &#125; ä¿®æ”¹æŽ¥å£ 1234567@FeignClient(name = "demo")public interface FeginExample &#123; @PostMapping(value = "images", consumes = MULTIPART_FORM_DATA_VALUE) Resp&lt;String&gt; uploadImage( @RequestParam MultipartFile image, @RequestParam("id") String id);&#125; @RequestPartä¸Ž@RequestParamæ•ˆæžœæ˜¯ä¸€æ ·çš„ï¼Œå¤§å®¶å°±ä¸ç”¨èŠ±æ—¶é—´åœ¨è¿™ä¸Šé¢äº†ã€‚ ä¿®æ”¹æœåŠ¡å™¨æŽ¥å£ 12345678910@RestControllerpublic class FeginServiceExample &#123; @PostMapping(value = "images", consumes = MULTIPART_FORM_DATA_VALUE) public Resp&lt;String&gt; uploadImage( @RequestParam("image") MultipartFile image, @RequestParam("id") String id, HttpServletRequest request) &#123; return Resp.success(null); &#125;&#125; åœ¨å¯åŠ¨ç±»æ·»åŠ @EnableFeignClients è¿™ä¸ªå°±ä¸ç”¨å¤šè¯´äº†å§ï¼ŒðŸ˜† å¸¸è§é—®é¢˜ï¼š HTTP Status 400 - Required request part â€˜fileâ€™ is not present è¯·æ±‚æ–‡ä»¶å‚æ•°çš„åç§°ä¸Žå®žé™…æŽ¥å£æŽ¥å—åç§°ä¸ä¸€è‡´ feign.codec.EncodeException: Could not write request: no suitable HttpMessageConverter found for request type [org.springframework.mock.web.MockMultipartFile] and content type [multipart/form-data] è½¬æ¢å™¨æ²¡æœ‰ç”Ÿæ•ˆï¼Œæ£€æŸ¥ä¸€ä¸‹MultipartSupportConfig]]></content>
      <tags>
        <tag>spring-cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Boot Adminæœ€ä½³å®žè·µ]]></title>
    <url>%2F2017%2F11%2F29%2Fspringbootadmin20171128%2F</url>
    <content type="text"><![CDATA[æœ¬æ–‡ä¸è¿›è¡ŒSpring Boot Adminå…¥é—¨çŸ¥è¯†ç‚¹è¯´æ˜Ž åœ¨Spring Boot Actuatorä¸­æä¾›å¾ˆå¤šåƒhealthã€metricsç­‰å®žæ—¶ç›‘æŽ§æŽ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿æˆ‘ä»¬éšæ—¶è·Ÿè¸ªæœåŠ¡çš„æ€§èƒ½æŒ‡æ ‡ã€‚Spring Booté»˜è®¤æ˜¯å¼€æ”¾è¿™äº›æŽ¥å£æä¾›è°ƒç”¨çš„ï¼Œé‚£ä¹ˆå°±é—®é¢˜æ¥äº†ï¼Œå¦‚æžœè¿™äº›æŽ¥å£å…¬å¼€åœ¨å¤–ç½‘ä¸­ï¼Œå¾ˆå®¹æ˜“è¢«ä¸æ³•åˆ†å­æ‰€åˆ©ç”¨ï¼Œè¿™è‚¯å®šä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æžœã€‚åœ¨è¿™é‡Œæˆ‘ä»¬æä¾›ä¸€ç§æ¯”è¾ƒå¥½çš„è§£å†³æ–¹æ¡ˆã€‚ è¢«ç›‘æŽ§çš„æœåŠ¡é…ç½® ä¸ºè¢«ä¿æŠ¤çš„httpè¯·æ±‚æ·»åŠ è¯·æ±‚å‰ç¼€ 123456management: context-path: /example-context #&lt;1&gt;eureka: instance: status-page-url-path: $&#123;management.context-path&#125;/info #&lt;2&gt; health-check-url-path: $&#123;management.context-path&#125;/health æ·»åŠ è¯·æ±‚å‰ç¼€ Spring Boot Adminåœ¨å¯åŠ¨çš„æ—¶å€™ä¼šåŽ»eurekaæ‹‰åŽ»æœåŠ¡ä¿¡æ¯ï¼Œå…¶ä¸­healthä¸Žinfoéœ€è¦ç‰¹æ®Šå¤„ç†ï¼Œè¿™ä¸¤è€…çš„åœ°å€æ˜¯æ ¹æ®status-page-url-pathå’Œhealth-check-url-pathçš„å€¼ã€‚ zuulç½‘å…³é…ç½® zuulä¿æŠ¤å†…éƒ¨æœåŠ¡httpæŽ¥å£ 12zuul: ignoredPatterns: /*/example-context/** #&lt;1&gt; è¿™é‡Œä¹‹æ‰€ä»¥ä¸æ˜¯/example-context/**ï¼Œç”±äºŽç½‘å…³å­˜åœ¨é¡¹ç›®å‰ç¼€ï¼Œéœ€è¦å¾€å‰ä¸€çº§ï¼Œå¤§å®¶å¯ä»¥å…·ä½“åœºæ™¯å…·ä½“é…ç½® Spring Boot Adminé…ç½® é…ç½®ç›‘æŽ§çš„æŒ‡æ ‡å‚æ•° 12345678910111213141516171819spring: application: name: monitor boot: admin: discovery: converter: management-context-path: /example-context # The endpoints URL prefix #&lt;1&gt; routes: endpoints: env,metrics,dump,jolokia,info,configprops,trace,logfile,refresh,flyway,liquibase,heapdump,loggers,auditevents,hystrix.stream turbine: clusters: default location: monitorturbine: aggregator: clusterConfig: default appConfig: monitor-example #&lt;2&gt; clusterNameExpression: metadata['cluster'] ä¸Žåº”ç”¨é…ç½®çš„management.context-pathç›¸åŒ æ·»åŠ éœ€è¦è¢«ç›‘æŽ§çš„åº”ç”¨Service-Idï¼Œä»¥é€—å·åˆ†éš” è®²è§£ä¸€ä¸‹ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªè¯·æ±‚å‰ç¼€ï¼Œå¯ä»¥åœ¨ç½‘å…³å¤„ä½¿ç”¨å‰ç¼€çš„æ–¹å¼å°†å…¶æŽ’é™¤ï¼Œä¹Ÿå°±æ˜¯å¤–ç½‘å°†æ— æ³•è®¿é—®è¿™äº›ç›‘æŽ§APIï¼ŒåŒæ—¶ï¼Œå†…ç½‘è¿˜æ˜¯å¯ä»¥è¿›è¡ŒåŠ å‰ç¼€çš„æ–¹å¼è¿›è¡Œè®¿é—®ï¼Œä¸ºSpring Boot Adminæä¾›äº†æ”¯æŒæ¡ä»¶ã€‚managementè¿˜æ”¯æŒportå’Œipçš„æ–¹å¼ï¼Œä½†è¿™ä¸¤ç§æ–¹å¼æœ‰å±€é™æ€§ï¼Œå¦‚æžœåœ¨åŒä¸€å°æœºå™¨ä¸Šéƒ¨ç½²å¤šä¸ªæœåŠ¡ï¼Œå°±ä¼šå­˜åœ¨ç«¯å£å ç”¨æˆ–è€…å…¶ä»–é—®é¢˜ã€‚è¿™ç§æ–¹æ¡ˆè¿˜æœ‰ä¸€ä¸ªå¥½å¤„ï¼Œä»¥ä¸Šé…ç½®ä¸€æ—¦ç¡®å®šä»¥åŽï¼Œæ‰€æœ‰æœåŠ¡éƒ½ä¸éœ€è¦è¿›è¡Œç‰¹æ®ŠåŒ–å¤„ç†ï¼Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨ã€‚ é—®ç­”ï¼š é—®é¢˜ï¼šFull authentication is required to access this resource åœ¨è¢«ç›‘æŽ§çš„æœåŠ¡ä¸­æ·»åŠ management.security.enabled=false æ‹“å±•é˜…è¯»ï¼šspring-boot-admin-samples issue jolokia]]></content>
      <tags>
        <tag>spring-boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Bootå¯åŠ¨æ–¹å¼ä¸Žéƒ¨ç½²]]></title>
    <url>%2F2017%2F10%2F16%2Fspringboot_deloy20171016%2F</url>
    <content type="text"><![CDATA[Spring Bootä¸ºæˆ‘ä»¬æä¾›å¾ˆå¤šä¾¿æ·çš„å¯åŠ¨å’Œé…ç½®æ–¹å¼ã€‚æœ¬æ–‡å°±æ¥å¥½å¥½è¯´ä¸€ä¸‹è¿™ä¸¤æ–¹é¢ã€‚ å¯åŠ¨æ–¹å¼12345678import org.springframework.boot.SpringApplication;import org.springframework.boot.autoconfigure.SpringBootApplication;@SpringBootApplicationpublic class GirlApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(GirlApplication.class, args); &#125;&#125; æ–¹æ³•ä¸€ï¼šç›´æŽ¥åœ¨ç¨‹åºä¸­run æ–¹æ³•äºŒï¼šåœ¨å‘½ä»¤è¡Œä¸­åˆ‡æ¢åˆ°å·¥ç¨‹æ‰€åœ¨ç›®å½•ï¼Œmvn spring-boot:run æ–¹æ³•ä¸‰ï¼šå…ˆmvn installç¼–è¯‘å·¥ç¨‹ï¼Œä¹‹åŽåˆ‡æ¢åˆ°targetè·¯å¾„ä¸‹ï¼Œä½¿ç”¨java -jar jaråŒ…å 1java -jar target/first-project-1.0.0.jar --spring.profile.active=prod åœ¨Ctrl+Cä¹‹åŽï¼ŒæœåŠ¡å³åœæ­¢ æ–¹æ³•å››ï¼š 12345nohup -Dspring.profiles.active=dev -jar XXX.jar &gt;/dev/null &amp;# æŒ‡å®šlogjava -jar spring-boot01-1.0-SNAPSHOT.jar &gt; log.file 2&gt;&amp;1 &amp;# é…ç½®æœåŠ¡å†…å­˜ä¿¡æ¯java -server -Xms8000m -Xmx8000m -jar luckydrawall-0.1.1.jar --spring.profiles.active=rel-Xmx8000m -jar luckydrawall-0.1.1.jar --spring.profiles.active=rel æ–¹æ³•äº”ï¼šå¤–éƒ¨Tomcatéƒ¨ç½²ï¼ˆä¸æŽ¨èï¼‰ 1ã€å°†é¡¹ç›®çš„å¯åŠ¨ç±»Application.javaç»§æ‰¿SpringBootServletInitializerå¹¶é‡å†™configureæ–¹æ³• 12345678910@SpringBootApplicationpublic class Application extends SpringBootServletInitializer &#123; @Override protected SpringApplicationBuilder configure(SpringApplicationBuilder application) &#123; return application.sources(Application.class); &#125; public static void main(String[] args) throws Exception &#123; SpringApplication.run(Application.class, args); &#125;&#125; 2ã€åœ¨pom.xmlæ–‡ä»¶ä¸­ï¼Œprojectä¸‹é¢å¢žåŠ packageæ ‡ç­¾1&lt;packaging&gt;war&lt;/packaging&gt; 3ã€è¿˜æ˜¯åœ¨pom.xmlæ–‡ä»¶ä¸­ï¼Œdependenciesä¸‹é¢æ·»åŠ 12345&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt; &lt;scope&gt;complied&lt;/scope&gt;&lt;/dependency&gt; è¿™æ ·ï¼Œåªéœ€è¦ä»¥ä¸Š3æ­¥å°±å¯ä»¥æ‰“åŒ…æˆwaråŒ…ï¼Œå¹¶ä¸”éƒ¨ç½²åˆ°tomcatä¸­äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯è¿™æ ·éƒ¨ç½²çš„request urléœ€è¦åœ¨ç«¯å£åŽåŠ ä¸Šé¡¹ç›®çš„åå­—æ‰èƒ½æ­£å¸¸è®¿é—®ã€‚spring-bootæ›´åŠ å¼ºå¤§çš„ä¸€ç‚¹å°±æ˜¯ï¼šå³ä¾¿é¡¹ç›®æ˜¯ä»¥ä¸Šé…ç½®ï¼Œä¾ç„¶å¯ä»¥ç”¨å†…åµŒçš„tomcatæ¥è°ƒè¯•ï¼Œå¯åŠ¨å‘½ä»¤å’Œä»¥å‰æ²¡å˜ï¼Œè¿˜æ˜¯ï¼šmvn spring-boot:runã€‚å¦‚æžœéœ€è¦åœ¨springbootä¸­åŠ ä¸Šrequestå‰ç¼€ï¼Œéœ€è¦åœ¨application.propertiesä¸­æ·»åŠ server.contextPath=/prefix/å³å¯ã€‚å…¶ä¸­prefixä¸ºå‰ç¼€åã€‚è¿™ä¸ªå‰ç¼€ä¼šåœ¨waråŒ…ä¸­å¤±æ•ˆï¼Œå–è€Œä»£ä¹‹çš„æ˜¯waråŒ…åç§°ï¼Œå¦‚æžœwaråŒ…åç§°å’Œprefixç›¸åŒçš„è¯ï¼Œé‚£ä¹ˆè°ƒè¯•çŽ¯å¢ƒå’Œæ­£å¼éƒ¨ç½²çŽ¯å¢ƒå°±æ˜¯ä¸€ä¸ªrequeståœ°å€äº†ã€‚ éƒ¨ç½²ç”±äºŽSpring Bootå†…ç½®äº†Tomcatï¼Œä»Žè€Œå¯ä»¥ç›´æŽ¥ä½¿ç”¨jarçš„æ–¹å¼è¿›è¡Œéƒ¨ç½²ã€‚å¯åŠ¨å‘½ä»¤åœ¨ä¸Šæ–¹è¿›è¡Œäº†è¯´æ˜Žã€‚éƒ¨ç½²è¿™ä¸€çŽ¯èŠ‚é‡è¦å°±æ˜¯é…ç½®æ–‡ä»¶ã€‚ Spring Boot æ‰€æä¾›çš„é…ç½®ä¼˜å…ˆçº§é¡ºåºæ¯”è¾ƒå¤æ‚ã€‚æŒ‰ç…§ä¼˜å…ˆçº§ä»Žé«˜åˆ°ä½Žçš„é¡ºåºï¼Œå…·ä½“çš„åˆ—è¡¨å¦‚ä¸‹æ‰€ç¤ºã€‚ å‘½ä»¤è¡Œå‚æ•°ã€‚ é€šè¿‡ System.getProperties() èŽ·å–çš„ Java ç³»ç»Ÿå‚æ•°ã€‚ æ“ä½œç³»ç»ŸçŽ¯å¢ƒå˜é‡ã€‚ ä»Ž java:comp/env å¾—åˆ°çš„ JNDI å±žæ€§ã€‚ é€šè¿‡ RandomValuePropertySource ç”Ÿæˆçš„â€œrandom.*â€å±žæ€§ã€‚ åº”ç”¨jar æ–‡ä»¶ä¹‹å¤–çš„å±žæ€§æ–‡ä»¶ã€‚(é€šè¿‡spring.config.locationå‚æ•°) åº”ç”¨jar æ–‡ä»¶å†…éƒ¨çš„å±žæ€§æ–‡ä»¶ã€‚ åœ¨åº”ç”¨é…ç½® Java ç±»ï¼ˆåŒ…å«â€œ@Configurationâ€æ³¨è§£çš„ Java ç±»ï¼‰ä¸­é€šè¿‡â€œ@PropertySourceâ€æ³¨è§£å£°æ˜Žçš„å±žæ€§æ–‡ä»¶ã€‚ é€šè¿‡â€œSpringApplication.setDefaultPropertiesâ€å£°æ˜Žçš„é»˜è®¤å±žæ€§ã€‚ è¯´æ˜Žï¼š 1ï¼‰Spring Bootåº”ç”¨åœ¨å¯åŠ¨å‘½ä»¤ä¸­ä½¿ç”¨--å¼€å¤´çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œå¯ä¿®æ”¹åº”ç”¨çš„é…ç½®ã€‚ 1java -server -Xms8000m -Xmx8000m -jar luckydrawall-0.1.1.jar --spring.profiles.active=rel-Xmx8000m ä½¿ç”¨å¦‚ä¸‹ä»£ç è¿›è¡Œå…³é—­ 1SpringApplication.setAddCommandLineProperties(false) 6ï¼‰å±žæ€§æ–‡ä»¶æ˜¯æ¯”è¾ƒæŽ¨èçš„é…ç½®æ–¹å¼ã€‚Spring Bootåœ¨å¯åŠ¨æ—¶ä¼šå¯¹å¦‚ä¸‹ç›®å½•è¿›è¡ŒæœæŸ¥ï¼Œè¯»å–ç›¸åº”é…ç½®æ–‡ä»¶ã€‚ä¼˜å…ˆçº§ä»Žé«˜åˆ°ä½Žã€‚ å½“å‰jarç›®å½•çš„â€œ/configâ€å­ç›®å½• å½“å‰jarç›®å½• classpath ä¸­çš„â€œ/configâ€åŒ… classpath å¯ä»¥é€šè¿‡â€œspring.config.nameâ€é…ç½®å±žæ€§æ¥æŒ‡å®šä¸åŒçš„å±žæ€§æ–‡ä»¶åç§°ã€‚ä¹Ÿå¯ä»¥é€šè¿‡â€œspring.config.locationâ€æ¥æ·»åŠ é¢å¤–çš„å±žæ€§æ–‡ä»¶çš„æœç´¢è·¯å¾„ã€‚å¦‚æžœåº”ç”¨ä¸­åŒ…å«å¤šä¸ª profileï¼Œå¯ä»¥ä¸ºæ¯ä¸ª profile å®šä¹‰å„è‡ªçš„å±žæ€§æ–‡ä»¶ï¼ŒæŒ‰ç…§â€œapplication-{profile}â€æ¥å‘½åã€‚ 1java -jar demo.jar --spring.config.location=/path/test_evn.properties ä½¿ç”¨ProfileåŒºåˆ†çŽ¯å¢ƒåœ¨Spring Bootä¸­å¯ä»¥ä½¿ç”¨application.ymlï¼Œapplication-default.ymlï¼Œapplication-dev.ymlï¼Œapplication-test.ymlè¿›è¡Œä¸åŒçŽ¯å¢ƒçš„é…ç½®ã€‚é»˜è®¤æ—¶ï¼Œä¼šè¯»å–application.ymlï¼Œapplication-default.ymlè¿™ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„é…ç½®ï¼Œä¼˜å…ˆçº§é«˜çš„ä¼šè¦†ç›–ä¼˜å…ˆçº§ä½Žçš„é…ç½®ã€‚æ— è®ºåˆ‡æ¢åˆ°å“ªä¸ªçŽ¯å¢ƒï¼ŒæŒ‡å®šçš„çŽ¯å¢ƒçš„é…ç½®çš„ä¼˜å…ˆçº§æ˜¯æœ€é«˜çš„ã€‚ å¯ä»¥ä½¿ç”¨spring.profiles.active=devæŒ‡å®šçŽ¯å¢ƒã€‚ æŽ¨èé˜…è¯»ï¼šSpring Boot é…ç½®ä¼˜å…ˆçº§é¡ºåº]]></content>
      <tags>
        <tag>spring-boot</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æŽ¥å£åŠ¨æ€å®žçŽ°è§£å†³æ–¹æ¡ˆ]]></title>
    <url>%2F2017%2F07%2F26%2Fmybatits20170726%2F</url>
    <content type="text"><![CDATA[å£°æ˜Žè§£å†³æ–¹æ¡ˆæ˜¯åŸºäºŽMybatisæºç ï¼Œè¿›è¡ŒäºŒæ¬¡å¼€å‘å®žçŽ°ã€‚ é—®é¢˜é¢†å¯¼æœ€è¿‘è·Ÿæˆ‘æäº†ä¸€ä¸ªéœ€æ±‚ï¼Œæ˜¯æœ‰å…³äºŽå®žçŽ°ç±»Mybatisçš„@Selectã€@Insertæ³¨è§£çš„åŠŸèƒ½ã€‚å…¶æ˜¯åŸºäºŽinterfaceå±‚é¢ï¼Œä¸å­˜åœ¨ä»»ä½•çš„æŽ¥å£å®žçŽ°ç±»ã€‚å› è€Œåœ¨å®žçŽ°çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè¦è§£å†³çš„æ˜¯å¦‚ä½•åŠ¨æ€å®žçŽ°æŽ¥å£çš„å®žä¾‹åŒ–ã€‚å…¶æ¬¡æ˜¯å¦‚ä½•å°†ä½¿æŽ¥å£æ ¹æ®æ³¨è§£å®žçŽ°ç›¸åº”çš„åŠŸèƒ½ã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹Mybatisæ˜¯å¦‚ä½•å®žçŽ°Daoç±»çš„æ‰«æçš„ã€‚MapperScannerConfigurer.java 123456789101112131415161718public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) throws BeansException &#123; if (this.processPropertyPlaceHolders) &#123; processPropertyPlaceHolders(); &#125; ClassPathMapperScanner scanner = new ClassPathMapperScanner(registry); scanner.setAddToConfig(this.addToConfig); scanner.setAnnotationClass(this.annotationClass); scanner.setMarkerInterface(this.markerInterface); scanner.setSqlSessionFactory(this.sqlSessionFactory); scanner.setSqlSessionTemplate(this.sqlSessionTemplate); scanner.setSqlSessionFactoryBeanName(this.sqlSessionFactoryBeanName); scanner.setSqlSessionTemplateBeanName(this.sqlSessionTemplateBeanName); scanner.setResourceLoader(this.applicationContext); scanner.setBeanNameGenerator(this.nameGenerator); scanner.registerFilters(); scanner.scan(StringUtils.tokenizeToStringArray(this.basePackage, ConfigurableApplicationContext.CONFIG_LOCATION_DELIMITERS)); &#125; ClassPathMapperScanneræ˜¯Mybatisç»§æ‰¿ClassPathBeanDefinitionScannerç±»è€Œæ¥çš„ã€‚è¿™é‡Œå¯¹äºŽClassPathMapperScannerçš„é…ç½®å‚æ•°æ¥æºäºŽæˆ‘ä»¬åœ¨ä½¿ç”¨Mybatisæ—¶çš„é…ç½®è€Œæ¥ï¼Œæ˜¯ä¸æ˜¯è¿˜è®°å¾—åœ¨ä½¿ç”¨Mybatisçš„æ—¶å€™è¦é…ç½®basePackageçš„å‚æ•°å‘¢ï¼Ÿ æŽ¥ç€æˆ‘ä»¬å°±é¡ºç€scanner.scan()æ–¹æ³•ï¼Œè¿›å…¥æŸ¥çœ‹ä¸€ä¸‹é‡Œé¢çš„å®žçŽ°ã€‚ ClassPathBeanDefinitionScanner.java 123456789101112public int scan(String... basePackages) &#123; int beanCountAtScanStart = this.registry.getBeanDefinitionCount(); doScan(basePackages); // Register annotation config processors, if necessary. if (this.includeAnnotationConfig) &#123; AnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry); &#125; return (this.registry.getBeanDefinitionCount() - beanCountAtScanStart);&#125; è¿™é‡Œå…³é”®çš„ä»£ç æ˜¯doScan(basePackages);ï¼Œé‚£ä¹ˆæˆ‘ä»¬åœ¨è¿›åŽ»çœ‹ä¸€ä¸‹ã€‚å¯èƒ½ä½ ä¼šçœ‹åˆ°çš„æ˜¯Springæºç çš„å®žçŽ°æ–¹æ³•ï¼Œä½†è¿™é‡ŒMybatisä¹Ÿå®žçŽ°äº†è‡ªå·±çš„ä¸€å¥—ï¼Œæˆ‘ä»¬çœ‹ä¸€ä¸‹Mybatisçš„å®žçŽ°ã€‚ ClassPathMapperScanner.java 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455public Set&lt;BeanDefinitionHolder&gt; doScan(String... basePackages) &#123; Set&lt;BeanDefinitionHolder&gt; beanDefinitions = super.doScan(basePackages); if (beanDefinitions.isEmpty()) &#123; logger.warn("No MyBatis mapper was found in '" + Arrays.toString(basePackages) + "' package. Please check your configuration."); &#125; else &#123; for (BeanDefinitionHolder holder : beanDefinitions) &#123; GenericBeanDefinition definition = (GenericBeanDefinition) holder.getBeanDefinition(); if (logger.isDebugEnabled()) &#123; logger.debug("Creating MapperFactoryBean with name '" + holder.getBeanName() + "' and '" + definition.getBeanClassName() + "' mapperInterface"); &#125; // the mapper interface is the original class of the bean // but, the actual class of the bean is MapperFactoryBean definition.getPropertyValues().add("mapperInterface", definition.getBeanClassName()); definition.setBeanClass(MapperFactoryBean.class); definition.getPropertyValues().add("addToConfig", this.addToConfig); boolean explicitFactoryUsed = false; if (StringUtils.hasText(this.sqlSessionFactoryBeanName)) &#123; definition.getPropertyValues().add("sqlSessionFactory", new RuntimeBeanReference(this.sqlSessionFactoryBeanName)); explicitFactoryUsed = true; &#125; else if (this.sqlSessionFactory != null) &#123; definition.getPropertyValues().add("sqlSessionFactory", this.sqlSessionFactory); explicitFactoryUsed = true; &#125; if (StringUtils.hasText(this.sqlSessionTemplateBeanName)) &#123; if (explicitFactoryUsed) &#123; logger.warn("Cannot use both: sqlSessionTemplate and sqlSessionFactory together. sqlSessionFactory is ignored."); &#125; definition.getPropertyValues().add("sqlSessionTemplate", new RuntimeBeanReference(this.sqlSessionTemplateBeanName)); explicitFactoryUsed = true; &#125; else if (this.sqlSessionTemplate != null) &#123; if (explicitFactoryUsed) &#123; logger.warn("Cannot use both: sqlSessionTemplate and sqlSessionFactory together. sqlSessionFactory is ignored."); &#125; definition.getPropertyValues().add("sqlSessionTemplate", this.sqlSessionTemplate); explicitFactoryUsed = true; &#125; if (!explicitFactoryUsed) &#123; if (logger.isDebugEnabled()) &#123; logger.debug("Enabling autowire by type for MapperFactoryBean with name '" + holder.getBeanName() + "'."); &#125; definition.setAutowireMode(AbstractBeanDefinition.AUTOWIRE_BY_TYPE); &#125; &#125; &#125; return beanDefinitions;&#125; definition.setBeanClass(MapperFactoryBean.class);è¿™è¡Œä»£ç æ˜¯éžå¸¸å…³é”®çš„ä¸€å¥ï¼Œç”±äºŽåœ¨Springä¸­å­˜åœ¨ä¸¤ç§è‡ªåŠ¨å®žä¾‹åŒ–çš„æ–¹å¼ï¼Œä¸€ç§æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„æœ¬èº«çš„æŽ¥å£å®žä¾‹åŒ–ç±»è¿›è¡ŒæŽ¥å£å®žä¾‹åŒ–ï¼Œè¿˜æœ‰ä¸€ç§å°±æ˜¯è¿™é‡Œçš„è‡ªå®šä¹‰å®žä¾‹åŒ–ã€‚è€Œè¿™é‡Œçš„setBeanClassæ–¹æ³•å°±æ˜¯åœ¨BeanDefinitionHolderä¸­è¿›è¡Œé…ç½®ã€‚åœ¨Springè¿›è¡Œå®žä¾‹åŒ–çš„æ—¶å€™è¿›è¡Œå¤„ç†ã€‚ é‚£ä¹ˆæˆ‘ä»¬åœ¨çœ‹ä¸€ä¸‹MapperFactoryBean.class MapperFactoryBean.java 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172public class MapperFactoryBean&lt;T&gt; extends SqlSessionDaoSupport implements FactoryBean&lt;T&gt; &#123; private Class&lt;T&gt; mapperInterface; private boolean addToConfig = true; /** * Sets the mapper interface of the MyBatis mapper * * @param mapperInterface class of the interface */ public void setMapperInterface(Class&lt;T&gt; mapperInterface) &#123; this.mapperInterface = mapperInterface; &#125; /** * If addToConfig is false the mapper will not be added to MyBatis. This means * it must have been included in mybatis-config.xml. * &lt;p&gt; * If it is true, the mapper will be added to MyBatis in the case it is not already * registered. * &lt;p&gt; * By default addToCofig is true. * * @param addToConfig */ public void setAddToConfig(boolean addToConfig) &#123; this.addToConfig = addToConfig; &#125; /** * &#123;@inheritDoc&#125; */ @Override protected void checkDaoConfig() &#123; super.checkDaoConfig(); notNull(this.mapperInterface, "Property 'mapperInterface' is required"); Configuration configuration = getSqlSession().getConfiguration(); if (this.addToConfig &amp;&amp; !configuration.hasMapper(this.mapperInterface)) &#123; try &#123; configuration.addMapper(this.mapperInterface); &#125; catch (Throwable t) &#123; logger.error("Error while adding the mapper '" + this.mapperInterface + "' to configuration.", t); throw new IllegalArgumentException(t); &#125; finally &#123; ErrorContext.instance().reset(); &#125; &#125; &#125; /** * &#123;@inheritDoc&#125; */ public T getObject() throws Exception &#123; return getSqlSession().getMapper(this.mapperInterface); &#125; /** * &#123;@inheritDoc&#125; */ public Class&lt;T&gt; getObjectType() &#123; return this.mapperInterface; &#125; /** * &#123;@inheritDoc&#125; */ public boolean isSingleton() &#123; return true; &#125; åœ¨è¯¥ç±»ä¸­å…¶å®žçŽ°äº†FactoryBeanæŽ¥å£ï¼Œçœ‹è¿‡Springæºç çš„äººï¼Œæˆ‘ç›¸ä¿¡å¯¹å…¶éƒ½æœ‰å¾ˆæ·±çš„å°è±¡ï¼Œå…¶åœ¨Beançš„å®žä¾‹åŒ–ä¸­èµ·ç€å¾ˆé‡è¦çš„ä½œç”¨ã€‚åœ¨è¯¥ç±»ä¸­æˆ‘ä»¬è¦å…³æ³¨çš„æ˜¯getObjectæ–¹æ³•ï¼Œæˆ‘ä»¬ä¹‹åŽå°†åŠ¨æ€å®žä¾‹åŒ–çš„æŽ¥å£å¯¹è±¡æ”¾åˆ°Springå®žä¾‹åŒ–åˆ—è¡¨ä¸­ï¼Œè¿™é‡Œå°±æ˜¯å…¥å£ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬çš„èµ·ç‚¹ã€‚ä¸è¿‡è¦ç‰¹åˆ«è¯´æ˜Žçš„æ˜¯mapperInterfaceçš„å€¼æ˜¯å¦‚ä½•è¢«èµ‹å€¼çš„ï¼Œå¯èƒ½ä¼šæœ‰ç–‘é—®ï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹ä¸Šé¢çš„ClassPathMapperScanner.javaæˆ‘ä»¬åœ¨é…ç½®MapperFactoryBean.classçš„ä¸Šé¢å­˜åœ¨ä¸€è¡Œ definition.getPropertyValues().add(&quot;mapperInterface&quot;, definition.getBeanClassName());å…¶åœ¨ä¹‹åŽåœ¨Springçš„PostProcessorRegistrationDelegateç±»çš„populateBeanæ–¹æ³•ä¸­è¿›è¡Œå±žæ€§é…ç½®ï¼Œä¼šå°†å…¶ä¾é åå°„çš„æ–¹å¼å°†å…¶æ³¨å…¥åˆ°MapperFactoryBean.classä¸­ã€‚ è€Œä¸”definition.getPropertyValues().addä¸­æ·»åŠ çš„å€¼æ˜¯æ³¨å…¥åˆ°MapperFactoryBeanå¯¹è±¡ä¸­åŽ»çš„ã€‚è¿™ä¸€ç‚¹éœ€è¦è¯´æ˜Žä¸€ä¸‹ã€‚]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å‰ç«¯é”™è¯¯ä¿¡æ¯ç«™]]></title>
    <url>%2F2017%2F07%2F04%2Ffrontenderror%2F</url>
    <content type="text"><![CDATA[nodejs/webpacké¡¹ç›®æç¤ºInvalid Host header æ–°ç‰ˆçš„webpack-dev-serverå‡ºäºŽå®‰å…¨è€ƒè™‘ï¼Œé»˜è®¤æ£€æŸ¥hostnameï¼Œå¦‚æžœhostnameä¸æ˜¯é…ç½®å†…çš„ï¼Œå°†ä¸­æ–­è®¿é—®ã€‚ â€”â€”â€”â€” disableHostCheck: true 123456devServer: &#123; contentBase: path.resolve(__dirname, 'build'), host: '0.0.0.0', port: process.env.PORT || 8601, disableHostCheck: true &#125;]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Config]]></title>
    <url>%2F2017%2F07%2F02%2Fspringcloud_config20170702%2F</url>
    <content type="text"><![CDATA[configæ˜¯Spring Cloudä¸­çš„é…ç½®ä¸­å¿ƒï¼Œåœ¨æ­£å¼åœºæ™¯ä¸­ï¼Œå­˜åœ¨ä¿®æ”¹é…ç½®çš„æƒ…å†µï¼Œæ¯æ¬¡é…ç½®çš„ä¿®æ”¹éƒ½è¦è¿›è¡Œé‡æ–°æ‰“åŒ…ï¼Œè¿™æ˜¯éžå¸¸éº»çƒ¦çš„ä¸€ä»¶äº‹ï¼Œå¯èƒ½è¿˜ä¼´éšç€å…¶ä»–é—®é¢˜çš„å¼•å‘ã€‚è€Œconfigå°±å¯ä»¥å°†ä¸€äº›ä¸Žå¯åŠ¨æ— å…³çš„é…ç½®è¿›è¡ŒåŠ¨æ€ä¿®æ”¹ï¼Œå¹¶ç”Ÿæ•ˆã€‚ä»¥å‰è¦æ•°æ®åº“è¿›è¡Œé…ç½®çš„ï¼ŒçŽ°åœ¨ä¹Ÿå¯ä»¥åœ¨configä¸­å®Œæˆã€‚ å¿«é€Ÿå…¥é—¨ConfigæœåŠ¡ç«¯123456789 &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt;&lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-config-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;/dependencies&gt; bootstrap.yml 1234567891011121314151617181920212223242526272829303132333435# Spring propertiesspring: application: name: config-service # Service registers under this name cloud: config: server: git: uri: https://github.com/zoeminghong/spring-cloud-demo.git search-paths: config-repo #æ–‡ä»¶æœç´¢è·¯å¾„ username: username #è´¦å· password: password #å¯†ç  name: appzone #application name label: master #åˆ†æ”¯# profiles:# active: native #å½“ä¸ä½¿ç”¨gitæ—¶ï¼Œå¯ä»¥è®¾ç½®ä¸ºnativeï¼ŒèŽ·å–configæœåŠ¡ä¸‹main/java/resourcesæœ¬åœ°é…ç½®# Map the error path to error template (for Thymeleaf)error: path=/error# Discovery Server Accesseureka: instance: hostname: localhost client: registerWithEureka: true fetchRegistry: true serviceUrl: defaultZone: http://root:123456@$&#123;eureka.instance.hostname&#125;:8761/eureka/# æ³¨å†Œåˆ°eurekaæœåŠ¡ï¼Œè´¦å·ï¼šå¯†ç @åœ°å€# HTTP Serverserver: port: 7001 # HTTP (Tomcat) port Main.java 12345678@EnableConfigServer@SpringBootApplication@EnableDiscoveryClientpublic class ConfigApplication &#123; public static void main(String[] args) &#123; new SpringApplicationBuilder(ConfigApplication.class).web(true).run(args); &#125;&#125; Configå®¢æˆ·ç«¯pomé…ç½®æ˜¯ä¸ŽæœåŠ¡ç«¯æ˜¯ä¸€æ ·çš„ 1234567891011121314151617181920212223242526272829303132333435spring: cloud:# configçš„ç›¸å…³é…ç½® config: label: master profile: dev uri: http://localhost:7001/ #config Service address name: appzone #application name discovery: enabled: true #whether enable service-id service-id: CONFIG-SERVICE #config service application name on the eureka username: root # regisit centre's username password: 123456 # regisit centre's password# fail-fast: true # æ²¡æœ‰è¿žæŽ¥é…ç½®æœåŠ¡ç«¯æ—¶ç›´æŽ¥å¯åŠ¨å¤±è´¥# Spring properties application: name: order-service # Service registers under this name freemarker: enabled: false # Ignore Eureka dashboard FreeMarker templates thymeleaf: cache: false# Discovery Server Accesseureka: instance: hostname: localhost client: registerWithEureka: true fetchRegistry: true serviceUrl: defaultZone: http://root:123456@$&#123;eureka.instance.hostname&#125;:8761/eureka/# HTTP Serverserver: port: 2222 # HTTP (Tomcat) port main.java 12345678@SpringBootApplication@EnableDiscoveryClientpublic class OrderApplication &#123; public static void main(String[] args) &#123; new SpringApplicationBuilder(OrderApplication.class).web(true).run(args); &#125;&#125; æ·±å…¥å­¦ä¹ åˆ·æ–°é…ç½®gité…ç½®ç›®å½•ä¸‹çš„æ–‡ä»¶å‘ç”Ÿæ›´æ”¹æ—¶ï¼Œéœ€è¦æ›´æ–°é€šçŸ¥åˆ°æœåŠ¡ï¼Œä½¿ç”¨@RefreshScopeå¯ä»¥å¸®åŠ©å®žçŽ°é…ç½®çš„åˆ·æ–°ã€‚ å®žçŽ°æ–¹å¼ï¼š åœ¨æŒ‡å®šçš„é…ç½®ç±»ä¸‹ä½¿ç”¨@RefreshScopeï¼Œå¦‚è‹¥gité…ç½®å‘ç”Ÿå˜åŒ–ï¼Œä½¿ç”¨http://ç›¸åº”æœåŠ¡åœ°å€/refresh ,(POST)ã€‚ ä¹Ÿå¯ä»¥ï¼š é‡å¯æœåŠ¡åœ¨application.ymlä¸­å¯ç”¨endpoints.restart.enabled=trueï¼Œè°ƒç”¨http://ç›¸åº”æœåŠ¡åœ°å€/restart ,(POST)æœåŠ¡ã€‚ æ³¨-å¾€å¾€å­˜åœ¨ä¸€äº›åœºæ™¯ï¼Œrefreshæ˜¯ä¸ä¼šç”Ÿæ•ˆçš„ï¼Œå› è€Œï¼Œä½¿ç”¨restartæ—¶æ¯”è¾ƒä¿é™©çš„æ“ä½œï¼Œä½†restartè€—æ—¶æ¯”è¾ƒé•¿ã€‚æ•…å»ºè®®ï¼Œåœ¨æ²¡æœ‰ç‰¹æ®Šçš„å¤„ç†çš„é…ç½®ç±»ä¸­ä½¿ç”¨@RefreshScopeæ¥å®žçŽ°refreshï¼Œå­˜åœ¨æ¯”è¾ƒå¤æ‚ï¼Œä¸”è¦æ±‚æ¯”è¾ƒé«˜çš„é…ç½®é¡¹ï¼Œè¿˜æ˜¯ä½¿ç”¨restartæ¯”è¾ƒé è°±ã€‚ æ¨¡å¼çš„åŒ¹é…1234567891011121314spring:cloud: config: server: git: uri: https://github.com/spring-cloud-samples/config-repo repos: simple: https://github.com/simple/config-repo special: pattern: special*/dev*,*special*/dev* uri: https://github.com/special/config-repo local: pattern: local* uri: file:/home/configsvc/config-repo å½“ä¸å­˜åœ¨patternæ—¶ï¼Œ{application}/{profile}åˆ™æ ¹æ®keyæ¥å†³å®šï¼Œä¾‹å¦‚simpleä¸­ï¼ŒåŒ¹é…çš„æ˜¯simple/*ï¼Œå¦‚localä¸­ï¼ŒåŒ¹é…çš„æ˜¯local*/* æœ¬åœ°å­˜å‚¨è·¯å¾„æŽ§åˆ¶ï¼š åœ¨ä½¿ç”¨çš„configæœåŠ¡çš„æ—¶å€™ï¼Œå…¶ä¼šcloneä¸€ä»½ç¼“å­˜åˆ°æœ¬åœ°ï¼Œå¦‚æžœä½ è¦æŒ‡å®šè·¯å¾„å¯ä»¥ä½¿ç”¨spring.cloud.config.server.git.basedir ä½¿ç”¨æœ¬åœ°åŠ è½½é…ç½®æ–‡ä»¶ï¼š éœ€è¦é…ç½®ï¼šspring.cloud.config.server.native.searchLocationsè·Ÿspring.profiles.active=nativeã€‚è·¯å¾„é…ç½®æ ¼å¼ï¼šclasspath:/, classpath:/config,file:./, file:./configã€‚ åŸºäºŽæ–‡ä»¶çš„èµ„æºåº“ï¼š åœ¨åŸºäºŽæ–‡ä»¶çš„èµ„æºåº“ä¸­(i.e. git, svn and native)ï¼Œè¿™æ ·çš„æ–‡ä»¶åapplication*å‘½åçš„èµ„æºåœ¨æ‰€æœ‰çš„å®¢æˆ·ç«¯éƒ½æ˜¯å…±äº«çš„(å¦‚ application.properties, application.yml, application-*.properties,etc.)ã€‚ åŠ å¯†ä¸Žè§£å¯†å¦‚æžœè¿œç¨‹å±žæ€§åŒ…å«åŠ å¯†å†…å®¹(ä»¥{cipher}å¼€å¤´),è¿™äº›å€¼å°†åœ¨é€šè¿‡HTTPä¼ é€’åˆ°å®¢æˆ·ç«¯ä¹‹å‰è¢«è§£å¯†ã€‚ å®žçŽ°æ–¹å¼ä¸‹è½½è§£åŽ‹JCEï¼Œå¹¶å¤åˆ¶è‡³JDK/jre/lib/securityæ–‡ä»¶å¤¹ä¸‹ï¼ŒMavenä¾èµ–â€org.springframework.security:spring-security-rsaâ€ã€‚ çŽ¯å¢ƒé…ç½®configç›¸å…³é…ç½®éœ€è¦åœ¨bootstrap.ymlä¸­è¿›è¡Œé…ç½®ï¼Œåœ¨å®žé™…å¼€å‘ä¸­å­˜åœ¨è°ƒè¯•çŽ¯å¢ƒï¼Œå¼€å‘çŽ¯å¢ƒï¼Œæµ‹è¯•çŽ¯å¢ƒï¼Œçº¿ä¸ŠçŽ¯å¢ƒç­‰åœºæ™¯ï¼Œå› è€Œï¼Œå¯¹bootstrap.ymlè¿›è¡Œé…ç½®çŽ¯å¢ƒåŒ–é…ç½®æ˜¯å¾ˆå¿…é¡»çš„ã€‚ å¯ä»¥bootstrap-[environment].ymlï¼Œé»˜è®¤æ˜¯ä¼šè¯»å–bootstrap.ymlå’Œbootstrap-default.ymlä¸­çš„é…ç½®ã€‚è‹¥éœ€è¦è¯»å–å…¶ä»–çŽ¯å¢ƒçš„é…ç½®ï¼Œå¯åœ¨bootstrap.ymlä¸­è®¾ç½® 1234#springçŽ¯å¢ƒå’Œconfigä¸­çš„é…ç½®éƒ½ä¼šä½¿ç”¨è¯¥çŽ¯å¢ƒçš„é…ç½®spring: profile: active: environment åªæ˜¯æƒ³æ›´æ”¹configä¸­çš„çŽ¯å¢ƒï¼š 1234spring: cloud: config: profile: environment Tipså¦‚æžœconfigçš„å®¢æˆ·ç«¯éœ€è¦ä½¿ç”¨service-idè¿™ç§è´Ÿè½½å‡è¡¡çš„æ–¹å¼èŽ·å–configæœåŠ¡ç«¯çš„é…ç½®ä¿¡æ¯ï¼Œéœ€è¦æ³¨æ„å°†æ³¨å†Œä¸­å¿ƒçš„ä¿¡æ¯å’ŒconfigæœåŠ¡çš„ä¿¡æ¯éƒ½å†™äºŽbootstrap.ymlä¸‹ï¼Œ å¦åˆ™å¯èƒ½å­˜åœ¨æ‰¾ä¸åˆ°configæœåŠ¡ã€‚ configä¸­æ–‡æ–‡æ¡£]]></content>
      <tags>
        <tag>spring-cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Spring Cloud Eureka]]></title>
    <url>%2F2017%2F06%2F29%2Fspringcloud_eureka20170629%2F</url>
    <content type="text"><![CDATA[Eurekaæ˜¯ä¸€ä¸ªæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒï¼Œå½“ç„¶ï¼Œå…¶é»˜è®¤ä¹Ÿæ˜¯ä¸€ä¸ªå®¢æˆ·ç«¯ å¿«é€Ÿå…¥é—¨EurekaæœåŠ¡ç«¯pom.xml123456789101112131415&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt; &lt;artifactId&gt;spring-cloud-starter-eureka-server&lt;/artifactId&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt;&lt;/dependencies&gt; application.yml12345678910111213141516spring: application: name: eureka-registerserver: port: $&#123;vcap.application.port:8761&#125; # HTTP porteureka: instance: hostname: localhost #ä¸Žæœ¬åœ°çš„hostsæ–‡ä»¶é…ç½®æœ‰å…³ client: registerWithEureka: false #è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ°Eureka Serverï¼Œé»˜è®¤ä¸ºtrueã€‚ fetchRegistry: false #è¡¨ç¤ºæ˜¯å¦ä»ŽEureka ServerèŽ·å–æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚ serviceUrl: defaultZone: http://localhost:$&#123;server.port&#125;/eureka/ #è®¾ç½®ä¸ŽEureka Serveräº¤äº’çš„åœ°å€ï¼ŒæŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€ã€‚é»˜è®¤æ˜¯http://localhost:8761/eureka ï¼›å¤šä¸ªåœ°å€å¯ä½¿ç”¨ , åˆ†éš”ã€‚ server: waitTimeInMsWhenSyncEmpty: 0 enableSelfPreservation: false Application.java 12345678@SpringBootApplication@EnableEurekaServer//å¯åŠ¨ä½¿ç”¨EurekaServerpublic class SpringCloudEurekaApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SpringCloudEurekaApplication.class, args); &#125;&#125; Eurekaå®¢æˆ·ç«¯pom.xml åŒä¸Š bootstrap.xml 12345678eureka: instance: hostname: localhost client: registerWithEureka: true fetchRegistry: true serviceUrl: defaultZone: http://$&#123;eureka.instance.hostname&#125;:8761/eureka/ Application.java 12345678@SpringBootApplication@EnableEurekaClint//å¯åŠ¨ä½¿ç”¨EurekaClientpublic class SpringCloudEurekaApplication &#123; public static void main(String[] args) &#123; SpringApplication.run(SpringCloudEurekaApplication.class, args); &#125;&#125; æ·±å…¥å­¦ä¹ é«˜å¯ç”¨å®žçŽ°æ–¹æ¡ˆåœ¨eurekaæœåŠ¡ç«¯ymlé…ç½®æ–‡ä»¶ 1234567891011121314151617spring: profiles: peer1eureka: instance: hostname: peer1 client: serviceUrl: defaultZone: http://peer2/eureka/---spring: profiles: peer2eureka: instance: hostname: peer2 client: serviceUrl: defaultZone: http://peer1/eureka/ åœ¨hostsæ–‡ä»¶ä¸­è¿›è¡Œhosté…ç½® 12127.0.0.1 peer1127.0.0.1 peer2 å¯åŠ¨ç¨‹åº 12java -jar microservice-eureka-1.0-SNAPSHOT.jar --spring.profiles.active=peer1java -jar microservice-eureka-1.0-SNAPSHOT.jar --spring.profiles.active=peer2 æŸ¥çœ‹eurekaæœåŠ¡åœ°å€ï¼Œæ˜¯å¦å­˜åœ¨ä¸¤ä¸ªæ³¨å†Œåœ°å€ä¿¡æ¯ æ³¨-ç¬¬ä¸€ä¸ªæœåŠ¡å¯åŠ¨çš„æ—¶å€™å­˜åœ¨java.net.ConnectException: Connection refused (Connection refused)çš„é”™è¯¯ä¿¡æ¯ï¼Œä¸ç”¨ç†ç¬ï¼Œåªè¦æœ€åŽæœåŠ¡ç«¯å£æ˜¾ç¤ºå°±è¡¨ç¤ºæœåŠ¡èµ·æ¥äº†ã€‚å‡ºçŽ°è¿™ä¸ªé”™è¯¯çš„åŽŸå› æ˜¯å¦ä¸€ä¸ªæœåŠ¡è¿˜æ²¡èµ·æ¥ï¼Œæ— æ³•åŽ»å¯¹æ–¹æœåŠ¡è¿›è¡Œæ³¨å†Œï¼Œå¦‚æžœå¦ä¸€ä¸ªæœåŠ¡èµ·æ¥ä¹‹åŽï¼Œä¸å­˜åœ¨é—®é¢˜äº†ã€‚ æ³¨-hostnameå¿…é¡»æ˜¯ä¸ä¸€è‡´çš„ã€‚ æœåŠ¡æä¾›è€…æ³¨å†Œåˆ°é«˜å¯ç”¨æ³¨å†Œä¸­å¿ƒ123456eureka: client: serviceUrl: defaultZone: http://eureka1:8001/eureka/,http://eureka2:8002/eureka/ instance: preferIpAddress: true æœåŠ¡æä¾›è€…é«˜å¯ç”¨ç¬¬ä¸€ç§æ–¹å¼å°†æœåŠ¡éƒ¨ç½²åœ¨ä¸åŒçš„ä¸¤å°æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ç›¸åŒçš„ç«¯å£ ç¬¬äºŒç§æ–¹å¼å°†æœåŠ¡éƒ¨ç½²åœ¨ç›¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ä¸åŒçš„ç«¯å£ æ¶ˆè´¹æœåŠ¡è°ƒç”¨123456eureka: client: serviceUrl: defaultZone: http://eureka1:8001/eureka/,http://eureka2:8002/eureka/ instance: preferIpAddress: true å¦‚æžœä½¿ç”¨äº†è´Ÿè½½å‡è¡¡é…ç½®æƒ…å†µä¸‹ï¼Œä¼šå°†è¯·æ±‚åˆ†æ‘Šåˆ°ä¸¤ä¸ªæœåŠ¡æä¾›è€…ä¸Šã€‚ å¥åº·æ£€æŸ¥å’ŒçŠ¶æ€çš„è·¯å¾„123eureka: instance: instanceId: $&#123;spring.application.name&#125;:$&#123;vcap.application.instance_id:$&#123;spring.application.instance_id:$&#123;random.value&#125;&#125;&#125; ç”±äºŽå­˜åœ¨é›†ç¾¤å’ŒåŒä¸€å°æœåŠ¡å™¨éƒ¨ç½²å¤šå¥—æœåŠ¡çš„æƒ…å†µï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªå”¯ä¸€çš„èº«ä»½IDï¼Œé»˜è®¤Spring Cloudä¹Ÿæ˜¯æœ‰ä¸€å¥—è§„åˆ™${spring.cloud.client.hostname}:${spring.application.name}:${spring.application.instance_id:${server.port}}}ã€‚ä¾‹å¦‚ Myhostï¼šmyappnameï¼š8080 ã€‚ä½†å¦‚æžœæƒ³è¿›è¡Œè‡ªè¡Œå®šè§„åˆ™ï¼Œå°±å¯ä»¥ä½¿ç”¨ä¸Šé¢çš„å±žæ€§é…ç½®ã€‚ å…¶é»˜è®¤æ˜¯clientåœ¨æ³¨å†ŒæˆåŠŸä¹‹åŽï¼Œå°±è®¤ä¸ºstatusæ˜¯UPçš„ï¼Œä¸ä¼šé¢‘ç¹çš„åŽ»èŽ·å–å¿ƒè·³ï¼Œå½“è®¾ç½®äº†è¯¥å±žæ€§ä¸ºtrueæ—¶ï¼Œæ‰ä¼šåŽ»å¬å–å¿ƒè·³ã€‚å¹¶ä¸”è¯¥é…ç½®å¿…é¡»åªèƒ½åœ¨application.ymlä¸‹é¢é…ç½®ï¼Œä¸èƒ½ä½¿ç”¨bootstrap.ymlã€‚ 12345eureka: instance: statusPageUrl: https://$&#123;eureka.hostname&#125;/info healthCheckUrl: https://$&#123;eureka.hostname&#125;/health homePageUrl: https://$&#123;eureka.hostname&#125;/ æ·»åŠ å¯†ç æœåŠ¡ç«¯ï¼š pom.xml 1234&lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;&lt;/dependency&gt; application.yml 1234security: user: name: root password: 123456 å®¢æˆ·ç«¯ï¼š application.yml 12345678eureka: instance: hostname: localhost client: registerWithEureka: true fetchRegistry: true serviceUrl: defaultZone: http://$&#123;username&#125;ï¼š$&#123;password&#125;@$&#123;eureka.instance.hostname&#125;:8761/eureka/ Eureka.instance.prefer-ip-addresseureka.instance.prefer-ip-address=trueä»¥IPçš„å½¢å¼æ³¨å†Œregister serviceï¼Œfalseæ˜¯ç”¨æ‰€åœ¨æœºå™¨åï¼ˆhostnameï¼‰ã€‚ eureka.instance.ip-addressè‡ªå®šä¹‰IPåœ°å€ï¼Œå…¶ä¼˜å…ˆçº§æ¯”eureka.instance.prefer-ip-addressé«˜ã€‚ ignored-interfacesåœºæ™¯é—®é¢˜ï¼š æœåŠ¡å™¨ä¸Šåˆ†åˆ«é…ç½®äº†eth0, eth1å’Œeth2ä¸‰å—ç½‘å¡ï¼Œåªæœ‰eth1çš„åœ°å€å¯ä¾›å…¶å®ƒæœºå™¨è®¿é—®ï¼Œeth0å’Œeth2çš„ IP æ— æ•ˆã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒæœåŠ¡æ³¨å†Œæ—¶Eureka Clientä¼šè‡ªåŠ¨é€‰æ‹©eth0ä½œä¸ºæœåŠ¡ip, å¯¼è‡´å…¶å®ƒæœåŠ¡æ— æ³•è°ƒç”¨ã€‚ å¿½ç•¥æŒ‡å®šç½‘å¡ é€šè¿‡ä¸Šé¢æºç åˆ†æžå¯ä»¥å¾—çŸ¥ï¼Œspring cloudè‚¯å®šèƒ½é…ç½®ä¸€ä¸ªç½‘å¡å¿½ç•¥åˆ—è¡¨ã€‚é€šè¿‡æŸ¥æ–‡æ¡£èµ„æ–™å¾—çŸ¥ç¡®å®žå­˜åœ¨è¯¥å±žæ€§ï¼š 1spring.cloud.inetutils.ignored-interfaces[0]=eth0 # å¿½ç•¥eth0, æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼11 å› æ­¤ï¼Œç¬¬ä¸€ç§æ–¹æ¡ˆå°±æ˜¯é€šè¿‡é…ç½®application.propertiesè®©åº”ç”¨å¿½ç•¥æ— æ•ˆçš„ç½‘å¡ã€‚ é…ç½®host å½“ç½‘æŸ¥éåŽ†é€»è¾‘éƒ½æ²¡æœ‰æ‰¾åˆ°åˆé€‚ipæ—¶ä¼šèµ°JDKçš„InetAddress.getLocalHost()ã€‚è¯¥æ–¹æ³•ä¼šè¿”å›žå½“å‰ä¸»æœºçš„hostname, ç„¶åŽä¼šæ ¹æ®hostnameè§£æžå‡ºå¯¹åº”çš„ipã€‚å› æ­¤ç¬¬äºŒç§æ–¹æ¡ˆå°±æ˜¯é…ç½®æœ¬æœºçš„hostnameå’Œ/etc/hostsæ–‡ä»¶ï¼Œç›´æŽ¥å°†æœ¬æœºçš„ä¸»æœºåæ˜ å°„åˆ°æœ‰æ•ˆIPåœ°å€ã€‚ æ‰‹å·¥æŒ‡å®šIP(æŽ¨è) æ·»åŠ ä»¥ä¸‹é…ç½®ï¼š 1234# æŒ‡å®šæ­¤å®žä¾‹çš„ipeureka.instance.ip-address=# æ³¨å†Œæ—¶ä½¿ç”¨ipè€Œä¸æ˜¯ä¸»æœºåeureka.instance.prefer-ip-address=true æœåŠ¡ç»­çº¦åœ¨æ³¨å†Œå®Œæ¯•ä¹‹åŽï¼Œä¼šåœ¨æ¯è¿‡ä¸€ä¸ªé—´éš”æœŸï¼Œå°±ä¼šå‘æ³¨å†Œä¸­å¿ƒç»­çº¦ï¼Œè¡¨ç¤ºæœåŠ¡è¿˜æ´»ç€ã€‚ 1234eureka: instance: lease-renewal-interval-in-secondes: 30 #æœåŠ¡ç»­çº¦ä»»åŠ¡çš„è°ƒç”¨é—´éš”æ—¶é—´ lease-expiration-duration-in-seconds: 90 #å®šä¹‰æœåŠ¡å¤±æ•ˆçš„æ—¶é—´ ä¹Ÿå°±æ˜¯è¯´ï¼Œé»˜è®¤æ˜¯æ¯éš”30ç§’åº”ç”¨å‘æ³¨å†Œä¸­å¿ƒè¿›è¡Œç»­çº¦æ“ä½œï¼Œå½“æœåŠ¡ç»­çº¦æ—¶é—´é—´éš”è¶…è¿‡90ç§’ï¼Œæ³¨å†Œä¸­å¿ƒå°±ä»»åŠ¡å…¶æœåŠ¡å·²ç»å¤±æ•ˆã€‚ æœåŠ¡æ¶ˆè´¹è€…èŽ·å–æœåŠ¡æ¸…å• æœåŠ¡æ¶ˆè´¹è€…ä¼šåœ¨å¯åŠ¨çš„ä½¿ç”¨é€šè¿‡restè¯·æ±‚èŽ·å–ä¸€ä»½æœåŠ¡æ¸…å•ï¼ˆfeth-registy=trueæ—¶ï¼‰ï¼Œå¹¶ç¼“å­˜30ç§’ï¼Œä¹‹åŽå†æ¬¡å‘æ³¨å†Œä¸­å¿ƒèŽ·å–ã€‚ 123eureka: client: registry-fetch-interval-seconds: 30 å½“Ribbonä¸Žeurekaè¿žç”¨æ—¶ï¼ŒRibbonçš„æœåŠ¡æ¸…å•RibbonServiceListä¼šè¢«DiscoveryEnableNIWSServiceListé‡å†™ï¼Œæ‹“å±•æˆäº†Eurekaæ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡åˆ—è¡¨ã€‚åŒæ—¶ï¼ŒNIWSDiscoveryPingæ¥å–ä»£IPingï¼Œå…¶èŒè´£ä¸ºç¡®è®¤æœåŠ¡æ˜¯å¦å¯åŠ¨ã€‚ æœåŠ¡è°ƒç”¨ æœåŠ¡åœ¨èŽ·å–æœåŠ¡åˆ—è¡¨ä¸­åŒ…å«äº†å…¶å®žä¾‹åå’Œè¯¥å®žä¾‹çš„å…ƒæ•°æ®ã€‚é»˜è®¤Ribbonæ˜¯é€šè¿‡è½®è¯¢çš„æ–¹å¼è¿›è¡Œè°ƒç”¨ï¼Œä»¥è¾¾åˆ°è´Ÿè½½å‡è¡¡çš„æ•ˆæžœã€‚ æœåŠ¡ä¸‹çº¿ å½“eurekaçš„å®¢æˆ·ç«¯æœåŠ¡è¿›è¡Œæ­£å¸¸ä¸‹çº¿æ—¶ï¼Œå…¶ä¼šå‘æ³¨å†Œä¸­å¿ƒå‘ä¸€ä¸ªrestè¯·æ±‚ï¼Œå‘ŠçŸ¥æ³¨å†Œä¸­å¿ƒæœåŠ¡ä¸‹çº¿ï¼ŒåŒæ—¶ï¼Œæ³¨å†Œä¸­å¿ƒä¹Ÿä¼šé€šçŸ¥å…¶ä»–æœåŠ¡è¯¥æœåŠ¡ä¸‹çº¿æ¶ˆæ¯ã€‚ æœåŠ¡æ³¨å†Œä¸­å¿ƒå¤±æ•ˆå‰”é™¤ å¦‚æžœæ˜¯éžæ­£å¸¸æœåŠ¡åœæ­¢çš„æƒ…å†µï¼Œæ³¨å†Œä¸­å¿ƒä¼šæ¯60ç§’å®šæ—¶åŽ»æ¸…é™¤æ¸…å•ä¸­è¶…æ—¶ç»­çº¦ï¼ˆ90sï¼‰çš„æœåŠ¡ã€‚ è‡ªæˆ‘ä¿æŠ¤ åœ¨æ³¨å†Œä¸­å¿ƒè¿è¡ŒæœŸé—´ï¼Œä¼šç»Ÿè®¡å¿ƒè·³å¤±è´¥çš„æ¯”ä¾‹åœ¨15åˆ†é’Ÿå†…æ˜¯å¦ä½ŽäºŽ85%ï¼Œå¦‚æžœå‡ºçŽ°ä½ŽäºŽçš„æƒ…å†µï¼Œä¼šå°†å½“å‰çš„å®žä¾‹æ³¨å†Œä¿¡æ¯ä¿æŠ¤èµ·æ¥ï¼Œè®©è¿™äº›å®žä¾‹ä¸ä¼šè¿‡æœŸã€‚ä»Žè€Œä¼šå¯¼è‡´ä¸€ä¸ªé—®é¢˜å°±æ˜¯å®¢æˆ·ç«¯è°ƒç”¨å·²ç»å¤±æ•ˆçš„æœåŠ¡ï¼Œä¼šå‡ºçŽ°é”™è¯¯ï¼Œæ‰€ä»¥éœ€è¦å®¹é”™æœºåˆ¶ã€‚ æ‰€ä»¥åœ¨æœ¬åœ°å¼€å‘çš„æ—¶å€™å¯ä»¥å…³é—­ä¿æŠ¤æœºåˆ¶ï¼Œ 123eureka: server: enable-self-preservation: false éšæœºæ•°12345$&#123;random.int[10000,19999]&#125;$&#123;random.int(100)&#125; #é™åˆ¶ç”Ÿæˆçš„æ•°å­—å°äºŽ10$&#123;random.int[0,100]&#125; #æŒ‡å®šèŒƒå›´çš„æ•°å­—$&#123;random.value&#125; #éšæœºå­—ç¬¦ä¸²$&#123;random.long&#125; #éšæœºlong å®žä¾‹åé…ç½®åœ¨ä½¿ç”¨æœåŠ¡é«˜å¯ç”¨çš„æ—¶å€™ï¼ŒåŒä¸€ä¸ªæœåŠ¡çš„ä¸åŒå®žä¾‹æ˜¯æ ¹æ®ä¸»æœºåè¿›è¡ŒåŒºåˆ†çš„ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ä¸€å°æœºå­æ— æ³•éƒ¨ç½²å¤šå°æœåŠ¡ï¼Œè§£å†³è¿™ä¸ªé—®é¢˜çš„ä¸€ç§æ–¹å¼æ˜¯é€šè¿‡æ›´æ”¹æœåŠ¡çš„ç«¯å£å·ï¼Œå¦ä¸€ç§æ˜¯é€šè¿‡ä½¿ç”¨ä¸åŒçš„å®žä¾‹åã€‚ 123eureka: instance: instanceId: $&#123;spring.application.name&#125;:$&#123;random.int&#125; å¥åº·æ£€æŸ¥åœ¨eurekaä¸­çš„å¥åº·æƒ…å†µæ˜¯æ ¹æ®æœåŠ¡æä¾›è€…çš„å¿ƒè·³æƒ…å†µï¼Œåªè¦ç»­çº¦æ­£å¸¸ï¼Œhealthä¸€ç›´æ˜¯upçŠ¶æ€ã€‚ ä½¿ç”¨éœ€è¦spring-boot-actuatoræ¨¡å—çš„/healthç«¯ç‚¹ã€‚ 1234eureka: client: healthcheck: enabled: true è‡ªå®šä¹‰Instance IDåœ¨Spring Cloudä¸­ï¼ŒæœåŠ¡çš„Instance IDçš„é»˜è®¤å€¼æ˜¯${spring.cloud.client.hostname}:${spring.application.name}:${spring.application.instance_id:${server.port}} ã€‚å¦‚æžœæƒ³è¦è‡ªå®šä¹‰è¿™éƒ¨åˆ†çš„å†…å®¹ï¼Œåªéœ€åœ¨å¾®æœåŠ¡ä¸­é…ç½®eureka.instance.instance-id å±žæ€§å³å¯ï¼Œä¾‹å¦‚ï¼š 123456spring: application: name: service-usereureka: instance: instance-id: $&#123;spring.cloud.client.ipAddress&#125;:$&#123;server.port&#125; # å°†Instance IDè®¾ç½®æˆIP:ç«¯å£çš„å½¢å¼ instanceIDåˆå§‹åŒ–ä»£ç  123org.springframework.cloud.netflix.eureka.EurekaClientAutoConfigurationorg.springframework.cloud.commons.util.IdUtils.getDefaultInstanceId(PropertyResolver)org.springframework.cloud.netflix.eureka.EurekaInstanceConfigBean.getInstanceId() TipsæœåŠ¡åœ¨å¯åŠ¨æ—¶ï¼Œä¼šé€šè¿‡restè¯·æ±‚æ–¹å¼æ³¨å†Œåˆ°eurekaã€‚æ³¨å†Œä¿¡æ¯æ˜¯é€šè¿‡åŒå±‚Mapè¿›è¡Œå­˜å‚¨ï¼Œç¬¬ä¸€å±‚keyä¸ºæœåŠ¡åï¼Œç¬¬äºŒå±‚çš„keyä¸ºå…·ä½“çš„å®žä¾‹åç§°ã€‚ other settings123eureka: instance: preferIpAddress: true #å®žä¾‹åç§°æ˜¾ç¤ºIP 1234eureka: client: healthcheck: enabled: true http://www.cnblogs.com/yangfei-beijing/p/6379258.html æºç å­¦ä¹ EndpointUtils èŽ·å–serviceUrl 123456// èŽ·å–é…ç½®æ–¹å¼å’ŒDNSæ–¹å¼èŽ·å–ServiceUrlåœ°å€getDiscoveryServiceUrls();// éåŽ†æ‰€æœ‰zoneï¼ŒèŽ·å–æ‰€æœ‰ServiceUrlåœ°å€ï¼Œå°†preferSameZoneä¸ºtrueæ—¶ï¼Œå°†instanceZoneä¸‹çš„ServiceUrlæ”¾åœ¨æœ€å‰é¢ï¼Œä¹Ÿå°±æ˜¯åŒä¸€ä¸ªä¸Žå®¢æˆ·ç«¯åŒä¸€ä¸ªzoneçš„ServiceUrlgetServiceUrlsFromConfig();// èŽ·å–ServiceUrlåœ°å€ï¼Œå…¶å®žçŽ°æ˜¯EurekaClientConfigBeanç±»getEurekaServerServiceUrls()ï¼› EurekaClientConfigBean è¯¥ç±»åŒ…å«äº†eureka.clientçš„é…ç½®ã€‚åŒ…æ‹¬ä¸€äº›å®šæ—¶ä»»åŠ¡é…ç½®ã€‚ 12// èŽ·å–ServiceUrlåœ°å€getEurekaServerServiceUrls()ï¼› com.netflix.discovery.DiscoveryClient æœ€é‡è¦çš„ç±»ï¼Œå®šæ—¶ä»»åŠ¡å’Œæ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒç­‰æ“ä½œéƒ½æ˜¯åœ¨è¿™é‡Œå®Œæˆçš„ã€‚ 123456// è¿™é‡Œå¯ç”¨æœåŠ¡èŽ·å–ï¼ŒæœåŠ¡ç»­çº¦ï¼ŒæœåŠ¡æ³¨å†Œç­‰å®šæ—¶ä»»åŠ¡ï¼ŒåŒæ—¶InstanceInfoReplicatorå¯¹è±¡ä¸­runæ–¹æ³•ä¸­çš„discoveryClient.register();è¿›è¡Œäº†æœåŠ¡çš„æ³¨å†ŒinitScheduledTasks();// è¿›è¡ŒæœåŠ¡çš„èŽ·å–ï¼Œå­˜åœ¨å…¨é‡å’Œéžå…¨é‡ä¸¤ç§fetchRegistry();// è¿›è¡Œå¿ƒè·³çš„ç»´æŒHeartbeatThread.renew(); EurekaInstanceConfigBean æœåŠ¡å®žä¾‹é…ç½®]]></content>
      <tags>
        <tag>spring-cloud</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è®¾è®¡æ¨¡å¼â€”â€”ç­–ç•¥æ¨¡å¼]]></title>
    <url>%2F2017%2F06%2F24%2Fstrategy201706024%2F</url>
    <content type="text"><![CDATA[ç­–ç•¥æ¨¡å¼æ˜¯ä¸ºäº†è§£å†³åœ¨åšåŒä¸€ä»¶äº‹çš„æ—¶å€™ï¼Œå­˜åœ¨å¤šç§å¯èƒ½å‘ç”Ÿæƒ…å†µé—®é¢˜ã€‚ ä»€ä¹ˆæ˜¯ç­–ç•¥æ¨¡å¼ ä»€ä¹ˆæ—¶å€™ä½¿ç”¨ å¦‚ä½•ä½¿ç”¨ ä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆ ä½¿ç”¨åœºæ™¯ä¸€ä¸ªå•†åœºä¸­ï¼Œé’ˆå¯¹ä¸åŒçš„æ¶ˆè´¹è€…ï¼Œè¿›è¡Œä¸åŒçš„æ¶ˆè´¹æ‰“æŠ˜ä¿ƒé”€ï¼Œæ™®é€šæ¶ˆè´¹è€…æ‰“9.8æŠ˜ï¼ŒVIPç”¨æˆ·æ‰“8æŠ˜ï¼ŒSVIPç”¨æˆ·æ‰“7.5æŠ˜ï¼Œé’ˆå¯¹æ‰“æŠ˜è¿™ä»¶äº‹ï¼Œå­˜åœ¨ä¸‰ç§æƒ…å†µéœ€è¦è€ƒè™‘ï¼Œé’ˆå¯¹ä¸åŒçš„äººï¼Œä½¿ç”¨ä¸åŒçš„è®¡ç®—æ–¹å¼ã€‚è¿™é‡Œå°±è¦ä½¿ç”¨ç­–ç•¥æ¨¡å¼åŽ»è§£å†³ã€‚ è¦ç´  é’ˆå¯¹é—®é¢˜çš„ä¸€ä¸ªæŽ¥å£ æŽ¥å£çš„å¤šç§ç­–ç•¥å®žçŽ° ä¸€ä¸ªæŽ¥å£çš„è°ƒç”¨æ–¹ ä½¿ç”¨12345678/** * Created by è¿¹_Jason on 2017/6/24. * ç­–ç•¥æ¨¡å¼æŽ¥å£ */public interface Discount &#123; Double discountMoney(Double total);&#125; 123456789/** * Created by è¿¹_Jason on 2017/6/24. * æ™®é€šæ¶ˆè´¹è€…æ‰“æŠ˜åŠ›åº¦ */public class CommonConsumerDiscount implements Discount &#123; public Double discountMoney(Double total) &#123; return total * 0.98; &#125;&#125; 123456789/** * Created by è¿¹_Jason on 2017/6/24. * svipæ‰“æŠ˜åŠ›åº¦ */public class SvipConsumerDiscount implements Discount &#123; public Double discountMoney(Double total) &#123; return total * 0.75; &#125;&#125; 123456789/** * Created by è¿¹_Jason on 2017/6/24. * vipæ‰“æŠ˜åŠ›åº¦ */public class VipConsumerDiscount implements Discount &#123; public Double discountMoney(Double total) &#123; return total * 0.8; &#125;&#125; 1234567891011121314151617/** * Created by è¿¹_Jason on 2017/6/24. * è°ƒç”¨ç­–ç•¥æŽ¥å£ */public class SumMoney &#123; Double sum(Discount consumerType) &#123; Double total = 7 * 2 + 5.3 * 8; return consumerType.discountMoney(total); &#125; public static void main(String[] args) &#123; Discount consumerType = new CommonConsumerDiscount(); SumMoney sumMoney = new SumMoney(); System.out.println(sumMoney.sum(consumerType)); &#125;&#125; ä¼˜ç‚¹ç¨‹åºæ›´åŠ çµæ´»ï¼Œæ‹“å±•æ€§æ›´å¥½ï¼Œå¯è¯»æ€§ä¹Ÿæ›´å¥½ å¯ä»¥æ›¿æ¢if-elseè¯­å¥çš„ä½¿ç”¨ ç¼ºç‚¹å¿…é¡»çŸ¥é“æœ‰å“ªäº›ç­–ç•¥ç±»ï¼Œæ¯ä¸ªç­–ç•¥ç±»çš„åŠŸèƒ½ å¦‚æžœç­–ç•¥å¾ˆå¤šï¼Œäº§ç”Ÿçš„ç­–ç•¥å®žçŽ°ç±»ä¹Ÿéžå¸¸å¤š]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[wagonæ’ä»¶ä½¿ç”¨]]></title>
    <url>%2F2017%2F06%2F20%2Fwagon20170620%2F</url>
    <content type="text"><![CDATA[wagonæ˜¯mavenæ’ä»¶ä¸­çš„ä¸€ç§ï¼Œå…¶ä½œç”¨æ˜¯åŽ»é™¤æˆ‘ä»¬éƒ¨ç½²æ—¶ç¹å¤çš„æ­¥éª¤ï¼Œä¸ç”¨å†æ‰‹åŠ¨ä¸Šä¼ jaråŒ…æˆ–è€…waråŒ…åˆ°æŒ‡å®šæœåŠ¡å™¨è·¯å¾„ä¸‹é¢ã€‚ é—®é¢˜æœ‰ä»€ä¹ˆç”¨ï¼Ÿ æ€Žä¹ˆç”¨ï¼Ÿ æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ ä½¿ç”¨pom.xml 12345678910111213141516171819202122232425262728293031323334&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;wagon-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;configuration&gt; &lt;!--è¿™é‡Œçš„idä¸Žä¹‹åŽçš„setting.xmlé…ç½®é¡¹ä¸­çš„è¦ä¸€è‡´ --&gt; &lt;serverId&gt;demo-test&lt;/serverId&gt; &lt;!--æœ¬åœ°åŒ…è·¯å¾„ --&gt; &lt;fromDir&gt;target/&lt;/fromDir&gt; &lt;!--ä¸Šä¼ å“ªäº›åŒ… --&gt; &lt;includes&gt;$&#123;project.artifactId&#125;.jar&lt;/includes&gt; &lt;!--åŒ…ä¿å­˜åˆ°æœåŠ¡å™¨å“ªä¸ªè·¯å¾„ä¸‹é¢ï¼Œæ³¨æ„æ˜¯scpï¼Œè¦æ”¯æŒè¿™ä¸ªå‘½ä»¤æ‰è¡Œ --&gt; &lt;url&gt;scp://172.168.1.11:22/opt/micservice&lt;/url&gt; &lt;!--æœåŠ¡å™¨ç›®æ ‡è·¯å¾„ï¼Œä¸Žurlé…åˆä½¿ç”¨ --&gt; &lt;toDir&gt;apps/$&#123;project.artifactId&#125;&lt;/toDir&gt; &lt;!--å› ä¸ºå­˜åœ¨æœåŠ¡å™¨çš„é‡å¯ä¹‹ç±»çš„æ“ä½œï¼Œwagonä¹Ÿæ”¯æŒä½¿ç”¨shellå‘½ä»¤ï¼Œå¯ä»¥æœ‰å¤šä¸ªcommandæ ‡ç­¾å“¦ï¼Œæ ¹æ®å…ˆåŽé¡ºåºæ‰§è¡Œ--&gt; &lt;commands&gt; &lt;command&gt;cd /opt/micservice/ ; ./dev restart $&#123;project.artifactId&#125; test&lt;/command&gt; &lt;/commands&gt; &lt;!-- æ˜¾ç¤ºè¿è¡Œå‘½ä»¤çš„è¾“å‡ºç»“æžœ --&gt; &lt;displayCommandOutputs&gt;true&lt;/displayCommandOutputs&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;extensions&gt; &lt;extension&gt; &lt;groupId&gt;org.apache.maven.wagon&lt;/groupId&gt; &lt;artifactId&gt;wagon-ssh&lt;/artifactId&gt; &lt;version&gt;2.8&lt;/version&gt; &lt;/extension&gt; &lt;/extensions&gt;&lt;/build&gt; setting.xml 12345678&lt;servers&gt; &lt;server&gt; ä¸Žä¸Šé¢çš„serverIdä¸€è‡´ &lt;id&gt;demo-test&lt;/id&gt; &lt;username&gt;username&lt;/username&gt; &lt;password&gt;password&lt;/password&gt; &lt;/server&gt;&lt;/servers&gt; é…ç½®å®ŒæˆåŽï¼Œè¿è¡Œå‘½ä»¤ï¼š 1mvn clean package wagon:upload wagon:sshexec wagon:upload-singleæ˜¯ä¸Šä¼ jaræˆ–è€…waråŒ… wagon:sshexecæ˜¯æ‰§è¡Œé…ç½®ä¸­çš„shellå‘½ä»¤ å¦‚æžœä¸æƒ³æ‰§è¡Œä¸Šé¢çš„è¿™ä¹ˆé•¿ä¸²å‘½ä»¤ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨execution 1234567891011121314151617181920212223242526272829303132333435363738&lt;build&gt; &lt;extensions&gt; &lt;extension&gt; &lt;groupId&gt;org.apache.maven.wagon&lt;/groupId&gt; &lt;artifactId&gt;wagon-ssh&lt;/artifactId&gt; &lt;version&gt;2.8&lt;/version&gt; &lt;/extension&gt; &lt;/extensions&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt; &lt;artifactId&gt;wagon-maven-plugin&lt;/artifactId&gt; &lt;version&gt;1.0&lt;/version&gt; &lt;executions&gt; &lt;execution&gt; &lt;id&gt;upload-deploy&lt;/id&gt; &lt;!-- è¿è¡Œpackageæ‰“åŒ…çš„åŒæ—¶è¿è¡Œupload-singleå’Œsshexec--&gt; &lt;phase&gt;package&lt;/phase&gt; &lt;goals&gt; &lt;goal&gt;upload-single&lt;/goal&gt; &lt;goal&gt;sshexec&lt;/goal&gt; &lt;/goals&gt; &lt;configuration&gt; &lt;serverId&gt;mylinuxserver&lt;/serverId&gt; &lt;fromFile&gt;target/javawebdeploy.war&lt;/fromFile&gt; &lt;url&gt;scp://192.168.20.128/coder/tomcat/apache-tomcat-7.0.55/webapps&lt;/url&gt; &lt;commands&gt; &lt;command&gt;sh /coder/tomcat/apache-tomcat-7.0.55/bin/shutdown.sh&lt;/command&gt; &lt;command&gt;rm -rf /coder/tomcat/apache-tomcat-7.0.55/webapps/javawebdeploy&lt;/command&gt; &lt;command&gt;sh /coder/tomcat/apache-tomcat-7.0.55/bin/startup.sh&lt;/command&gt; &lt;/commands&gt; &lt;displayCommandOutputs&gt;true&lt;/displayCommandOutputs&gt; &lt;/configuration&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; ä»¥ä¸Šmvn clean package æ¥ä»£æ›¿ mvn clean package wagon:upload-single wagon:sshexecï¼Œä½†ä¸ªäººè§‰å¾—ä¸æ˜¯ç‰¹åˆ«é€‚åˆå¼€å‘æ—¶æœŸï¼Œæˆ‘è§‰å¾—è¿˜æ˜¯ä½¿ç”¨å‘½ä»¤çš„æ–¹å¼æ‰§è¡Œï¼Œæˆ–è€…é€šè¿‡è‡ªå·±å†™ä¸€ä¸ªshellæ–‡ä»¶ï¼Œéœ€è¦çš„æ—¶å€™æ‰§è¡Œä¸€ä¸‹å³å¯ã€‚ Tipså…³äºŽä¸€äº›goals wagon:upload-single uploads the specified file to a remote location. wagon:upload uploads the specified set of files to a remote location. wagon:download-single downloads the specified file from a remote location. wagon:download downloads the specified set of files from a remote location. wagon:list lists the content of a specified location in a remote repository. wagon:copy copies a set of files under a Wagon repository to another. wagon:merge-maven-repos merges , including metadata, a Maven repository to another. wagon:sshexec Executes a set of commands at remote SSH host. å…¶ä»–çš„æ ‡ç­¾ skipå±žæ€§ï¼Œbooleanç±»åž‹ï¼Œé»˜è®¤æ˜¯trueï¼Œä½œç”¨æ˜¯å¿½ç•¥execution ä¼˜åŠ¿ åŽ»é™¤äº†å‘å¸ƒçš„é‡å¤åŠ¨ä½œï¼Œç›´æŽ¥ä¸€ä¸ªå‘½ä»¤å°±å¯ä»¥å®Œæˆ å°†äººä¸ºçš„é”™è¯¯é™ä½Žäº†ï¼Œå·¥ä½œæ›´åŠ é«˜æ•ˆ é“¾æŽ¥ å®˜æ–¹æ–‡æ¡£]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Gitå®žæˆ˜]]></title>
    <url>%2F2017%2F06%2F20%2Fgit20170303%2F</url>
    <content type="text"><![CDATA[å­¦ä¹ Gitæœ‰ä¸€æ®µæ—¶é—´äº†ï¼Œä¸€è·¯ä¸Šä¹Ÿä¸€ç›´åœ¨å†™æœ‰å…³äºŽGitæ–¹é¢çš„æ–‡ç« ï¼Œä½†æ€»è§‰å¾—ä¸æ˜¯æˆ‘æƒ³è¦çš„ï¼Œå°±æ˜¯æ„Ÿè§‰æœ‰ç‚¹è‚‰è‚‰çš„ï¼Œä¸å¤Ÿç›´æŽ¥ï¼Œä¸å¤Ÿé©¬ä¸Šå‡ºæ•ˆæžœï¼Œæ‰€ä»¥æ‰æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œå½“ç„¶è¿™æ–‡ç« å¯èƒ½ä¼šä¸æ–­æ›´æ–°å’Œä¿®æ­£ï¼Œå¸Œæœ›è¯»è€…å¯ä»¥ä½œä¸ºä¸€ä¸ªå·¥å…·æ–‡ç« ä½¿ç”¨ï¼Œæˆ‘ä¹Ÿä¼šåŠªåŠ›å°†å…¶ä¼˜åŒ–çš„æ›´åŠ çš„ç¬¦åˆå·¥ä½œåœºæ™¯ è¯´æ˜Ž 1ã€åœ¨[â€¦]ä¸­çš„å†…å®¹ï¼Œéœ€è¦æ ¹æ®å®žé™…æƒ…å†µè¿›è¡Œä¿®æ”¹ å¦‚ä½•æœ¬åœ°ä¸Žè¿œç¨‹å»ºç«‹ä¿¡ä»»è”ç³»ï¼Ÿè¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦ä½¿ç”¨SSHç§˜é’¥çš„æ–¹å¼ï¼ŒæŽ¥ä¸‹æ¥æˆ‘å°±è®²ä¸€ä¸‹æ€Žä¹ˆè¿›è¡Œé…ç½®ã€‚ 1.åœ¨æœ¬åœ°ç”Ÿæˆç§é’¥å’Œå…¬é’¥ 123git config --global user.name "username"//ç”¨æˆ·æ˜µç§°git config --global user.email "emailAddress"//githubæˆ–è€…gitlibçš„é‚®ç®±åœ°å€ssh-keygen -t rsa -C "emailAddress"//githubæˆ–è€…gitlibé‚®ç®±è´¦æˆ·åœ°å€ 2.å°†ç”µè„‘ä¸Šçš„å…¬é’¥ä¸Žè¿œç¨‹ä»“åº“è¿›è¡Œç»‘å®š æœ¬åœ°ä¼šåœ¨ä¸Šé¢çš„æ­¥éª¤ä¸­ä¼šç”Ÿæˆä¸€ä¸ªid_rsa.pubï¼ˆé»˜è®¤æƒ…å†µæ˜¯è¿™ä¸ªåç§°ï¼‰ï¼Œå°†è¯¥æ–‡ä»¶ä¸­çš„å†…å®¹copyåˆ°è¿œç¨‹ä»“åº“githubæˆ–gitlibçš„settingsçš„SSHé…ç½®é€‰é¡¹ä¸­ã€‚ Tittleåç§°è‡ªç”±å‘æŒ¥ å…‹éš†å·¥ç¨‹ å°†è¿œç¨‹çš„æ•°æ®å¤åˆ¶ä¸€ä»½åˆ°æœ¬åœ° 12#ã€ä»“åº“copyåœ°å€ã€‘git clone [git@rep.xx.com:zoeminghong/hello.git] [å·¥ç¨‹åˆ«å] æœ¬åœ°æ–°å»ºGitå·¥ç¨‹ çŽ°åœ¨æ‰“ç®—å°†æœ¬åœ°çš„å·¥ç¨‹ï¼Œæ”¾åˆ°Gitä»“åº“è¿›è¡Œæ‰˜ç®¡äº†ï¼Œå¹¶ä¸”è¿œç¨‹Gitä»“åº“å·²ç»åˆ›å»ºäº†è¯¥é¡¹ç›®çš„å·¥ç¨‹ 123456789101112131415161718#æœ¬åœ°åˆå§‹åŒ–å·¥ç¨‹ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.gitæ–‡ä»¶git init #å°†æœ¬åœ°çš„å·¥ç¨‹ä¸Žè¿œç¨‹ä»“åº“ä¸­çš„é¡¹ç›®è¿›è¡Œå…³è”ï¼ˆä¸ç”¨å…³å¿ƒé¡¹ç›®åä¸ä¸€è‡´çš„é—®é¢˜ï¼‰#æ­¤æ—¶æœ¬åœ°å·¥ç¨‹ä¸Žè¿œç¨‹ä»“åº“å·²ç»å»ºç«‹äº†è”ç³»git remote add origin [git@rep.xx.com:zoeminghong/hello.git]#åŽ»é™¤è¿œç¨‹ä»“åº“ç»‘å®šgit remote remove origin #å°†æœ¬åœ°æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°Gitä¸­ï¼Œè¿›è¡Œç›‘ç®¡git add . #å°†å†…å®¹æäº¤ ã€æäº¤æ³¨é‡Šã€‘git commit -m "[...]"#å°†æœ¬åœ°çš„å†…å®¹åŒæ­¥åˆ°è¿œç¨‹ä»“åº“ä¸­git push -u origin master æ˜¾ç¤ºæŸä¸€ä¸ªç‰¹å®šçš„æäº¤çš„æ—¥å¿—1git show [åå…­è¿›åˆ¶ç ] æŸ¥çœ‹æäº¤å›¾1git log --graph --pretty=oneline --abbrev-commit æŸ¥çœ‹å†²çªæœªå¤„ç†çš„æ–‡ä»¶åˆ—è¡¨1git ls-files -u æœ¬åœ°ä»£ç ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ æœ¬åœ°ä»£ç æœªcommitçš„å‰æä¸‹ï¼Œè§£å†³ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ 123456789101112131415161718192021git pull #å¤±è´¥#å°†å½“å‰ä¿®æ”¹è¿›è¡Œæš‚å­˜èµ·æ¥git stash#æˆ–git stash save "[æ³¨é‡Š]" #èŽ·å–æœ€æ–°çš„è¿œç¨‹ä»“åº“ä»£ç git pull #æ¢å¤æš‚å­˜çš„å†…å®¹git stash pop#stashå…¶ä»–æ“ä½œ#æ¢å¤æœ€è¿‘ä¸€æ¬¡saveçš„åŽŸå·¥ä½œåŒºå†…å®¹,ï¼Œå¹¶åˆ é™¤stashè®°å½•git stash pop#æ¢å¤æœ€è¿‘ä¸€æ¬¡saveçš„åŽŸå·¥ä½œåŒºå†…å®¹,ä½†ä¸åˆ é™¤stashè®°å½•git stash apply [æŒ‡å®šç‰ˆæœ¬]#åˆ é™¤stashè®°å½•git stash drop#èŽ·å–æš‚å­˜åˆ—è¡¨git stash list ä½†ï¼Œä¸Šé¢çš„ä¹Ÿå¯èƒ½å­˜åœ¨é—®é¢˜ï¼Œç”±äºŽæœ¬åœ°å­˜åœ¨æœªè¢«è¿½è¸ªçš„æ–‡ä»¶ï¼Œå¹¶ä¸”è¿œç¨‹ä»“åº“pullçš„æ—¶å€™ä¹Ÿå­˜åœ¨åŒåçš„æ–‡ä»¶ï¼Œå°±ä¼šå­˜åœ¨pullå¤±è´¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œåœ¨git stashåŽé¢è¿½åŠ  --include-untrackedï¼Œä¼šå°†è¿œç¨‹çš„æ–‡ä»¶ä¸Žæœ¬åœ°çš„æ–‡ä»¶èžåˆ stashåªä¼šä¿å­˜å½“å‰ç´¢å¼•å’Œå·¥ä½œç›®å½•çš„çŠ¶æ€ï¼Œå…¶ä¿å­˜çš„æ˜¯addå’Œcommitçš„ä¸­é—´çŠ¶æ€ï¼Œå¦‚æžœè¿˜æ²¡æœ‰è¢«gitè¿½è¸ªçš„æ–‡ä»¶ï¼Œæ˜¯ä¸ä¼šè¢«è®°å½•çš„ å¦‚æžœæˆ‘å¯¹æŸæ–‡ä»¶è¿›è¡Œäº†ä¿®æ”¹ï¼Œä½†æˆ‘ä¸æƒ³è¦pushåˆ°è¿œç¨‹ä»“åº“ï¼ŒåŒæ—¶æˆ‘åˆæƒ³èŽ·å–æœ€æ–°çš„ä¿®æ”¹è®°å½•12git stash savegit pull --rebase å¦‚æžœæš‚å­˜å†…å®¹çŽ°åœ¨ä¸æƒ³åœ¨å½“å‰åˆ†æ”¯æ¢å¤äº†ï¼Œè€Œæ˜¯æƒ³å•ç‹¬èµ·ä¸€ä¸ªåˆ†æ”¯1git stash branch [newBranchName] æƒ³è¦æŸ¥çœ‹å½“å‰å·¥ä½œåŒºä¸Žæš‚å­˜çŠ¶æ€å†…å®¹åŒºåˆ«1git stash show -p stash&#123;0&#125; æœ¬åœ°ä»£ç å·²ç»commitåŽï¼Œè§£å†³ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ 12345678# èŽ·å–è¿œç«¯åº“æœ€æ–°ä¿¡æ¯ ã€åˆ†æ”¯åç§°ã€‘git fetch origin [master] # åšæ¯”è¾ƒgit diff [æœ¬åœ°åˆ†æ”¯å] origin/[è¿œç¨‹åˆ†æ”¯å] # æ‹‰å–æœ€æ–°ä»£ç ï¼ŒåŒæ—¶ä¼šè®©ä½ mergeå†²çªgit pull æ–¹æ³•2 123456789101112131415161718192021# èŽ·å–æœ€æ–°ä»£ç åˆ°tmpåˆ†æ”¯ä¸Š [è¿œç¨‹çš„åˆ†æ”¯:æœ¬åœ°åˆ†æ”¯]git fetch origin [master:tmp] # å½“å‰åˆ†æ”¯ä¸Žtmpè¿›è¡Œæ¯”è¾ƒgit diff tmp # ä¿®æ”¹å†²çªéƒ¨åˆ†ï¼Œè¿›è¡Œæœ¬åœ°commitæ“ä½œgit add . git commit -m "[...]" # å°†tmpä¸­å†…å®¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ä¸­git merge tmp # åˆ é™¤åˆ†æ”¯git branch -d tmp åˆ é™¤æ–‡ä»¶ ä¿ç•™å‰¯æœ¬æ“ä½œ 1git rm --cache [æ–‡ä»¶å] ç›´æŽ¥æ–‡ä»¶åˆ é™¤ 1git rm [æ–‡ä»¶å] åŽæ‚”è¯ è¿˜åŽŸåˆ°æœ€è¿‘çš„ç‰ˆæœ¬ï¼ŒåºŸå¼ƒæœ¬åœ°åšçš„ä¿®æ”¹ï¼ˆå½“å‰æ–‡ä»¶ä¿®æ”¹æ²¡æœ‰è¿›è¡Œaddæ“ä½œçš„æ—¶å€™ï¼‰ 1git checkout -- [æ–‡ä»¶å] å–æ¶ˆå·²ç»æš‚å­˜çš„æ–‡ä»¶(æ’¤é”€å…ˆå‰â€git addâ€çš„æ“ä½œ) 12#å½“å‰HEADï¼Œè¿”å›žåˆ°ä¸Šä¸€æ¬¡commitç‚¹ï¼Œä¸ä¼šæœ‰ä»»ä½•æ—¥å¿—è®°å½•git reset HEAD --hard 1git reset HEAD [æ–‡ä»¶å] å›žé€€æ‰€æœ‰å†…å®¹åˆ°ä¸Šä¸€ä¸ªæäº¤ç‚¹ 12#æœ€è¿‘å†…å®¹å·²ç»commitçš„æƒ…å†µä¸‹git reset HEAD^ --hard å›žé€€è¿™ä¸ªæ–‡ä»¶çš„ç‰ˆæœ¬åˆ°ä¸Šä¸€ä¸ªç‰ˆæœ¬ 12#æœ€è¿‘å†…å®¹å·²ç»commitçš„æƒ…å†µä¸‹git reset HEAD^ [æ–‡ä»¶å] å°†æœ¬åœ°çš„çŠ¶æ€å›žé€€åˆ°å’Œè¿œç¨‹çš„ä¸€æ · 1git reset â€“-hard origin/[åˆ†æ”¯å] å›žé€€åˆ°æŸä¸ªç‰ˆæœ¬ 123# èŽ·å–æ‰€æœ‰çš„HEADæ›´æ”¹ä¿¡æ¯çš„sha1å€¼git refloggit reset [SHA1] å›žé€€åˆ°ä¸Šä¸€æ¬¡æäº¤çš„çŠ¶æ€ï¼ŒæŒ‰ç…§æŸä¸€æ¬¡çš„commitå®Œå…¨åå‘çš„è¿›è¡Œä¸€æ¬¡commit.(ä»£ç å›žæ»šåˆ°ä¸Šä¸ªç‰ˆæœ¬ï¼Œå¹¶æäº¤git) 1git revert HEAD ä½¿ç”¨resetæ˜¯ä¸ä¼šæœ‰æ—¥å¿—è®°å½•çš„ï¼Œrevertåˆ™ä¼šè¦æäº¤ä¸€ä¸ªè®°å½•ç‚¹ ä¿®æ”¹æœ€æ–°çš„æäº¤ä¿¡æ¯(ä¿®æ”¹æäº¤çš„æ³¨é‡Šä¿¡æ¯) 1git commit --amend resetä¸Žrevertçš„ä½¿ç”¨è¯´æ˜Ž resetä¸€èˆ¬ç”¨äºŽæœ¬åœ°è¿˜æ²¡æœ‰pushåˆ°è¿œç«¯çš„æ—¶å€™ï¼Œrevertåˆ™ç”¨äºŽæƒ³è¦è¿œç«¯ä¹Ÿè¿›è¡Œè®°å½•å›žé€€æ“ä½œçš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨pushä¹‹åŽã€‚ 1ã€å¦‚æžœä½ å·²ç»pushåˆ°è¿œç¨‹ä»“åº“ï¼Œresetåˆ é™¤æŒ‡å®šcommitä»¥åŽ,ä½ git pushå¯èƒ½å¯¼è‡´ä¸€å¤§å †å†²çª.ä½†æ˜¯revert å¹¶ä¸ä¼š 2ã€å¦‚æžœçŽ°æœ‰åˆ†æ”¯å’ŒåŽ†å²åˆ†æ”¯éœ€è¦åˆå¹¶çš„æ—¶å€™,reset æ¢å¤éƒ¨åˆ†çš„ä»£ç ä¾ç„¶ä¼šå‡ºçŽ°åœ¨åŽ†å²åˆ†æ”¯é‡Œ.ä½†æ˜¯revert æ–¹å‘æäº¤çš„commit å¹¶ä¸ä¼šå‡ºçŽ°åœ¨åŽ†å²åˆ†æ”¯é‡Œã€‚ æœ¬åœ°åˆ†æ”¯ä¸Žè¿œç¨‹åˆ†æ”¯ç›¸è¿ž æœ¬åœ°åˆ›å»ºäº†ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿œç¨‹ä¹Ÿæœ‰ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿›è¡Œä¸¤è€…å…³è” 1git checkout -b [æœ¬åœ°åˆ†æ”¯å] origin/[è¿œç¨‹åˆ†æ”¯å] Tagä½¿ç”¨ æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå¯èƒ½å­˜åœ¨çº¿ä¸Šå‘å¸ƒäº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œéœ€è¦ç»™è¿™ä¸ªç‰ˆæœ¬ä»£ç æ‰“ä¸Šä¸€ä¸ªæ ‡ç­¾ï¼Œåˆ°æ—¶å€™å¯ä»¥æ–¹ä¾¿å›žé€€åˆ°è¿™ä¸ªç‰ˆæœ¬ 12345678910# åˆ›å»ºtag ã€tagåã€‘git tag v1.0(git tag -a [v1.4] -m ['my version 1.4']) # æŸ¥çœ‹å­˜åœ¨çš„taggit tag(git tag -l ['v1.4.2.*']) # å°†tagæ›´æ–°åˆ°è¿œç¨‹ï¼Œç›´æŽ¥çš„pushæ˜¯ä¸ä¼šå°†tagåŒæ­¥ä¸ŠåŽ»git push origin --tags æŽ¥ä¸‹æ¥å°±è®²è§£å›žé€€åˆ°å…·ä½“çš„tag 123456789101112# ä¿å­˜å½“å‰ç¼–ç¨‹çŽ¯å¢ƒgit stash # åˆ‡æ¢å›žæŸä¸ªtagï¼ˆv1.0ï¼‰git show v1.0 #ã€sha1ã€‘git reset --hard [2da7ef1] # åˆ›å»ºåˆ†æ”¯æ¥ä¿å­˜tagçš„æ•°æ®ï¼Œtagåªæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„æ ‡è®°ï¼Œæ— æ³•æ‰¿è½½æ•°æ®çš„ä¿®æ”¹è®°å½•,ã€åˆ†æ”¯åã€‘git checkout -b [branchName] [tagName] # æŽ¥ç€ä½ å°±å¯ä»¥åœ¨è¿™é‡Œæ”¹å•Šæ”¹äº† åˆ‡æ¢å›žä¸»å¹²æˆ–å…¶ä»–åˆ†æ”¯ 1234567891011121314# åˆ‡æ¢åˆ†æ”¯git checkout master # æ—¥å¿—è®°å½•git reflog # æ˜¾ç¤ºstashåˆ—è¡¨git stash list # æ¢å¤ä¹‹å‰çš„å·¥ä½œçŽ¯å¢ƒä»£ç git stash apply # åˆ é™¤stashgit stash drop åˆ†æ”¯ä¸Žä¸»å¹²åˆå¹¶ 12345678git add .git commit -m "v1.1"git checkout [bill]# masteråˆ†æ”¯æœ€æ–°çš„ä»£ç åˆå¹¶åˆ°billåˆ†æ”¯ä¸Šgit rebase [master]git checkout master# billåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€åˆ†æ”¯åã€‘git merge [bill] å…³äºŽä»£ç çš„æ¯”è¾ƒ12345678910111213141516171819202122232425262728# æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚git diffgit diff [filename] # æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚ã€æ–‡ä»¶åã€‘git diff --cached [hello.txt]git diff --cached [HEADæˆ–è€…SHA1] [filename] # æ˜¾ç¤ºå·¥ä½œåŒºä¸Žå½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚git diff HEADgit diff [HEADæˆ–åˆ†æ”¯å] [filename] # æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ã€åˆ†æ”¯åã€‘git diff [first-branch]...[second-branch]git diff [SHA1] [SHA1] [filename]#åˆ†æ”¯ä¹‹é—´çš„å·®å¼‚#åˆ†æ”¯ä¹‹é—´çš„å·®å¼‚git diff [åˆ†æ”¯1] [åˆ†æ”¯2]git diff [åˆ†æ”¯1]..[åˆ†æ”¯2]#æŒ‡å®šæ–‡ä»¶git diff [åˆ†æ”¯1]:[file1] [åˆ†æ”¯2]:[file2]#æŸ¥çœ‹æŒ‡å®šæäº¤èŒƒå›´å†…çš„æ‰€æœ‰å˜æ›´æ–‡ä»¶æƒ…å†µgit diff --stat master~[èŒƒå›´å€¼] [åˆ†æ”¯å]git diff --stat master~5 tmp//è¿˜å¯ä»¥å€¼æŸ¥çœ‹å…·ä½“æŸä¸€ä¸ªæ–‡ä»¶git diff --stat master~5 tmp test.txt å®šä½å“ªä¸ªæäº¤ç‚¹å¯¼è‡´æ–‡ä»¶å‡ºçŽ°é—®é¢˜12345678910111213141516#å…ˆç¡®å®šèŒƒå›´git bisect startgit bisect bad #ä¸€èˆ¬éƒ½æ˜¯å½“å‰HEADæ˜¯åæäº¤ã€sha1ã€‘git bisect good a794f9bd96f06b57b4c10433e4d6abb3f0855749 #ä¸Šé¢çš„æ­¥éª¤å°±æ˜¯ç¡®å®šèŒƒå›´çš„ï¼ŒæŽ¥ä¸‹æ¥å°±æ˜¯å›žç­”gitçš„é—®é¢˜ï¼Œä»–æŒ‡å®šçš„æäº¤ç‚¹æ˜¯å¥½çš„è¿˜æ˜¯åçš„git bisect good//å¦‚æžœæ˜¯åçš„ï¼Œå°±badï¼Œç›´åˆ°ä½ æ‰¾åˆ°å“ªä¸ªæäº¤ç‚¹å¯¼è‡´å‡ºçŽ°é—®é¢˜#æŸ¥çœ‹ç»´æŠ¤æ—¥å¿—git bisect loggit branch#å®Œæˆæ“ä½œåŽï¼Œè¦å›žåˆ‡åˆ°å·¥ä½œåˆ†æ”¯ä¸Šgit bisect resetgit branchgit reset --hard fb47ddb2db... æ£€æŸ¥æ–‡ä»¶ä¸­æ¯ä¸€è¡Œä»£ç æ˜¯è°æäº¤çš„è®°å½•1git blame -L [èµ·å§‹è¡Œæ•°],[æ–‡ä»¶å] åˆ›å»ºåˆ†æ”¯123456#ä»¥å½“å‰èŠ‚ç‚¹ä½œä¸ºåˆ†æ”¯çš„å¼€å§‹èµ·ç‚¹git branch [åˆ†æ”¯å]#ä»¥SHA1ä½œä¸ºåˆ†æ”¯å¼€å§‹èµ·ç‚¹git branch [åˆ†æ”¯å] [SHA1]#åˆ›å»ºå¹¶åˆ‡æ¢åˆ†æ”¯,sha1ä»¥å“ªä¸ªèŠ‚ç‚¹ä½œä¸ºåˆ†æ”¯çš„èµ·ç‚¹git checkout -b [åˆ†æ”¯å] [SHA1] æ‹‰åŽ»è¿œç¨‹ä»“åº“åˆ†æ”¯ä»£ç 1234git checkout 1.0git pull#æˆ–è€…git checkout 1.0 origin/1.0 å¼€å‘çš„è¿‡ç¨‹ä¸­ç”Ÿæˆæ–°åˆ†æ”¯12345#å› å¯èƒ½å­˜åœ¨æœªè¢«gitç›‘ç®¡å’Œæœªæäº¤çš„å†…å®¹ï¼Œéœ€è¦å°†æœªæäº¤çš„å†…å®¹è¿›è¡Œç›‘ç®¡å’Œæš‚å­˜git add .git stash#åŒ…å«[SHA1]åŠä¹‹å‰çš„ä»£ç ä¼šè¢«copyç›—åˆ†æ”¯ä¸Šgit branch [åˆ†æ”¯å] [SHA1] é‡å‘½ååˆ†æ”¯ åœ¨gitä¸­é‡å‘½åè¿œç¨‹åˆ†æ”¯ï¼Œå…¶å®žå°±æ˜¯å…ˆåˆ é™¤è¿œç¨‹åˆ†æ”¯ï¼Œç„¶åŽé‡å‘½åæœ¬åœ°åˆ†æ”¯ï¼Œå†é‡æ–°æäº¤ä¸€ä¸ªè¿œç¨‹åˆ†æ”¯ã€‚ 12345678//æ˜¾ç¤ºçŽ°åœ¨åˆ†æ”¯git branch -av//åˆ é™¤è¿œç¨‹è¦åˆ é™¤çš„åˆ†æ”¯develgit push --delete origin devel//é‡å‘½åæœ¬åœ°åˆ†æ”¯develä¸ºdevelopgit branch -m devel develop//æŽ¨é€åˆ°è¿œç¨‹git push origin develop è¿™æ˜¯ç”±äºŽåœ¨ github ä¸­ï¼Œdevel æ˜¯é¡¹ç›®çš„é»˜è®¤åˆ†æ”¯ã€‚è¦è§£å†³æ­¤é—®é¢˜ï¼Œè¿™æ ·æ“ä½œï¼š è¿›å…¥ github ä¸­è¯¥é¡¹ç›®çš„ Settings é¡µé¢ï¼› è®¾ç½® Default Branch ä¸ºå…¶ä»–çš„åˆ†æ”¯ï¼ˆä¾‹å¦‚ masterï¼‰ï¼› é‡æ–°æ‰§è¡Œåˆ é™¤è¿œç¨‹åˆ†æ”¯å‘½ä»¤ã€‚ æŸ¥çœ‹è¿œç¨‹ä»“åº“åˆ†æ”¯1git branch -a èŽ·å–è¿œç¨‹ä»“åº“åˆ†æ”¯ä»£ç 1git fetch origin [è¿œç¨‹ä»“åº“åˆ†æ”¯å] [æœ¬åœ°ä»“åº“åˆ†æ”¯å] åˆ é™¤æœ¬åœ°åˆ†æ”¯1git branch -d [åˆ†æ”¯å] åˆ é™¤è¿œç¨‹ä»“åº“åˆ†æ”¯1git remote remove [åˆ†æ”¯å] æŸ¥çœ‹åˆ†æ”¯123git show-branch#æˆ–git branch åˆ†æ”¯å‰é¢éƒ½å­˜åœ¨*æˆ–è€…! *è¡¨ç¤ºå½“å‰åˆ†æ”¯ åœ¨â€“ä¹‹åŽçš„æ˜¯è®°å½•åˆ†æ”¯çš„æäº¤ä¿¡æ¯ åƒ*+ [tmp] è¿œç¨‹2å°±è¡¨ç¤ºè¯¥æäº¤å­˜åœ¨äºŽä¸¤ä¸ªåˆ†æ”¯ä¸­ æ˜¾ç¤ºæŸåˆ†æ”¯ä¸­æŸæ–‡ä»¶å†…å®¹1git show [åˆ†æ”¯å]:[æ–‡ä»¶å] æ˜¾ç¤ºæŸä¸ªèŠ‚ç‚¹æŸæ–‡ä»¶çš„å†…å®¹1git show [SHA1] [æ–‡ä»¶å] å…³äºŽåˆ‡æ¢åˆ†æ”¯çš„é€»è¾‘ å¦‚æžœå­˜åœ¨æœªè¢«gitè¿½è¸ªçš„æ–‡ä»¶ï¼Œgitæ˜¯ä¼šå°†å…¶å¿½ç•¥çš„ å¦‚æžœå­˜åœ¨å·²è¿½è¸ªä¸”è¢«ä¿®æ”¹æˆ–åˆ é™¤ï¼Œå¿…é¡»commitä¹‹åŽï¼Œæ‰èƒ½åˆ‡æ¢ å¦‚æžœè¦ä¸è®¡åŽæžœçš„æƒ…å†µï¼Œå¼ºåˆ‡ï¼ŒåŠ -f å°†å½“å‰çš„åˆ†æ”¯ä¿®æ”¹çš„å†…å®¹åŒæ­¥åˆ°å…¶ä»–çš„åˆ†æ”¯ä¸Šå‡å¦‚ä½ å¸Œæœ›å˜æ›´ä½œç”¨äºŽå¦ä¸€ä¸ªåˆ†æ”¯ä¸Šï¼Œä½†ç”±äºŽå½“å‰åˆ†æ”¯å¦‚æžœä¸æäº¤ï¼Œæ˜¯æ— æ³•åˆ‡æ¢åˆ°å¦ä¸€ä¸ªåˆ†æ”¯ä¸Šçš„ 1git checkout -m [å¦ä¸€ä¸ªåˆ†æ”¯å] å°†ä¸€ä¸ªåŒºé—´çš„æäº¤ï¼Œç§»æ¤åˆ°å¦ä¸€ä¸ªåˆ†æ”¯12#å½“å‰åˆ†æ”¯ï¼Œå¾—åˆ°devåˆ†æ”¯ä¸­dev~2ä¹‹å‰çš„æ‰€æœ‰æäº¤å†…å®¹git cherry-pick dev~2 cherry-pickä¼šç”Ÿæˆä¸€æ¡æ–°çš„æäº¤è®°å½• ä»£ç è¡Œæ•°ç»Ÿè®¡ç»Ÿè®¡æŸäººçš„ä»£ç æäº¤é‡ï¼ŒåŒ…æ‹¬å¢žåŠ ï¼Œåˆ é™¤ï¼š 1git log --author="$(git config --get user.name)" --pretty=tformat: --numstat | gawk '&#123; add += $1 ; subs += $2 ; loc += $1 - $2 &#125; END &#123; printf "added lines: %s removed lines : %s total lines: %s\n",add,subs,loc &#125;' - ç»Ÿè®¡æŸäººä¸€ä¸ªæœˆå†…çš„ä»£ç æäº¤é‡ï¼ŒåŒ…æ‹¬å¢žåŠ ï¼Œåˆ é™¤ï¼š 1git log --since=1.month.ago --author="$(git config --get user.name)" --pretty=tformat: --numstat | gawk '&#123; add += $1 ; subs += $2 ; loc += $1 - $2 &#125; END &#123; printf "added lines: %s removed lines : %s total lines: %s\n",add,subs,loc &#125;' - ä»“åº“æäº¤è€…æŽ’åå‰ 5ï¼ˆå¦‚æžœçœ‹å…¨éƒ¨ï¼ŒåŽ»æŽ‰ head ç®¡é“å³å¯ï¼‰ï¼š 1git log --pretty='%aN' | sort | uniq -c | sort -k1 -n -r | head -n 5 ä»“åº“æäº¤è€…ï¼ˆé‚®ç®±ï¼‰æŽ’åå‰ 5ï¼šè¿™ä¸ªç»Ÿè®¡å¯èƒ½ä¸ä¼šå¤ªå‡†ï¼Œå› ä¸ºå¾ˆå¤šäººæœ‰ä¸åŒçš„é‚®ç®±ï¼Œä½†ä¼šä½¿ç”¨ç›¸åŒçš„åå­— 1git log --pretty=format:%ae | gawk -- '&#123; ++c[$0]; &#125; END &#123; for(cc in c) printf "%5d %s\n",c[cc],cc; &#125;' | sort -u -n -r | head -n 5 è´¡çŒ®è€…ç»Ÿè®¡ï¼š 1git log --pretty='%aN' | sort -u | wc -l æäº¤æ•°ç»Ÿè®¡ï¼š 1git log --oneline | wc -l git log å‚æ•°è¯´æ˜Žï¼š â€“author æŒ‡å®šä½œè€…â€“stat æ˜¾ç¤ºæ¯æ¬¡æ›´æ–°çš„æ–‡ä»¶ä¿®æ”¹ç»Ÿè®¡ä¿¡æ¯ï¼Œä¼šåˆ—å‡ºå…·ä½“æ–‡ä»¶åˆ—è¡¨â€“shortstat ç»Ÿè®¡æ¯ä¸ªcommit çš„æ–‡ä»¶ä¿®æ”¹è¡Œæ•°ï¼ŒåŒ…æ‹¬å¢žåŠ ï¼Œåˆ é™¤ï¼Œä½†ä¸åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼šâ€“numstat ç»Ÿè®¡æ¯ä¸ªcommit çš„æ–‡ä»¶ä¿®æ”¹è¡Œæ•°ï¼ŒåŒ…æ‹¬å¢žåŠ ï¼Œåˆ é™¤ï¼Œå¹¶åˆ—å‡ºæ–‡ä»¶åˆ—è¡¨ï¼š -p é€‰é¡¹å±•å¼€æ˜¾ç¤ºæ¯æ¬¡æäº¤çš„å†…å®¹å·®å¼‚ï¼Œç”¨ -2 åˆ™ä»…æ˜¾ç¤ºæœ€è¿‘çš„ä¸¤æ¬¡æ›´æ–° ä¾‹å¦‚ï¼šgit log -p -2â€“name-only ä»…åœ¨æäº¤ä¿¡æ¯åŽæ˜¾ç¤ºå·²ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•â€“name-status æ˜¾ç¤ºæ–°å¢žã€ä¿®æ”¹ã€åˆ é™¤çš„æ–‡ä»¶æ¸…å•â€“abbrev-commit ä»…æ˜¾ç¤º SHA-1 çš„å‰å‡ ä¸ªå­—ç¬¦ï¼Œè€Œéžæ‰€æœ‰çš„ 40 ä¸ªå­—ç¬¦â€“relative-date ä½¿ç”¨è¾ƒçŸ­çš„ç›¸å¯¹æ—¶é—´æ˜¾ç¤ºï¼ˆæ¯”å¦‚ï¼Œâ€œ2 weeks agoâ€ï¼‰â€“graph æ˜¾ç¤º ASCII å›¾å½¢è¡¨ç¤ºçš„åˆ†æ”¯åˆå¹¶åŽ†å²â€“pretty ä½¿ç”¨å…¶ä»–æ ¼å¼æ˜¾ç¤ºåŽ†å²æäº¤ä¿¡æ¯ã€‚å¯ç”¨çš„é€‰é¡¹åŒ…æ‹¬ onelineï¼Œshortï¼Œfullï¼Œfuller å’Œ formatï¼ˆåŽè·ŸæŒ‡å®šæ ¼å¼ï¼‰ ä¾‹å¦‚ï¼š git log â€“pretty=oneline ; git log â€“pretty=short ; git log â€“pretty=full ; git log â€“pretty=fullerâ€“pretty=tformat: å¯ä»¥å®šåˆ¶è¦æ˜¾ç¤ºçš„è®°å½•æ ¼å¼ï¼Œè¿™æ ·çš„è¾“å‡ºä¾¿äºŽåŽæœŸç¼–ç¨‹æå–åˆ†æž ä¾‹å¦‚ï¼šgit log â€“pretty=format:â€â€%h - %an, %ar : %sâ€â€ ä¸‹é¢åˆ—å‡ºäº†å¸¸ç”¨çš„æ ¼å¼å ä½ç¬¦å†™æ³•åŠå…¶ä»£è¡¨çš„æ„ä¹‰ã€‚ é€‰é¡¹ è¯´æ˜Ž %H æäº¤å¯¹è±¡ï¼ˆcommitï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %h æäº¤å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %T æ ‘å¯¹è±¡ï¼ˆtreeï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %t æ ‘å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %P çˆ¶å¯¹è±¡ï¼ˆparentï¼‰çš„å®Œæ•´å“ˆå¸Œå­—ä¸² %p çˆ¶å¯¹è±¡çš„ç®€çŸ­å“ˆå¸Œå­—ä¸² %an ä½œè€…ï¼ˆauthorï¼‰çš„åå­— %ae ä½œè€…çš„ç”µå­é‚®ä»¶åœ°å€ %ad ä½œè€…ä¿®è®¢æ—¥æœŸï¼ˆå¯ä»¥ç”¨ -date= é€‰é¡¹å®šåˆ¶æ ¼å¼ï¼‰ %ar ä½œè€…ä¿®è®¢æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %cn æäº¤è€…(committer)çš„åå­— %ce æäº¤è€…çš„ç”µå­é‚®ä»¶åœ°å€ %cd æäº¤æ—¥æœŸ %cr æäº¤æ—¥æœŸï¼ŒæŒ‰å¤šä¹…ä»¥å‰çš„æ–¹å¼æ˜¾ç¤º %s æäº¤è¯´æ˜Žâ€“since é™åˆ¶æ˜¾ç¤ºè¾“å‡ºçš„èŒƒå›´ï¼Œ ä¾‹å¦‚ï¼š git log â€“since=2.weeks æ˜¾ç¤ºæœ€è¿‘ä¸¤å‘¨çš„æäº¤ é€‰é¡¹ è¯´æ˜Ž -(n) ä»…æ˜¾ç¤ºæœ€è¿‘çš„ n æ¡æäº¤ â€“since, â€“after ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹åŽçš„æäº¤ã€‚ â€“until, â€“before ä»…æ˜¾ç¤ºæŒ‡å®šæ—¶é—´ä¹‹å‰çš„æäº¤ã€‚ â€“author ä»…æ˜¾ç¤ºæŒ‡å®šä½œè€…ç›¸å…³çš„æäº¤ã€‚ â€“committer ä»…æ˜¾ç¤ºæŒ‡å®šæäº¤è€…ç›¸å…³çš„æäº¤ã€‚ ä¸€äº›ä¾‹å­ï¼š git log --until=1.minute.ago // ä¸€åˆ†é’Ÿä¹‹å‰çš„æ‰€æœ‰ log git log --since=1.day.ago //ä¸€å¤©ä¹‹å†…çš„log git log --since=1.hour.ago //ä¸€ä¸ªå°æ—¶ä¹‹å†…çš„ log git log --since=`.month.ago --until=2.weeks.ago //ä¸€ä¸ªæœˆä¹‹å‰åˆ°åŠä¸ªæœˆä¹‹å‰çš„log git log â€“since ==2013-08.01 â€“until=2013-09-07 //æŸä¸ªæ—¶é—´æ®µçš„ log git blameçœ‹çœ‹æŸä¸€ä¸ªæ–‡ä»¶çš„ç›¸å…³åŽ†å²è®°å½• ä¾‹å¦‚ï¼šgit blame index.html â€“date short å­æ¨¡å—ä¿ç•™å­ç»„ä»¶çš„çŽ°æœ‰ç›®å½•ç»“æž„çš„å®Œæ•´æ€§ï¼Œæ•…è€Œgitåˆ›é€ äº†ç±»ä¼¼äºŽmavenä¸­çš„moduleä¸€æ ·çš„åŠŸèƒ½ï¼Œæ¥å®žçŽ°å­æ¨¡å—çš„ç®¡ç† æ‰“ä¸ªæ¯”æ–¹ï¼šçŽ°åœ¨æˆ‘æœ‰ä¸€ä¸ªçˆ¶å·¥ç¨‹Aï¼Œå…¶å·¥ç¨‹è·¯å¾„ä¸‹é¢æœ‰äº”ä¸ªå­å·¥ç¨‹BCDEFï¼ŒæŒ‰ç…§å¾€å¸¸æ˜¯è¦git clone 6ä¸ªå·¥ç¨‹æ‰å¯ä»¥å®Œå…¨ä¸‹è½½æˆåŠŸï¼Œè€Œä¸”å·¥ç¨‹ä¸Žå·¥ç¨‹ä¹‹é—´çš„è·¯å¾„å…³ç³»ä¹Ÿä¸çŸ¥é“ã€‚çŽ°åœ¨æœ‰äº†gitmoduleså°±å¯ä»¥ç›´æŽ¥ä¸‹è½½Aå·¥ç¨‹å°±å¯ä»¥äº†ï¼Œå…¶ä»–çš„5ä¸ªå­å·¥ç¨‹éƒ½ä¼šè‡ªåŠ¨ä¸‹è½½ã€‚ æ–‡ä»¶.gitmoduleså­˜æ”¾åœ¨çˆ¶å·¥ç¨‹æ ¹ç›®å½•ä¸‹ 12345678910[submodule "others/B"] path = others/B url = https://rep.XXX.com/crm/B.git[submodule "sources/C"] path = sources/C url = https://rep.XXX.com/crm/C.git[submodule "sources/D"] path = sources/D url = https://rep.XXX.com/crm/D.git..... æ·»åŠ å­æ¨¡å— 1git submodules add [è¿œç¨‹ä»“åº“åœ°å€] [ç›¸å¯¹äºŽçˆ¶æ¨¡å—çš„ç›¸å¯¹è·¯å¾„] æ³¨ï¼š ç›´æŽ¥æ‰‹åŠ¨æ›´æ”¹gitmoduleæ–‡ä»¶æ˜¯æ²¡æœ‰ç”¨çš„å“¦ è¿œç¨‹ä»“åº“åœ°å€è¦å…ˆäºŽå­æ¨¡å—ä¹‹å‰å‡†å¤‡å¥½ å­æ¨¡å—çš„åç§°æ˜¯å¯ä»¥ä¸Ž[ç›¸å¯¹äºŽçˆ¶æ¨¡å—çš„ç›¸å¯¹è·¯å¾„]ä¸ä¸€è‡´çš„ åˆ›å»ºå®Œæˆä»¥åŽä¼šç”Ÿæˆ.gitmodulesä¸Ž.gitattributesè¿™ä¸¤ä¸ªæ–‡ä»¶ .gitmoduleså’Œ.git/configä¿å­˜ç€å­æ¨¡å—çš„ä¿¡æ¯ ä»Žè¿œç¨‹ä»“åº“èŽ·å–æ‰€æœ‰æ¨¡å—æ•°æ® 123456789#æ–¹å¼ä¸€git clone --recursive [è¿œç¨‹ä»“åº“åœ°å€]#æ–¹å¼äºŒgit clone [è¿œç¨‹çˆ¶ä»“åº“åœ°å€]cd [çˆ¶æ¨¡å—è·¯å¾„]git submodule initgit submodule updateæˆ–è€…git submodule update --init --recursive åˆ é™¤å­æ¨¡å—åŠŸèƒ½ å…ˆæ¸…ç©º.gitmodulesä¸­çš„å†…å®¹ å†æ‰§è¡Œæ–‡ä»¶çš„åˆ é™¤ â€”â€”â€”â€” å…¶ä»–å‘½ä»¤ 12# .gitmodulesä¸­å­æ¨¡å—çš„å†…å®¹æ›´æ–°åˆ°.git/configä¸­git submodule init gitmoduleså‚è€ƒ å…³é—­issueæ ¼å¼Fixes #45ï¼Œ45æ˜¯issueçš„IDï¼Œåœ¨ç›¸åº”çš„issueçš„é“¾æŽ¥åœ°å€å°±æœ‰ã€‚ å¯ä»¥å…³é—­issueçš„å…³é”®å­—ï¼š close closes closed fix fixes fixed resolve resolves resolved ä¸åŒçš„ä»“åº“ä¸­å…³é—­issue æ ¼å¼close username/repository#issue_number å…³é—­å¤šä¸ªissues æ ¼å¼closes #34, closes #23, and closes example_user/example_repo#42]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[åœ¨åœºæ™¯ä¸­ä½¿ç”¨Git]]></title>
    <url>%2F2016%2F11%2F08%2Fgit20161108%2F</url>
    <content type="text"><![CDATA[è¯´æ˜Ž 1ã€åœ¨[â€¦]ä¸­çš„å†…å®¹ï¼Œéœ€è¦æ ¹æ®å®žé™…æƒ…å†µè¿›è¡Œä¿®æ”¹ 1ã€å…‹éš†å·¥ç¨‹ å°†è¿œç¨‹çš„æ•°æ®å¤åˆ¶ä¸€ä»½åˆ°æœ¬åœ° 12#ã€ä»“åº“copyåœ°å€ã€‘git clone [git@rep.xx.com:zoeminghong/hello.git] 2ã€æœ¬åœ°æ–°å»ºGitå·¥ç¨‹ çŽ°åœ¨æ‰“ç®—å°†æœ¬åœ°çš„å·¥ç¨‹ï¼Œæ”¾åˆ°Gitä»“åº“è¿›è¡Œæ‰˜ç®¡äº†ï¼Œå¹¶ä¸”è¿œç¨‹Gitä»“åº“å·²ç»åˆ›å»ºäº†è¯¥é¡¹ç›®çš„å·¥ç¨‹ 123456789101112131415#æœ¬åœ°åˆå§‹åŒ–å·¥ç¨‹ï¼Œä¼šç”Ÿæˆä¸€ä¸ª.gitæ–‡ä»¶git init#å°†æœ¬åœ°çš„å·¥ç¨‹ä¸Žè¿œç¨‹ä»“åº“ä¸­çš„é¡¹ç›®è¿›è¡Œå…³è”ï¼ˆä¸ç”¨å…³å¿ƒé¡¹ç›®åä¸ä¸€è‡´çš„é—®é¢˜ï¼‰#æ­¤æ—¶æœ¬åœ°å·¥ç¨‹ä¸Žè¿œç¨‹ä»“åº“å·²ç»å»ºç«‹äº†è”ç³»git remote add origin [git@rep.xx.com:zoeminghong/hello.git]#å°†æœ¬åœ°æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°Gitä¸­ï¼Œè¿›è¡Œç›‘ç®¡git add .#å°†å†…å®¹æäº¤ ã€æäº¤æ³¨é‡Šã€‘git commit -m "[...]"#å°†æœ¬åœ°çš„å†…å®¹åŒæ­¥åˆ°è¿œç¨‹ä»“åº“ä¸­git push -u origin master 3ã€æœ¬åœ°ä»£ç ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ æœ¬åœ°ä»£ç æœªcommitçš„å‰æä¸‹ï¼Œè§£å†³ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ 12345678#å°†å½“å‰ä¿®æ”¹è¿›è¡Œæš‚å­˜èµ·æ¥git stash#èŽ·å–æœ€æ–°çš„è¿œç¨‹ä»“åº“ä»£ç git pull#æ¢å¤æš‚å­˜çš„å†…å®¹git stash pop æœ¬åœ°ä»£ç å·²ç»commitåŽï¼Œè§£å†³ä¸Žè¿œç¨‹ä»£ç å†²çªé—®é¢˜ 12345678# èŽ·å–è¿œç«¯åº“æœ€æ–°ä¿¡æ¯ ã€åˆ†æ”¯åç§°ã€‘git fetch origin [master]# åšæ¯”è¾ƒgit diff [æœ¬åœ°åˆ†æ”¯å] origin/[è¿œç¨‹åˆ†æ”¯å]# æ‹‰å–æœ€æ–°ä»£ç ï¼ŒåŒæ—¶ä¼šè®©ä½ mergeå†²çªgit pull æ–¹æ³•2 12345678910111213141516# èŽ·å–æœ€æ–°ä»£ç åˆ°tmpåˆ†æ”¯ä¸Š [è¿œç¨‹çš„åˆ†æ”¯:æœ¬åœ°åˆ†æ”¯]git fetch origin [master:tmp]# å½“å‰åˆ†æ”¯ä¸Žtmpè¿›è¡Œæ¯”è¾ƒgit diff tmp# ä¿®æ”¹å†²çªéƒ¨åˆ†ï¼Œè¿›è¡Œæœ¬åœ°commitæ“ä½œgit add .git commit -m "[...]"# å°†tmpä¸­å†…å®¹åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ä¸­git merge tmp# åˆ é™¤åˆ†æ”¯git branch -d tmp 4ã€å›žé€€åˆ°ä¸Šä¸€ä¸ªcommitèŠ‚ç‚¹ï¼Œæ— logè®°å½• å½“å‰å†…å®¹æ²¡æœ‰commitçš„æƒ…å†µä¸‹ 12# å½“å‰HEADï¼Œè¿”å›žåˆ°ä¸Šä¸€æ¬¡commitç‚¹ï¼Œä¸ä¼šæœ‰ä»»ä½•æ—¥å¿—è®°å½•git reset HEAD --hard æœ€è¿‘å†…å®¹å·²ç»commitçš„æƒ…å†µä¸‹ 1git reset HEAD^ --hard 5ã€å›žé€€åˆ°ä¸Šä¸€ä¸ªcommitèŠ‚ç‚¹ï¼Œå­˜åœ¨logè®°å½• å½“å‰å†…å®¹æ²¡æœ‰commitçš„æƒ…å†µä¸‹ 12# å½“å‰HEADï¼Œè¿”å›žåˆ°ä¸Šä¸€æ¬¡commitç‚¹git revert HEAD æœ€è¿‘å†…å®¹å·²ç»commitçš„æƒ…å†µä¸‹ 1git revert HEAD^ 6ã€åˆ‡æ¢åˆ°æŒ‡å®šcommitèŠ‚ç‚¹ ä¸å­˜åœ¨logè®°å½• 12345# èŽ·å–æ‰€æœ‰çš„HEADæ›´æ”¹ä¿¡æ¯çš„sha1å€¼git reflog# åˆ‡æ¢è‡³æŒ‡å®šçš„sha1èŠ‚ç‚¹git reset --hard [sha1å€¼] 7ã€åˆ é™¤æ–‡ä»¶ ä¿ç•™å‰¯æœ¬æ“ä½œ 1git rm --cache [æ–‡ä»¶å] è¿˜åŽŸæ“ä½œ 1git reset HEAD [æ–‡ä»¶å] ç›´æŽ¥æ–‡ä»¶åˆ é™¤ 1git rm [æ–‡ä»¶å] è¿˜åŽŸæ“ä½œ 123git reset HEAD [æ–‡ä»¶å]git checkout -- [æ–‡ä»¶å] 8ã€æœ¬åœ°åˆ†æ”¯ä¸Žè¿œç¨‹åˆ†æ”¯ç›¸è¿ž æœ¬åœ°åˆ›å»ºäº†ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿œç¨‹ä¹Ÿæœ‰ä¸€ä¸ªåˆ†æ”¯ï¼Œè¿›è¡Œä¸¤è€…å…³è” 1git checkout -b [æœ¬åœ°åˆ†æ”¯å] origin/[è¿œç¨‹åˆ†æ”¯å] 9ã€Tagä½¿ç”¨ æˆ‘ä»¬åœ¨å¼€å‘çš„æ—¶å€™ï¼Œå¯èƒ½å­˜åœ¨çº¿ä¸Šå‘å¸ƒäº†ä¸€ä¸ªç‰ˆæœ¬ï¼Œéœ€è¦ç»™è¿™ä¸ªç‰ˆæœ¬ä»£ç æ‰“ä¸Šä¸€ä¸ªæ ‡ç­¾ï¼Œåˆ°æ—¶å€™å¯ä»¥æ–¹ä¾¿å›žé€€åˆ°è¿™ä¸ªç‰ˆæœ¬ 12345678# åˆ›å»ºtag ã€tagåã€‘git tag v1.0# æŸ¥çœ‹å­˜åœ¨çš„taggit tag# å°†tagæ›´æ–°åˆ°è¿œç¨‹git push origin --tags æŽ¥ä¸‹æ¥å°±è®²è§£å›žé€€åˆ°å…·ä½“çš„tag 12345678910111213# ä¿å­˜å½“å‰ç¼–ç¨‹çŽ¯å¢ƒgit stash# åˆ‡æ¢å›žæŸä¸ªtagï¼ˆv1.0ï¼‰git show v1.0 #ã€sha1ã€‘git reset --hard [2da7ef1]# åˆ›å»ºåˆ†æ”¯æ¥ä¿å­˜tagçš„æ•°æ®ï¼Œtagåªæ˜¯ä¸€ä¸ªèŠ‚ç‚¹çš„æ ‡è®°ï¼Œæ— æ³•æ‰¿è½½æ•°æ®çš„ä¿®æ”¹è®°å½•,ã€åˆ†æ”¯åã€‘git checkout -b [bill]# æŽ¥ç€ä½ å°±å¯ä»¥åœ¨è¿™é‡Œæ”¹å•Šæ”¹äº† åˆ‡æ¢å›žä¸»å¹²æˆ–å…¶ä»–åˆ†æ”¯ 1234567891011121314# åˆ‡æ¢åˆ†æ”¯git checkout master# æ—¥å¿—è®°å½•git reflog# æ˜¾ç¤ºstashåˆ—è¡¨git stash list# æ¢å¤ä¹‹å‰çš„å·¥ä½œçŽ¯å¢ƒä»£ç git stash apply# åˆ é™¤stashgit stash drop åˆ†æ”¯ä¸Žä¸»å¹²åˆå¹¶ 123456git add .git commit -m "v1.1"# billåˆ†æ”¯åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ã€åˆ†æ”¯åã€‘git merge [bill] 10ã€å…³äºŽä»£ç çš„æ¯”è¾ƒ1234567891011# æ˜¾ç¤ºæš‚å­˜åŒºå’Œå·¥ä½œåŒºçš„å·®å¼‚$ git diff# æ˜¾ç¤ºæš‚å­˜åŒºå’Œä¸Šä¸€ä¸ªcommitçš„å·®å¼‚ã€æ–‡ä»¶åã€‘$ git diff --cached [hell.txt]# æ˜¾ç¤ºå·¥ä½œåŒºä¸Žå½“å‰åˆ†æ”¯æœ€æ–°commitä¹‹é—´çš„å·®å¼‚$ git diff HEAD# æ˜¾ç¤ºä¸¤æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ã€åˆ†æ”¯åã€‘$ git diff [first-branch]...[second-branch]]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ‰‹æŠŠæ‰‹å«ä½ ä¸€å°ç”µè„‘é…ç½®ä¸¤ä¸ªGitè´¦æˆ·]]></title>
    <url>%2F2016%2F09%2F28%2Fgit20160928%2F</url>
    <content type="text"><![CDATA[å‡è®¾çŽ¯å¢ƒ å¸å·ä¸€ï¼šgithub å¸å·äºŒï¼šgitlab é…ç½®å¸å·ä¸€ç”Ÿæˆsshå¯†é’¥1234561ã€å®‰è£…Gitè½¯ä»¶2ã€åœ¨æ¡Œé¢æ‰“å¼€Gitï¼Œè¿›è¡Œè®¾ç½®git config --global user.name "userName"//githubçš„å¸å·å(ä¹Ÿå¯ä»¥è‡ªå®šä¹‰)git config --global user.email "emailAdress"//githubçš„é‚®ç®±åœ°å€(ä¹Ÿå¯ä»¥è‡ªå®šä¹‰)3ã€ç”Ÿæˆsshå¯†é’¥ssh-keygen -t rsa -C "githubEmailAdress"//githubé‚®ç®±åœ°å€ ä¸€è·¯çš„å›žè½¦é”® githubç½‘ç«™é…ç½®åœ¨githubä¸Šå°†id_rsa.pubæ–‡ä»¶å†…å®¹æ·»åŠ ä¸Šï¼ˆæ€Žä¹ˆæ·»åŠ è¯·ç™¾åº¦ï¼‰ é…ç½®å¸å·äºŒç”Ÿæˆsshå¯†é’¥123ssh-keygen -t rsa -C "gitlabEmailAdress" # è®¾ç½®åç§°ä¸ºid_rsa_gitlabEnter file in which to save the key (/c/Users/Administrator/.ssh/id_rsa): id_rsa_gitlab åœ¨.ssh è·¯å¾„ä¸‹é¢ä¼šç”Ÿæˆä¸€ä¸ªid_rsa_gitlabæ–‡ä»¶ æ–°å¯†é’¥æ·»åŠ åˆ°SSH agentä¸­12ssh-agent bashssh-add ~/.ssh/id_rsa_work åˆ›å»ºä¸€ä¸ªconfigæ–‡ä»¶ï¼ˆæ²¡æœ‰æ–‡ä»¶åŽç¼€åï¼‰123456789101112# è¯¥æ–‡ä»¶ç”¨äºŽé…ç½®ç§é’¥å¯¹åº”çš„æœåŠ¡å™¨# Default github userHost githubHostName github.comUser gitIdentityFile C:/Users/Administrator/.ssh/id_rsa# second userHost gitlabHostName your gitlab host addressUser gitIdentityFile C:/Users/Administrator/.ssh/id_rsa_gitlab gitlabç½‘ç«™é…ç½®å°†id_rsa_gitlab.pubä¸­çš„å†…å®¹æ·»åŠ åˆ°gitlabå¸å·ä¸‹çš„SSH Keyä¸­ æµ‹è¯•1234567$ ssh -T githubHi jj! You've successfully authenticated, but GitHub does not provide shell access.$ ssh -T gitlabHi jj! You've successfully authenticated, but GitHub does not provide shell access. è¿™é‡Œçš„githubä¸Žgitlabå°±æ˜¯configæ–‡ä»¶ä¸­çš„Hostå€¼ è¿ç”¨æ­£å¸¸æƒ…å†µæˆ‘ä»¬è¦cloneä¸€ä¸ªgithubå·¥ç¨‹æ˜¯è¿™æ ·çš„ 1git@github.com:jj/JForm.git å¦‚ä»Šåœ¨githubå·¥ç¨‹æ˜¯è¿™æ ·çš„ 1git clone github:jj/JForm.git åŽŸå› å°±æ˜¯config è¿˜æœ‰ä¸€ä¸ªé—®é¢˜å°±æ˜¯æäº¤çš„é‚®ç®±åœ°å€å’Œç”¨æˆ·åæ˜¯æ ¹æ®ä¸‹é¢é…ç½® 12git config --global user.name "userName"//githubçš„å¸å·å(ä¹Ÿå¯ä»¥è‡ªå®šä¹‰)git config --global user.email "emailAdress"//githubçš„é‚®ç®±åœ°å€(ä¹Ÿå¯ä»¥è‡ªå®šä¹‰)]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨NodeJSè°ƒç”¨Dubboå·¥ç¨‹]]></title>
    <url>%2F2016%2F07%2F27%2Fnode20160727%2F</url>
    <content type="text"><![CDATA[ä½¿ç”¨node-zookeeper-dubboæ¨¡å—è¿›è¡Œå¤„ç†ï¼Œå®˜æ–¹çš„æ–‡æ¡£è¿˜æ˜¯æœ‰äº›ç®€é™‹ï¼Œæˆ‘è¿›è¡Œè¿›ä¸€æ­¥çš„è®²è§£ 1ã€å®‰è£…node-zookeeper-dubbo12npm install node-zookeeper-dubbo --savenpm install request --save 2ã€ç¤ºä¾‹1234567891011121314151617181920212223var request = require('request');var Service=require('node-zookeeper-dubbo'); var opt=&#123; env:'1.0.1', // dubboæœåŠ¡ç«¯ç‰ˆæœ¬å· group:'test', // dubbo groupï¼ˆProductï¼ŒDevï¼ŒTestï¼‰ conn:'10.10.13.11:2181', // zookeeper url path:'com.che.app.service.IAppFinanceService' // serviceæŽ¥å£åœ°å€ //version:'1.0.1' // dubboçš„ç‰ˆæœ¬å·ï¼Œå¯ä»¥çœç•¥ &#125;; var method="getAssetInfoByPhone";//æ–¹æ³•å var arg1=&#123;$class:'java.lang.String',$:'13100000001'&#125;//å‚æ•°1 var arg2=&#123;$class:'int',$:12208&#125;//å‚æ•°2 var args=[arg1,arg2];//å‚æ•°æ•°ç»„ var service = new Service(opt);//è¿žæŽ¥zk service.excute(method,args,function(err,data)&#123; if(err)&#123; console.log(err); return; &#125; console.log(data) &#125;); å‚æ•°è®²è§£ å¯¹äºŽåŸºæœ¬æ•°æ®ç±»åž‹ç›´æŽ¥å¡«å†™ï¼šintï¼Œshortï¼Œlongï¼Œbooleanï¼Œfloatï¼Œdoubleã€‚ å¯¹äºŽéžåŸºæœ¬ç±»åž‹éœ€è¦å®Œæ•´çš„ç±»è·¯å¾„åï¼šjava.lang.Stringç­‰ã€‚]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[CanvasåŸºç¡€ç§¯ç´¯]]></title>
    <url>%2F2016%2F07%2F12%2Fcanvas20160712%2F</url>
    <content type="text"><![CDATA[åˆ›å»ºcanvas1&lt;canvas id="canvas"&gt;&lt;/canvas&gt; ä¸€èˆ¬éƒ½è¦å­˜åœ¨ID widthå’Œheightå»ºè®®ç›´æŽ¥åœ¨&lt;canvas&gt;ä¸­ç›´æŽ¥è®¾å®šï¼Œä¸è¦ä½¿ç”¨cssçš„æ–¹å¼åŽ»è®¾å®šé•¿å’Œé«˜ï¼Œå¹¶ä¸”å…¶æ˜¯æ²¡æœ‰pxå•ä½çš„ï¼Œå› å…¶ä¹Ÿè¡¨ç¤ºç²¾åº¦ widthå’Œheightè¿˜å¯ä»¥ä½¿ç”¨JSçš„æ–¹å¼è¿›è¡Œè®¾å®šï¼Œåœ¨Elementå¯¹è±¡ä¸­å­˜åœ¨widthå’Œheightå±žæ€§ï¼Œå¯ä»¥è¿›è¡Œè®¾å®š èŽ·å–Canvaså¯¹è±¡12var canvas=document.getElementById("canvas");var context= canvas.getContext(); contextå°±æ˜¯canvaså¯¹è±¡ï¼ŒæŽ¥ä¸‹æ¥éƒ½æ˜¯å¯¹å…¶è¿›è¡Œæ“ä½œ è®¾ç½®widthå’Œheight 12canvas.width = 1024;canvas.height = 768; ç›´çº¿123456context.strokeStyle="#005588";//è®¾ç½®é¢œè‰²ï¼Œredè¿™ç§æ–¹å¼ä¹Ÿæ˜¯å¯ä»¥çš„context.lineWidth=5;//çº¿å®½context.moveTo(100,100);//è¡¨ç¤ºç”»ç¬”çš„èµ·ç‚¹åæ ‡context.lineTo(700,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.lineTo(1000,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.stroke();//ç»˜åˆ¶çº¿æ¡ å¤šè¾¹å½¢12345context.fillStyle="rgb(2,100,30)";//é¢œè‰²context.moveTo(100,100);//è¡¨ç¤ºç”»ç¬”çš„èµ·ç‚¹åæ ‡context.lineTo(700,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.lineTo(1000,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.fill(); 123context.fillStyle="rgb(2,100,30)";//é¢œè‰²context.arc( x , y , RADIUS , 0 , 2*Math.PI,false )//ç”»åœ†ï¼Œå‚æ•°ä¾æ¬¡ï¼šæ¨ªåæ ‡ï¼Œçºµåæ ‡ï¼ŒåŠå¾„ï¼Œç”»åœ†èµ·ç‚¹ï¼Œç”»åœ†ç»ˆç‚¹ï¼Œæ˜¯å¦ä¸ºé¡ºæ—¶é’ˆæ–¹å‘ç”»åœ†context.fill(); fill()ä¼šå°†é¢œè‰²å¡«å…… å¼€å§‹å’Œç»“æŸ1234567891011context.fillStyle="rgb(2,100,30)";//é¢œè‰²context.moveTo(100,100);//è¡¨ç¤ºç”»ç¬”çš„èµ·ç‚¹åæ ‡context.lineTo(700,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.lineTo(1000,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.fill();context.strokeStyle="#005588";//è®¾ç½®é¢œè‰²ï¼Œredè¿™ç§æ–¹å¼ä¹Ÿæ˜¯å¯ä»¥çš„context.lineWidth=5;//çº¿å®½context.moveTo(100,100);//è¡¨ç¤ºç”»ç¬”çš„èµ·ç‚¹åæ ‡context.lineTo(700,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.lineTo(1000,700);//è¡¨ç¤ºä¸‹ä¸€ç¬”çš„åæ ‡context.stroke();//ç»˜åˆ¶çº¿æ¡ è¿™ä»£ç æ˜¾ç¤ºçš„ç»“æžœï¼Œå…¶å®žä¸æ˜¯æˆ‘ä»¬æƒ³çš„é‚£æ ·ï¼Œå…¶å®žè¿˜æ˜¯å­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå› fill()ä¸Šæ–¹çš„è·¯å¾„çŠ¶æ€è¿˜æ˜¯å­˜åœ¨æœ‰æ•ˆçš„ï¼Œæ‰€ä»¥ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¼•å…¥äº†beginPath()å’ŒclosePath() beginPath():å¼€å§‹è·¯å¾„ï¼Œè¡¨ç¤ºç”»ç¬”çŠ¶æ€çš„å¼€å§‹ closePath():ç»“æŸè·¯å¾„ï¼Œç»“æŸä¸€ä¸ªè·¯å¾„ï¼Œå¦‚æžœè·¯å¾„ä¸æ˜¯å°é—­çš„ï¼Œä¼šå°†å…¶å˜ä¸ºå°é—­ æ¸…é™¤1context.clearRect(0,0,1024, 768); å‚æ•°è¡¨ç¤ºæ¸…é™¤çš„åæ ‡èŒƒå›´]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JFormJSè¯´æ˜Žæ–‡æ¡£]]></title>
    <url>%2F2016%2F07%2F07%2Fjform20160707%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰ä½¿ç”¨äº†å¾ˆå¤šJqueryçš„è¡¨å•æ’ä»¶ï¼Œä¸€ç›´ç”¨çš„å¾ˆä¸èˆ’æœï¼Œä¸èƒ½æ»¡è¶³æˆ‘çŽ°åœ¨çš„å·¥ä½œï¼Œæ‰€ä»¥å°±èŒç”Ÿäº†è‡ªå·±å†™ä¸€ä¸ªæ’ä»¶çš„æƒ³æ³•ï¼ŒäºŽæ˜¯å°±æœ‰äº†JFormJS Githubä¸‹è½½åœ°å€ï¼šhttps://github.com/zoeminghong/JForm åœ¨å¼€å‘ä½¿ç”¨çš„æ—¶å€™åªè¦å¯¼å…¥jForm.values.min.jsæ–‡ä»¶å°±å¯ä»¥äº† ç”¨äºŽHTMLçš„è¡¨å•åˆå§‹åŒ–èµ‹å€¼å’Œè¡¨å•æ•°æ®æäº¤çš„è½»é‡çº§Jqueryæ’ä»¶ ç±»åž‹ é…ç½® textã€textarea data-text=â€textâ€ checkbox data-text=â€checkboxâ€ select data-text=â€selectâ€ radio data-text=â€radioâ€ è¡¨å•èµ‹å€¼ç›®å‰åªæ”¯æŒJsonæ ¼å¼æ•°æ®è¿›è¡Œè¡¨å•åˆå§‹åŒ– è°ƒç”¨æ–¹å¼ï¼š 1forms.resetValues(formID,jsonData); Demo 1234567891011121314151617181920212223242526&lt;body&gt;&lt;div&gt; &lt;form method="post" id="formDemo"&gt; &lt;input name="first" type="text" data-text="text"&gt; &lt;textarea name="firstArea" cols="20" rows="5" data-text="text"&gt;&lt;/textarea&gt; &lt;input type="checkbox" name="checkboxFirst" value="1" data-text="checkbox"&gt;1 &lt;input type="checkbox" name="checkboxFirst" value="2" data-text="checkbox"&gt;2 &lt;select name="selectFirst" data-text="select"&gt; &lt;option value="1"&gt;1&lt;/option&gt; &lt;option value="2"&gt;2&lt;/option&gt; &lt;option value="3"&gt;3&lt;/option&gt; &lt;/select&gt; &lt;input type="radio" name="radioFisrt" value="1" data-text="radio"&gt;1 &lt;input type="radio" name="radioFisrt" value="2" data-text="radio"&gt;2 &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; $(function()&#123; setValue(); function setValue()&#123; var json=&#123;first:"11",firstArea:"22",checkboxFirst:[1],checkboxSecond:[4],selectFirst:3,radioFisrt:2,radioSecond:2&#125;; forms.resetValues("formDemo",json); &#125; &#125;);&lt;/script&gt; èŽ·å–è¡¨å•å€¼æœ€åŽèŽ·å–å¾—åˆ°çš„æ˜¯Jsonå¯¹è±¡ è°ƒç”¨æ–¹å¼ 1forms.values(formID); Demo 123456789101112131415161718192021222324&lt;body&gt;&lt;div&gt; &lt;form method="post" id="formDemo"&gt; &lt;input name="first" type="text" data-text="text"&gt; &lt;textarea name="firstArea" cols="20" rows="5" data-text="text"&gt;&lt;/textarea&gt; &lt;input type="checkbox" name="checkboxFirst" value="1" data-text="checkbox"&gt;1 &lt;input type="checkbox" name="checkboxFirst" value="2" data-text="checkbox"&gt;2 &lt;select name="selectFirst" data-text="select"&gt; &lt;option value="1"&gt;1&lt;/option&gt; &lt;option value="2"&gt;2&lt;/option&gt; &lt;option value="3"&gt;3&lt;/option&gt; &lt;/select&gt; &lt;input type="radio" name="radioFisrt" value="1" data-text="radio"&gt;1 &lt;input type="radio" name="radioFisrt" value="2" data-text="radio"&gt;2 &lt;button onclick="getValue();"&gt;ç¡®å®š&lt;/button&gt; &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;script&gt; function getValue()&#123; forms.values("formDemo"); &#125; &lt;/script&gt; ä»¥ä¸Š ä½œè€…ï¼š@è¿¹_Jason æ›´æ–°æ—¥æœŸï¼š2016/07/07 å¾®ä¿¡å·ï¼šzoeminghong å¾®ä¿¡å…¬ä¼—å·ï¼šAPPZone]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Springçš„Redisé…ç½®ä¸Žä½¿ç”¨]]></title>
    <url>%2F2016%2F07%2F07%2Fredis20160707%2F</url>
    <content type="text"><![CDATA[Redisæ˜¯ä¸€ç§ç‰¹æ®Šç±»åž‹çš„æ•°æ®åº“ï¼Œä»–è¢«ç§°ä¹‹ä¸ºkey-valueå­˜å‚¨ æœ¬æ–‡è¦†ç›–ç¼“å­˜å’Œå­˜å‚¨ä¸¤æ–¹é¢è¿›è¡Œè¯´æ˜Žï¼Œä½¿ç”¨çš„æ˜¯Spring 4.0å’ŒJavaé…ç½®æ–¹å¼ ä»£ç åœ°å€ä¸‹è½½åœ°å€ï¼šhttps://github.com/zoeminghong/springmvc-javaconfig å­˜å‚¨Redisçš„é…ç½®12345678910111213141516171819202122232425262728293031323334353637383940414243444546package springmvc.rootconfig;import org.springframework.cache.CacheManager;import org.springframework.cache.annotation.EnableCaching;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.data.redis.cache.RedisCacheManager;import org.springframework.data.redis.connection.RedisConnectionFactory;import org.springframework.data.redis.connection.jedis.JedisConnectionFactory;import org.springframework.data.redis.core.RedisTemplate;@Configuration@EnableCachingpublic class CachingConfig &#123; /** * è¿žæŽ¥Redis * * @return */ @Bean public JedisConnectionFactory redisConnectionFactory() &#123; JedisConnectionFactory jedisConnectionFactory = new JedisConnectionFactory(); // hoståœ°å€ jedisConnectionFactory.setHostName("10.10.13.12"); // ç«¯å£å· jedisConnectionFactory.setPort(6379); jedisConnectionFactory.afterPropertiesSet(); return jedisConnectionFactory; &#125; /** * RedisTemplateé…ç½® * * @param redisCF * @return */ @Bean public RedisTemplate&lt;String, Object&gt; redisTemplate( RedisConnectionFactory redisCF) &#123; RedisTemplate&lt;String, Object&gt; redisTemplate = new RedisTemplate&lt;String, Object&gt;(); redisTemplate.setConnectionFactory(redisCF); redisTemplate.afterPropertiesSet(); return redisTemplate; &#125;&#125; Redisè¿žæŽ¥å·¥åŽ‚ JedisConnectionFactory JredisConnectionFactory LettuceConnectionFactory SrpConnectionFactory å»ºè®®è‡ªè¡Œæµ‹è¯•é€‰ç”¨åˆé€‚è‡ªå·±çš„è¿žæŽ¥å·¥åŽ‚ å¦‚æžœä½¿ç”¨çš„æ˜¯localhostå’Œé»˜è®¤ç«¯å£ï¼Œåˆ™è¿™ä¸¤é¡¹çš„é…ç½®å¯ä»¥çœç•¥ RedisTemplate RedisTemplate StringRedisTemplate RedisTemplateèƒ½å¤Ÿè®©æˆ‘ä»¬æŒä¹…åŒ–å„ç§ç±»åž‹çš„keyå’Œvalueï¼Œå¹¶ä¸ä»…é™äºŽå­—èŠ‚æ•°ç»„ StringRedisTemplateæ‰©å±•äº†RedisTemplateï¼Œåªèƒ½ä½¿ç”¨Stringç±»åž‹ StringRedisTemplateæœ‰ä¸€ä¸ªæŽ¥å—RedisConnectionFactoryçš„æž„é€ å™¨ï¼Œå› æ­¤æ²¡æœ‰å¿…è¦åœ¨æž„å»ºåŽåœ¨è°ƒç”¨setConnectionFactory() ä½¿ç”¨RedisTemplateAPI æ–¹æ³• å­APIæŽ¥å£ æè¿° opsForValue() ValueOperations&lt;K,V&gt; æè¿°å…·æœ‰ç®€å•å€¼çš„æ¡ç›® opsForList() ListOperations&lt;K,V&gt; æ“ä½œå…·æœ‰listå€¼çš„æ¡ç›® opsForSet() SetOperations&lt;K,V&gt; æ“ä½œå…·æœ‰setå€¼çš„æ¡ç›® opsForZSet() ZSetOperations&lt;K,V&gt; æ“ä½œå…·æœ‰ZSetå€¼ï¼ˆæŽ’åºçš„setï¼‰çš„æ¡ç›® opsForHash() HashOperations&lt;K,HK,VH&gt; æ“ä½œå…·æœ‰hashå€¼çš„æ¡ç›® boundValueOps(K) BoundValueOperations&lt;K,V&gt; ä»¥ç»‘å®šæŒ‡å®škeyçš„æ–¹å¼ï¼Œæ“ä½œå…·æœ‰ç®€å•å€¼çš„æ¡ç›® boundListOps(K) BoundListOperations&lt;K,V&gt; ä»¥ç»‘å®šæŒ‡å®škeyçš„æ–¹å¼ï¼Œæ“ä½œå…·æœ‰listçš„æ¡ç›® boundSetOps(K) BoundSetOperations&lt;K,V&gt; ä»¥ç»‘å®šæŒ‡å®škeyçš„æ–¹å¼ï¼Œæ“ä½œå…·æœ‰setçš„æ¡ç›® boundZSet(K) BoundZSetOperations&lt;K,V&gt; ä»¥ç»‘å®šæŒ‡å®škeyçš„æ–¹å¼ï¼Œæ“ä½œå…·æœ‰ZSetï¼ˆæŽ’åºçš„setï¼‰çš„æ¡ç›® boundHashOps(K) BoundHashOperations&lt;K,V&gt; ä»¥ç»‘å®šæŒ‡å®škeyçš„æ–¹å¼ï¼Œæ“ä½œå…·æœ‰hashå€¼çš„æ¡ç›® æ“ä½œ 12345678910111213141516171819202122232425package springmvc.web;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.mongodb.core.MongoOperations;import org.springframework.data.redis.core.RedisTemplate;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import springmvc.bean.Order;import springmvc.orders.db.OrderRepository;@Controllerpublic class HomeController &#123; @Autowired RedisTemplate&lt;String, Object&gt; redisTemplate; @RequestMapping(value = &#123; "/", "index" &#125;, method = RequestMethod.GET) public String index() &#123; redisTemplate.opsForValue().set("gege", 11); System.out.print(redisTemplate.opsForValue().get("gege")); return "index"; &#125;&#125; 123456//åˆ›å»ºListæ¡ç›®ï¼Œkeyæ˜¯cartBoundListOperations&lt;String, Object&gt;cart=redisTemplate.boundListOps("cart");//åˆ é™¤æœ€åŽçš„ä¸€æ¡æ•°æ®cart.rightPop();//åœ¨æœ€åŽï¼Œæ·»åŠ ä¸€æ¡æ•°æ®cart.rightPush("æˆ‘ç¬‘äº†"); Keyå’ŒValueåºåˆ—åŒ–å¦‚æžœè¦ä½¿ç”¨åˆ°JavaBeanï¼Œéœ€è¦å…¶å®žçŽ°SerializableæŽ¥å£ï¼Œå°†å…¶åºåˆ—åŒ– æˆ–è€…ä½¿ç”¨Spring Data Redisæä¾›çš„åºåˆ—åŒ–å™¨ GenericToStringSerializerï¼šä½¿ç”¨Springè½¬æ¢æœåŠ¡è¿›è¡Œåºåˆ—åŒ– JacksonJsonRedisSerializerï¼šä½¿ç”¨Jackson1ï¼Œå°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSON Jackson2JsonRedisSerializerï¼šä½¿ç”¨Jackson2ï¼Œå°†å¯¹è±¡åºåˆ—åŒ–ä¸ºJSON JdkSerializationRedisSerializerï¼šä½¿ç”¨Javaåºåˆ—åŒ– OxmSerializerï¼šä½¿ç”¨Spring O/Xæ˜ å°„çš„ç¼–æŽ’å™¨å’Œè§£æŽ’å™¨å®žçŽ°åºåˆ—åŒ–ï¼Œç”¨äºŽXMLåºåˆ—åŒ– StringRedisSerializerï¼šåºåˆ—åŒ–Stringç±»åž‹çš„keyå’Œvalue 12redisTemplate.setKeySerializer(new StringRedisSerializer());redisTemplate.setValueSerializer(new Jackson2JsonRedisSerializer&lt;Order&gt;(Order.class)); ç¼“å­˜é…ç½®åœ¨é…ç½®æ–‡ä»¶ä¸­è¿½åŠ å¦‚ä¸‹ä»£ç  12345678910111213/** * ç¼“å­˜ç®¡ç†å™¨ * @param redisTemplate * @return */@Beanpublic CacheManager cacheManager(RedisTemplate&lt;String, Object&gt; redisTemplate) &#123; RedisCacheManager cacheManager =new RedisCacheManager(redisTemplate); //è®¾ç½®è¿‡æœŸæ—¶é—´ cacheManager.setDefaultExpiration(10); return cacheManager;&#125; ä½¿ç”¨æ³¨è§£è¿›è¡Œç¼“å­˜æ•°æ® æ³¨è§£ æè¿° @Cacheable è¡¨æ˜ŽSpringåœ¨è°ƒç”¨æ–¹æ³•ä¹‹å‰ï¼Œé¦–å…ˆåº”è¯¥åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾æ–¹æ³•çš„è¿”å›žå€¼ï¼Œå¦‚æžœè¿™ä¸ªå€¼èƒ½å¤Ÿæ‰¾åˆ°ï¼Œå°±ä¼šè¿”å›žç¼“å­˜çš„å€¼ã€‚å¦åˆ™ï¼Œè¿™ä¸ªæ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ï¼Œè¿”å›žå€¼ä¼šæ”¾åˆ°ç¼“å­˜ä¹‹ä¸­ @CachePut è¡¨åSpringåº”è¯¥å°†æ–¹æ³•çš„è¿”å›žå€¼æ”¾åˆ°ç¼“å­˜ä¸­ã€‚åœ¨æ–¹æ³•çš„è°ƒç”¨å‰å¹¶ä¸ä¼šæ£€æŸ¥ç¼“å­˜ï¼Œæ–¹æ³•å§‹ç»ˆéƒ½ä¼šè¢«è°ƒç”¨ @CacheEvict è¡¨æ˜ŽSpringåº”è¯¥åœ¨ç¼“å­˜ä¸­æ¸…é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ¡ç›® @Caching è¿™æ˜¯ä¸€ä¸ªåˆ†ç»„çš„æ³¨è§£ï¼Œèƒ½å¤ŸåŒæ—¶åº”ç”¨å¤šä¸ªå…¶ä»–çš„ç¼“å­˜æ³¨è§£ @Cacheableä¸Ž@CachePutçš„ä¸€äº›å…±æœ‰å±žæ€§ å±žæ€§ ç±»åž‹ æè¿° value String[] è¦ä½¿ç”¨çš„ç¼“å­˜åç§° condition String SpELè¡¨è¾¾å¼ï¼Œå¦‚æžœå¾—åˆ°çš„å€¼æ˜¯falseçš„è¯ï¼Œä¸ä¼šå°†ç¼“å­˜åº”ç”¨åˆ°æ–¹æ³•è°ƒç”¨ä¸Š key String SpELè¡¨è¾¾å¼ï¼Œç”¨æ¥è®¡ç®—è‡ªå®šä¹‰çš„ç¼“å­˜key unless String SpELè¡¨è¾¾å¼ï¼Œå¦‚æžœå¾—åˆ°çš„å€¼æ˜¯trueçš„è¯ï¼Œè¿”å›žå€¼ä¸ä¼šæ”¾åˆ°ç¼“å­˜ä¹‹ä¸­ 12345678910111213package springmvc.orders.db;import java.util.List;import org.springframework.cache.annotation.Cacheable;import springmvc.bean.Order;public interface OrderOperations &#123; @Cacheable("spittle") List&lt;Order&gt; findOrdersByType(String t);&#125; ç¼“å­˜åˆ‡é¢ä¼šæ‹¦æˆªè°ƒç”¨å¹¶åœ¨ç¼“å­˜ä¸­æŸ¥æ‰¾ä¹‹å‰ä»¥åspittleå­˜å‚¨çš„è¿”å›žå€¼ã€‚ç¼“å­˜çš„keyæ˜¯ä¼ é€’åˆ°findOrdersByType()æ–¹æ³•ä¸­çš„tå‚æ•°ã€‚å¦‚æžœæŒ‰ç…§è¿™ä¸ªkeyèƒ½å¤Ÿæ‰¾åˆ°å€¼çš„è¯ï¼Œå°±ä¼šè¿”å›žæ‰¾åˆ°çš„å€¼ï¼Œæ–¹æ³•å°±ä¸ä¼šè¢«è°ƒç”¨ã€‚å¦‚æžœæ²¡æœ‰æ‰¾åˆ°å€¼çš„è¯ï¼Œé‚£ä¹ˆå°±ä¼šè°ƒç”¨è¿™ä¸ªæ–¹æ³• å½“åœ¨æŽ¥å£æ–¹æ³•æ·»åŠ æ³¨è§£åŽï¼Œè¢«æ³¨è§£çš„æ–¹æ³•ï¼Œåœ¨æ‰€æœ‰çš„å®žçŽ°ç»§æ‰¿ä¸­éƒ½ä¼šæœ‰ç›¸åŒçš„ç¼“å­˜è§„åˆ™ @CacheEvict 12@CacheEvict("spittle")void remove(String Id); @CacheEvictèƒ½å¤Ÿåº”ç”¨åœ¨è¿”å›žå€¼ä¸ºvoidçš„æ–¹æ³•ä¸Šï¼Œ è€Œ@Cacheableå’Œ@CachePutéœ€è¦éžvoidçš„è¿”å›žå€¼ï¼Œä»–å°†ä¼šä½œä¸ºæ”¾åœ¨ç¼“å­˜ä¸­çš„æ¡ç›® å±žæ€§ ç±»åž‹ æè¿° value String[] è¦ä½¿ç”¨çš„ç¼“å­˜åç§° key String SpELè¡¨è¾¾å¼ï¼Œç”¨æ¥è®¡ç®—è‡ªå®šä¹‰çš„ç¼“å­˜key condition String SpELè¡¨è¾¾å¼ï¼Œå¦‚æžœå¾—åˆ°çš„å€¼æ˜¯falseçš„è¯ï¼Œç¼“å­˜ä¸ä¼šåº”ç”¨åˆ°æ–¹æ³•è°ƒç”¨ä¸Š allEntries boolean å¦‚æžœä¸ºtrueçš„è¯ï¼Œç‰¹å®šç¼“å­˜çš„æ‰€æœ‰æ¡ç›®éƒ½ä¼šè¢«ç§»é™¤ beforeInvocation boolean å¦‚æžœä¸ºtrueçš„è¯ï¼Œåœ¨æ–¹æ³•è°ƒç”¨ä¹‹å‰ç§»é™¤æ¡ç›®ï¼Œå¦‚æžœä¸ºfalseçš„è¯ï¼Œåœ¨æ–¹æ³•æˆåŠŸè°ƒç”¨ä¹‹åŽåœ¨ç§»é™¤æ¡ç›®]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MongoDBçš„Springé…ç½®ä½¿ç”¨]]></title>
    <url>%2F2016%2F07%2F05%2Fmongo20160705%2F</url>
    <content type="text"><![CDATA[Spring-dataå¯¹MongoDBè¿›è¡Œäº†å¾ˆå¥½çš„æ”¯æŒï¼ŒæŽ¥ä¸‹æ¥å°±è®²è§£ä¸€ä¸‹å…³äºŽSpringå¯¹MongoDBçš„é…ç½®å’Œä¸€äº›æ­£å¸¸çš„ä½¿ç”¨ æˆ‘ä¸‹é¢çš„å·¥ç¨‹ä½¿ç”¨çš„æ˜¯Springçš„Javaé…ç½®çš„æ–¹å¼å’ŒMavenæž„å»º å…·ä½“çš„å·¥ç¨‹ä»£ç å¤§å®¶å¯ä»¥è®¿é—®æˆ‘çš„Githubåœ°å€:https://github.com/zoeminghong/springmvc-javaconfig â‘ MongoDBçš„å¿…è¦é…ç½®123456789101112131415161718192021222324252627282930313233package springmvc.rootconfig;import org.springframework.context.annotation.Bean;import org.springframework.context.annotation.Configuration;import org.springframework.data.mongodb.core.MongoClientFactoryBean;import org.springframework.data.mongodb.core.MongoOperations;import org.springframework.data.mongodb.core.MongoTemplate;import org.springframework.data.mongodb.repository.config.EnableMongoRepositories;import com.mongodb.Mongo;@Configuration// å¯ç”¨MongoDBçš„RepositoryåŠŸèƒ½ï¼Œä¼šå¯¹å…¶Repositoriesè‡ªåŠ¨æ‰«æ@EnableMongoRepositories(basePackages = "springmvc.orders.db") public class MongoConfig &#123; // MongoClienté…ç½® @Bean public MongoClientFactoryBean mongo() &#123; MongoClientFactoryBean mongo = new MongoClientFactoryBean(); mongo.setHost("localhost"); //MongoCredential credential=MongoCredential.createCredential(env.getProperty("mongo.username"), "OrdersDB",env.getProperty("mongo.password").toCharArray());// mongo.setCredentials(new MongoCredential[]&#123;credential&#125;); //è¿˜å¯ä»¥å¯¹ç«¯å£è¿›è¡Œé…ç½® return mongo; &#125; // Mongo Templateé…ç½® @Bean public MongoOperations mongoTemplate(Mongo mongo) &#123; //OrdersDBå°±æ˜¯Mongoçš„æ•°æ®åº“ return new MongoTemplate(mongo, "OrdersDB"); &#125;&#125; ä¸ºäº†è®¿é—®æ•°æ®åº“çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦å¸å·å¯†ç  12MongoCredential credential=MongoCredential.createCredential(env.getProperty("mongo.username"), "OrdersDB",env.getProperty("mongo.password").toCharArray());mongo.setCredentials(new MongoCredential[]&#123;credential&#125;); â‘¡ä¸ºæ¨¡åž‹æ·»åŠ æ³¨è§£123456789101112131415161718192021222324252627282930313233343536373839404142434445package springmvc.bean;import java.util.Collection;import java.util.LinkedHashSet;import org.springframework.data.annotation.Id;import org.springframework.data.mongodb.core.mapping.Document;import org.springframework.data.mongodb.core.mapping.Field;//è¿™æ˜¯æ–‡æ¡£@Documentpublic class Order &#123; //æŒ‡å®šID @Id private String id; //ä¸ºåŸŸé‡å‘½å @Field("client") private String customer; private String type; private Collection&lt;Item&gt; items=new LinkedHashSet&lt;Item&gt;(); public String getId() &#123; return id; &#125; public void setId(String id) &#123; this.id = id; &#125; public String getCustomer() &#123; return customer; &#125; public void setCustomer(String customer) &#123; this.customer = customer; &#125; public String getType() &#123; return type; &#125; public void setType(String type) &#123; this.type = type; &#125; public Collection&lt;Item&gt; getItems() &#123; return items; &#125; public void setItems(Collection&lt;Item&gt; items) &#123; this.items = items; &#125; &#125; 1234567891011121314151617181920212223242526272829303132333435363738394041package springmvc.bean;public class Item &#123; private Long id; private Order order; private String product; private double price; private int quantity; public Long getId() &#123; return id; &#125; public void setId(Long id) &#123; this.id = id; &#125; public Order getOrder() &#123; return order; &#125; public void setOrder(Order order) &#123; this.order = order; &#125; public String getProduct() &#123; return product; &#125; public void setProduct(String product) &#123; this.product = product; &#125; public double getPrice() &#123; return price; &#125; public void setPrice(double price) &#123; this.price = price; &#125; public int getQuantity() &#123; return quantity; &#125; public void setQuantity(int quantity) &#123; this.quantity = quantity; &#125; &#125; æ³¨è§£ æè¿° @Document æ ‡ç¤ºæ˜ å°„åˆ°mongoDBæ–‡æ¡£ä¸Šçš„é¢†åŸŸå¯¹è±¡ @ID æ ‡ç¤ºæŸä¸ªä¸ºIDåŸŸ @DbRef æ ‡ç¤ºæŸä¸ªåŸŸè¦å¼•ç”¨å…¶ä»–çš„æ–‡æ¡£ï¼Œè¿™ä¸ªæ–‡æ¡£æœ‰å¯èƒ½ä½äºŽå¦å¤–ä¸€ä¸ªæ•°æ®åº“ä¸­ @Field ä¸ºæ–‡æ¡£åŸŸæŒ‡å®šè‡ªå®šä¹‰çš„å…ƒæ•°æ® @Version æ ‡ç¤ºæŸä¸ªå±žæ€§ç”¨ä½œç‰ˆæœ¬åŸŸ è‹¥ä¸ä½¿ç”¨@Fieldæ³¨è§£ï¼ŒåŸŸåå°±ä¸ŽJavaå±žæ€§ç›¸åŒ ä¸Šé¢ä¹‹æ‰€ä»¥Itemçš„Javaç±»ä¸ºä»€ä¹ˆæ²¡æœ‰@Documentæ³¨è§£ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬ä¸ä¼šå•ç‹¬æƒ³ItemæŒä¹…åŒ–ä¸ºæ–‡æ¡£ â‘¢ä½¿ç”¨MongoTemplateè®¿é—®MongoDB12345678910111213141516171819202122232425262728293031323334package springmvc.web;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.mongodb.core.MongoOperations;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import springmvc.bean.Order;import springmvc.orders.db.OrderRepository;@Controllerpublic class HomeController &#123; @Autowired MongoOperations mongo; @RequestMapping(value = &#123; "/", "index" &#125;, method = RequestMethod.GET) public String index() &#123; long orderCount=mongo.getCollection("order").count(); System.out.println(orderCount);// Order order = new Order();// order.setId("1");// order.setCustomer("gg");// order.setType("2"); //ç¬¬äºŒä¸ªå‚æ•°æ˜¯æ–‡æ¡£å­˜å‚¨çš„åç§°// mongo.save(order,"order");// String orderId="1";// Order order=mongo.findById(orderId, Order.class);// System.out.println(order.getCustomer()); return "index"; &#125;&#125; åœ¨è¿™é‡Œæˆ‘ä»¬å°†MongoTemplateæ³¨å…¥åˆ°ä¸€ä¸ªç±»åž‹ä¸ºMongoOperationsçš„å±žæ€§ä¸­ã€‚MongoOperationsæ˜¯MongoTemplateæ‰€å®žçŽ°çš„æŽ¥å£ï¼ŒMongoOperationsä¸­å­˜åœ¨å¾ˆå¤šæ–‡æ¡£æ“ä½œæ–¹æ³• MongoOperationså…¶å®žå·²ç»èƒ½æ»¡è¶³å¾ˆå¤šéœ€æ±‚äº† å¦‚æžœè¿˜æ²¡æœ‰æ»¡è¶³ä½ çš„éœ€æ±‚ï¼ŒæŽ¥ä¸‹æ¥æˆ‘å°±ä»‹ç»ä¸€ä¸‹ï¼Œå¦‚ä½•ç¼–å†™MongoDB Repository ç¼–å†™MongoDB Repository1234567891011121314151617package springmvc.orders.db;import java.util.List;import org.springframework.data.mongodb.repository.MongoRepository;import springmvc.bean.Order;public interface OrderRepository extends MongoRepository&lt;Order, String&gt; &#123; List&lt;Order&gt; findByCustomer(String c); List&lt;Order&gt; findByCustomerLike(String c); List&lt;Order&gt; findByCustomerAndType(String c, String t); List&lt;Order&gt; findByCustomerLikeAndType(String c, String t);&#125; çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰æ²¡æœ‰å‘çŽ°packageçš„åœ°å€å°±æ˜¯æˆ‘ä»¬åˆšæ‰@EnableMongoRepositories(basePackages = â€œspringmvc.orders.dbâ€)çš„é…ç½® MongoRepositoryæŽ¥å£æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œç¬¬ä¸€ä¸ªæ˜¯å¸¦æœ‰@Documentæ³¨è§£çš„å¯¹è±¡ç±»åž‹ï¼Œä¹Ÿå°±æ˜¯è¯¥Repositoryè¦å¤„ç†çš„ç±»åž‹ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¸¦æœ‰@Idæ³¨è§£çš„å±žæ€§ç±»åž‹ OrderRepositoryç»§æ‰¿äº†MongoRepositoryä¸­å¾ˆå¤šè‡ªå¸¦çš„æ–¹æ³• æ–¹æ³• æè¿° long count() è¿”å›žæŒ‡å®šRepositoryç±»åž‹çš„æ–‡æ¡£æ•°é‡ void delete(Iterable&lt;? extends T&gt;) åˆ é™¤ä¸ŽæŒ‡å®šå¯¹è±¡å…³è”çš„æ‰€æœ‰æ–‡æ¡£ void delete(T) åˆ é™¤ä¸ŽæŒ‡å®šå¯¹è±¡å…³è”çš„æ–‡æ¡£ void delete(ID) æ ¹æ®IDåˆ é™¤æŸä¸€ä¸ªæ–‡æ¡£ void deleteAll(); åˆ é™¤æŒ‡å®šRepositoryç±»åž‹çš„æ‰€æœ‰æ–‡æ¡£ boolean exists(Object) å¦‚æžœå­˜åœ¨ä¸ŽæŒ‡å®šå¯¹è±¡ç›¸å…³è”çš„æ–‡æ¡£ï¼Œåˆ™è¿”å›žtrue boolean exists(ID) å¦‚æžœå­˜åœ¨ä¸ŽæŒ‡å®šå¯¹è±¡ç›¸å…³è”çš„æ–‡æ¡£ï¼Œåˆ™è¿”å›žtrue ListfindAll() è¿”å›žæŒ‡å®šRepositoryç±»åž‹çš„æ‰€æœ‰æ–‡æ¡£ ListfindAll(Iterable) è¿”å›žæŒ‡å®šæ–‡æ¡£IDå¯¹åº”çš„æ‰€æœ‰æ–‡æ¡£ ListfindAll(Pageable) ä¸ºæŒ‡å®šRepositoryç±»åž‹ï¼Œè¿”å›žåˆ†é¡µä¸”æŽ’åºçš„æ–‡æ¡£åˆ—è¡¨ ListfindAll(Sort) ä¸ºæŒ‡å®šRepositoryç±»åž‹ï¼Œè¿”å›žæŽ’åºåŽçš„æ‰€æœ‰æ–‡æ¡£åˆ—è¡¨ T findOne(ID) ä¸ºæŒ‡å®šçš„IDè¿”å›žå•ä¸ªæ–‡æ¡£ Save(terable) ä¿å­˜æŒ‡å®šIterableä¸­çš„æ‰€æœ‰æ–‡æ¡£ save() ä¸ºç»™å®šçš„å¯¹è±¡ä¿å­˜ä¸€æ¡æ–‡æ¡£ ä¸Šé¢çš„æˆ‘ä»¬å®šä¹‰çš„å››ä¸ªæ–¹æ³•éƒ½æ˜¯æˆ‘ä»¬è‡ªå®šä¹‰çš„æ–¹æ³•ï¼Œå…¶æ–¹æ³•åå­˜åœ¨å¾ˆå¤šæ„ä¹‰ï¼Œä¸èƒ½éšä¾¿å®šä¹‰ 1List&lt;Order&gt; findByCustomer(String c); findä¸ºæŸ¥è¯¢åŠ¨è¯ï¼Œè¿˜å¯ä»¥æ˜¯readã€getã€countç­‰ Customerä¸ºæ–­è¨€ï¼Œåˆ¤æ–­å…¶è¡Œä¸º åœ¨æ–­è¨€ä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªæˆ–å¤šä¸ªé™åˆ¶ç»“æžœçš„æ¡ä»¶ã€‚æ¯ä¸ªæ¡ä»¶å¿…é¡»å¼•ç”¨ä¸€ä¸ªå±žæ€§ï¼Œå¹¶ä¸”è¿˜å¯ä»¥æŒ‡å®šä¸€ç§æ¯”è¾ƒæ“ä½œã€‚å¦‚æžœçœç•¥æ¯”è¾ƒæ“ä½œç¬¦çš„è¯ï¼Œé‚£ä¹ˆè¿™æš—æŒ‡æ˜¯ä¸€ç§ç›¸ç­‰æ¯”è¾ƒæ“ä½œã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©å…¶ä»–çš„æ¯”è¾ƒæ“ä½œ ç±»åž‹ IsAfterã€Afterã€IsGreaterThanã€GreaterThan IsGreaterThanEqualã€GreaterThanEqual IsBeforeã€Beforeã€IsLessThanã€LessThan IsLessThanEqualã€LessThanEqual IsBetweenã€Between IsNullã€Null IsNotNullã€NotNull IsInã€In IsNotInã€NotIn IsStartingWithã€StartingWithã€StartsWith IsEndingWithã€EndingWithã€EndsWith IsContainingã€Containingã€Contains IsLikeã€Like IsNotLikeã€NotLike IsTureã€True IsFalseã€False Isã€Equals IsNotã€Not other ç±»åž‹ IgnoringCaseã€IgnoresCaseã€OrderByã€Andã€Or æŒ‡å®šæŸ¥è¯¢12@Query("&#123;'customer':'Chuck Wagon','type':?0&#125;")List&lt;Order&gt; findChucksOrders(String t); @Queryä¸­ç»™å®šçš„JSONå°†ä¼šä¸Žæ‰€æœ‰çš„Orderæ–‡æ¡£è¿›è¡ŒåŒ¹é…ï¼Œå¹¶è¿”å›žåŒ¹é…çš„æ–‡æ¡£ï¼Œè¿™é‡Œçš„typeå±žæ€§æ˜ å°„æˆâ€œï¼Ÿ0â€ï¼Œè¿™è¡¨æ˜Žtypeå±žæ€§åº”è¯¥ä¸ŽæŸ¥è¯¢æ–¹æ³•çš„ç¬¬0ä¸ªå‚æ•°ç›¸ç­‰ï¼Œå¦‚æžœæœ‰å¤šä¸ªå‚æ•°ï¼Œåˆ™â€?1â€â€¦.. æ··åˆè‡ªå®šä¹‰çš„åŠŸèƒ½12345678910package springmvc.orders.db;import java.util.List;import springmvc.bean.Order;public interface OrderOperations &#123; List&lt;Order&gt; findOrdersByType(String t);&#125; 1234567891011121314151617181920212223package springmvc.orders.db;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.mongodb.core.MongoOperations;import org.springframework.data.mongodb.core.query.Criteria;import org.springframework.data.mongodb.core.query.Query;import springmvc.bean.Order;public class OrderRepositoryImpl implements OrderOperations &#123; @Autowired private MongoOperations mongo; //å°†æ··åˆå®žçŽ°æ³¨å…¥MongoOperations @Override public List&lt;Order&gt; findOrdersByType(String t) &#123; String type =t.equals("Net")?"2":t; Criteria where=Criteria.where("type").is(type); Query query=Query.query(where); return mongo.find(query, Order.class); &#125;&#125; 12345678910111213141516171819202122package springmvc.orders.db;import java.util.List;import org.springframework.data.mongodb.repository.MongoRepository;import org.springframework.data.mongodb.repository.Query;import springmvc.bean.Order;//ç»§æ‰¿OrderOperationsæŽ¥å£public interface OrderRepository extends MongoRepository&lt;Order, String&gt;,OrderOperations &#123; List&lt;Order&gt; findByCustomer(String c); List&lt;Order&gt; findByCustomerLike(String c); List&lt;Order&gt; findByCustomerAndType(String c, String t); List&lt;Order&gt; findByCustomerLikeAndType(String c, String t); @Query("&#123;'customer':'Chuck Wagon','type':?0&#125;") List&lt;Order&gt; findChucksOrders(String t); &#125; 123456789101112131415161718192021222324252627package springmvc.web;import java.util.List;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.data.mongodb.core.MongoOperations;import org.springframework.stereotype.Controller;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestMethod;import springmvc.bean.Order;import springmvc.orders.db.OrderRepository;@Controllerpublic class HomeController &#123; @Autowired MongoOperations mongo; @Autowired OrderRepository orderRepository; @RequestMapping(value = &#123; "/", "index" &#125;, method = RequestMethod.GET) public String index() &#123; List&lt;Order&gt; list=orderRepository.findOrdersByType("2"); System.out.println(list.size()); return "index"; &#125;&#125; ä»¥ä¸Šè¿™äº›å…³è”èµ·æ¥çš„å…³é”®ç‚¹æ˜¯OrderRepositoryImplï¼Œè¿™ä¸ªåå­—å‰åŠéƒ¨åˆ†ä¸ŽOrderRepositoryç›¸åŒï¼Œåªæ˜¯æ·»åŠ äº†ä¸€ä¸ªâ€œImplâ€åŽç¼€ã€‚å¦‚æžœæƒ³æ›´æ”¹è¯¥åŽç¼€ï¼Œå¯ä»¥åœ¨MongoConfigç±»ä¸­æ›´æ”¹ä¸ºè‡ªå·±ç†æƒ³çš„åŽç¼€ 1@EnableMongoRepositories(basePackages = "springmvc.orders.db",repositoryImplementationPostfix="Stuff")]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[NIOå…¨è§£æžè¯´æ˜Ž]]></title>
    <url>%2F2016%2F06%2F12%2Fnio20160612%2F</url>
    <content type="text"><![CDATA[Java NIOæ˜¯ä¸€ä¸ªç”¨æ¥æ›¿ä»£æ ‡å‡†Java IO APIçš„æ–°åž‹æ•°æ®ä¼ é€’æ–¹å¼ï¼ŒåƒçŽ°åœ¨åˆ†å¸ƒå¼æž¶æž„ä¸­ä¼šç»å¸¸å­˜åœ¨ä»–çš„èº«å½±ã€‚å…¶æ¯”ä¼ ç»Ÿçš„IOæ›´åŠ é«˜æ•ˆï¼Œéžé˜»å¡žï¼Œå¼‚æ­¥ï¼ŒåŒå‘ NIOä¸»ä½“ç»“æž„ Java NIOçš„ä¸»è¦æž„æˆæ ¸å¿ƒå°±æ˜¯Bufferã€Channelå’ŒSelectorè¿™ä¸‰ä¸ª å¯¹äºŽChannelæˆ‘æƒ³è¦æé†’çš„æ˜¯ï¼ŒChannelä¸­çš„æ•°æ®æ€»æ˜¯è¦å…ˆè¯»åˆ°ä¸€ä¸ªBufferï¼Œæˆ–è€…æ€»æ˜¯è¦ä»Žä¸€ä¸ªBufferä¸­å†™å…¥ ä½¿ç”¨Selectorï¼Œå¾—å‘Selectoræ³¨å†ŒChannelï¼Œç„¶åŽè°ƒç”¨å®ƒçš„select()æ–¹æ³•ã€‚è¿™ä¸ªæ–¹æ³•ä¼šä¸€ç›´é˜»å¡žåˆ°æŸä¸ªæ³¨å†Œçš„é€šé“æœ‰äº‹ä»¶å°±ç»ªã€‚ä¸€æ—¦è¿™ä¸ªæ–¹æ³•è¿”å›žï¼Œçº¿ç¨‹å°±å¯ä»¥å¤„ç†è¿™äº›äº‹ä»¶ Channelæ‰€æœ‰çš„ IO åœ¨NIO ä¸­éƒ½ä»Žä¸€ä¸ªChannel å¼€å§‹ã€‚Channel æœ‰ç‚¹è±¡æµ Channelçš„å®žçŽ° FileChannel:ä»Žæ–‡ä»¶ä¸­è¯»å†™æ•°æ® DatagramChannel:é€šè¿‡UDPè¯»å†™ç½‘ç»œä¸­çš„æ•°æ® SocketChannel:é€šè¿‡TCPè¯»å†™ç½‘ç»œä¸­çš„æ•°æ® ServerSocketChannel:ç›‘å¬æ–°è¿›æ¥çš„TCPè¿žæŽ¥ï¼ŒåƒWebæœåŠ¡å™¨é‚£æ ·ã€‚å¯¹æ¯ä¸€ä¸ªæ–°è¿›æ¥çš„è¿žæŽ¥éƒ½ä¼šåˆ›å»ºä¸€ä¸ªSocketChannel Scatter/Gather åˆ†æ•£ï¼ˆscatterï¼‰ä»ŽChannelä¸­è¯»å–æ˜¯æŒ‡åœ¨è¯»æ“ä½œæ—¶å°†è¯»å–çš„æ•°æ®å†™å…¥å¤šä¸ªbufferä¸­ã€‚å› æ­¤ï¼ŒChannelå°†ä»ŽChannelä¸­è¯»å–çš„æ•°æ®â€œåˆ†æ•£ï¼ˆscatterï¼‰â€åˆ°å¤šä¸ªBufferä¸­ èšé›†ï¼ˆgatherï¼‰å†™å…¥Channelæ˜¯æŒ‡åœ¨å†™æ“ä½œæ—¶å°†å¤šä¸ªbufferçš„æ•°æ®å†™å…¥åŒä¸€ä¸ªChannelï¼Œå› æ­¤ï¼ŒChannel å°†å¤šä¸ªBufferä¸­çš„æ•°æ®â€œèšé›†ï¼ˆgatherï¼‰â€åŽå‘é€åˆ°Channel é€šè¿‡è¿™æ ·çš„æ–¹å¼å¯ä»¥æ–¹ä¾¿æ•°æ®çš„è¯»å–ï¼Œå½“ä½ æƒ³è¦èŽ·å–æ•´ä¸ªæ•°æ®çš„ä¸€éƒ¨åˆ†çš„æ—¶å€™ï¼Œé€šè¿‡è¿™ç§æ–¹å¼å¯ä»¥å¾ˆå¿«çš„èŽ·å–æ•°æ® 1234ByteBuffer header = ByteBuffer.allocate(128);ByteBuffer body = ByteBuffer.allocate(1024);ByteBuffer[] bufferArray = &#123; header, body &#125;;channel.read(bufferArray); read()æ–¹æ³•æŒ‰ç…§bufferåœ¨æ•°ç»„ä¸­çš„é¡ºåºå°†ä»Žchannelä¸­è¯»å–çš„æ•°æ®å†™å…¥åˆ°bufferï¼Œå½“ä¸€ä¸ªbufferè¢«å†™æ»¡åŽï¼Œchannelç´§æŽ¥ç€å‘å¦ä¸€ä¸ªbufferä¸­å†™ transferFromã€transferToå®žçŽ°ä¸¤ä¸ªChannelä¹‹é—´ç›¸äº’è¿žæŽ¥ï¼Œæ•°æ®ä¼ é€’ 12345678910111213141516171819202122232425262728293031public static void trainforNio() &#123; RandomAccessFile fromFile=null; RandomAccessFile toFile=null; try &#123; fromFile = new RandomAccessFile("src/nio.txt", "rw"); // channelèŽ·å–æ•°æ® FileChannel fromChannel = fromFile.getChannel(); toFile = new RandomAccessFile("src/toFile.txt", "rw"); FileChannel toChannel = toFile.getChannel(); System.out.println(toChannel.size()); //positionå¤„å¼€å§‹å‘ç›®æ ‡æ–‡ä»¶å†™å…¥æ•°æ®,è¿™é‡Œæ˜¯toChannel long position = toChannel.size(); long count = fromChannel.size(); toChannel.transferFrom(fromChannel, position, count); System.out.println(toChannel.size()); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; try &#123; if (fromFile != null) &#123; fromFile.close(); &#125; if (toFile != null) &#123; toFile.close(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; transferFromã€transferToä½œç”¨æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ä¸€ä¸ªæ˜¯tochannalè°ƒç”¨ï¼Œä¸€ä¸ªæ˜¯fromchannnalè°ƒç”¨ åœ¨å®žé™…çš„è¿ç”¨ä¸­å¯èƒ½å­˜åœ¨æºé€šé“çš„å‰©ä½™ç©ºé—´å°äºŽ count ä¸ªå­—èŠ‚ï¼Œåˆ™æ‰€ä¼ è¾“çš„å­—èŠ‚æ•°è¦å°äºŽè¯·æ±‚çš„å­—èŠ‚æ•° åœ¨SoketChannelçš„å®žçŽ°ä¸­ï¼ŒSocketChannelåªä¼šä¼ è¾“æ­¤åˆ»å‡†å¤‡å¥½çš„æ•°æ®ï¼ˆå¯èƒ½ä¸è¶³countå­—èŠ‚ï¼‰ã€‚å› æ­¤ï¼ŒSocketChannelå¯èƒ½ä¸ä¼šå°†è¯·æ±‚çš„æ‰€æœ‰æ•°æ®(countä¸ªå­—èŠ‚)å…¨éƒ¨ä¼ è¾“åˆ°FileChannelä¸­ çœ‹å®˜ä¸€å®šè¦ä»”ç»†çœ‹æˆ‘æ —å­ä¸­çš„æ³¨é‡Š BufferBufferæ˜¯ä¸€ä¸ªç¼“å­˜åŒºï¼Œå…¶ä¼šå°†Channelä¸­çš„æ•°æ®å­˜å‚¨èµ·æ¥ Bufferçš„å®žçŽ° ByteBuffer CharBuffer DoubleBuffer FloatBuffer IntBuffer LongBuffer ShortBuffer MappedByteBuffer capacity,position,limitåœ¨è®²è§£è¯¥ä¸»é¢˜ä¹‹å‰ï¼Œé¦–å…ˆè¦æ˜Žç™½è¯»æ¨¡å¼å’Œå†™æ¨¡å¼ï¼Œæ— è®ºæ˜¯Channelè¿˜æ˜¯Bufferéƒ½å­˜åœ¨è¿™ä¸¤ç§æ¨¡å¼ï¼Œè¦ç†è§£è¿™ä¸¤ç§æ¨¡å¼ï¼Œç¬¬ä¸€æ­¥è¦æ˜Žç¡®ä¸»é¢˜æ˜¯å“ªä¸€ä¸ªï¼Œæ˜¯Channelè¿˜æ˜¯Bufferã€‚ä¸¾ä¸ªæ —å­ï¼Œä¸»è§’æ˜¯Channelï¼Œè¯»æ¨¡å¼çš„å«ä¹‰å°±æ˜¯ä»ŽBufferä¸­èŽ·å–æ•°æ®ï¼Œå†™æ¨¡å¼å°±æ˜¯å°†æ•°æ®å†™å…¥Bufferï¼Œå¯¹äºŽBufferåˆ™æ˜¯ç›¸åã€‚æžæ¸…æ¥šè¿™ä¸€ç‚¹ï¼Œç†è§£ä¸‹é¢çš„å°±è¦ç›¸å¯¹æ¸…æ¥šä¸€ç‚¹ capacity:ä½œä¸ºä¸€ä¸ªå†…å­˜å—ï¼Œå…¶å°±ä»£è¡¨äº†å½“å‰Bufferèƒ½æœ€å¤šæš‚å­˜å¤šå°‘æ•°æ®é‡ï¼Œå­˜å‚¨çš„æ•°æ®ç±»åž‹åˆ™æ˜¯æ ¹æ®ä¸Šé¢çš„Bufferå¯¹è±¡ç±»åž‹ï¼Œä¸€æ—¦Bufferæ»¡äº†ï¼Œéœ€è¦å°†å…¶æ¸…ç©ºï¼ˆé€šè¿‡è¯»æ•°æ®æˆ–è€…æ¸…é™¤æ•°æ®ï¼‰æ‰èƒ½ç»§ç»­å†™æ•°æ®å¾€é‡Œå†™æ•°æ® position:ä»£è¡¨å½“å‰æ•°æ®è¯»æˆ–å†™å¤„äºŽé‚£ä¸ªä½ç½®ã€‚è¯»æ¨¡å¼ï¼šè¢«é‡ç½®ä»Ž0å¼€å§‹ï¼Œæœ€å¤§å€¼å¯èƒ½ä¸ºcapacity-1æˆ–è€…limit-1ï¼Œå†™æ¨¡å¼ï¼šè¢«é‡ç½®ä»Ž0å¼€å§‹ï¼Œæœ€å¤§å€¼ä¸ºlimit-1 limit:æœ€å¤šèƒ½å¾€Bufferé‡Œå†™å¤šå°‘æ•°æ®ï¼Œlimitå¤§å°è·Ÿæ•°æ®é‡å¤§å°å’Œcapacityæœ‰å…³ï¼Œè¯»æ¨¡å¼ï¼šæ•°æ®é‡&gt;capacityæ—¶ï¼Œlimit=capacityï¼Œæ•°æ®é‡=capacityæ—¶ï¼Œlimit=capacityï¼Œæ•°æ®é‡&lt;capacityæ—¶ï¼Œlimit&lt;capacityï¼Œå†™æ¨¡å¼ï¼šlimit&lt;=capacity 12345678910111213141516171819202122232425262728293031323334353637383940414243444546import java.io.IOException;import java.io.RandomAccessFile;import java.nio.ByteBuffer;import java.nio.channels.FileChannel;public class Method &#123; public static void nio() &#123; RandomAccessFile aFile = null; try &#123; aFile = new RandomAccessFile("src/nio.txt", "rw"); // channelèŽ·å–æ•°æ® FileChannel fileChannel = aFile.getChannel(); // åˆå§‹åŒ–Bufferï¼Œè®¾å®šBufferæ¯æ¬¡å¯ä»¥å­˜å‚¨æ•°æ®é‡ // åˆ›å»ºçš„Bufferæ˜¯1024byteçš„ï¼Œå¦‚æžœå®žé™…æ•°æ®æœ¬èº«å°±å°äºŽ1024ï¼Œé‚£ä¹ˆlimitå°±æ˜¯å®žé™…æ•°æ®å¤§å° ByteBuffer buf = ByteBuffer.allocate(1024); // channelä¸­çš„æ•°æ®å†™å…¥Buffer int bytesRead = fileChannel.read(buf); System.out.println(bytesRead); while (bytesRead != -1) &#123; // Bufferåˆ‡æ¢ä¸ºè¯»å–æ¨¡å¼ buf.flip(); // è¯»å–æ•°æ® while (buf.hasRemaining()) &#123; System.out.print((char) buf.get()); &#125; // æ¸…ç©ºBufferåŒº buf.compact(); // ç»§ç»­å°†æ•°æ®å†™å…¥ç¼“å­˜åŒº bytesRead = fileChannel.read(buf); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; finally &#123; try &#123; if (aFile != null) &#123; aFile.close(); &#125; &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125; &#125; public static void main(String[] args) &#123; Method.nio(); Bufferè¯»å†™æ•°æ®æ­¥éª¤ å†™å…¥æ•°æ®åˆ°Buffer(fileChannel.read(buf)) è°ƒç”¨flip()æ–¹æ³•(buf.flip()) ä»ŽBufferä¸­è¯»å–æ•°æ®(buf.get()) è°ƒç”¨clear()æ–¹æ³•æˆ–è€…compact()æ–¹æ³•(buf.compact()) Bufferæ–¹æ³• flip():å°†Bufferè¯»æ¨¡å¼åˆ‡æ¢åˆ°å†™æ¨¡å¼ï¼Œå¹¶ä¸”å°†positionåˆ¶ä¸º0 clear():æ¸…ç©ºæ•´ä¸ªç¼“å†²åŒº compact():åªä¼šæ¸…é™¤å·²ç»è¯»è¿‡çš„æ•°æ®ã€‚ä»»ä½•æœªè¯»çš„æ•°æ®éƒ½è¢«ç§»åˆ°ç¼“å†²åŒºçš„èµ·å§‹å¤„ï¼Œæ–°å†™å…¥çš„æ•°æ®å°†æ”¾åˆ°ç¼“å†²åŒºæœªè¯»æ•°æ®çš„åŽé¢ allocate(1024):åˆå§‹åŒ–Bufferï¼Œè®¾å®šçš„å€¼å°±å†³å®šcapacityå€¼çš„å¤§å° rewind():å°†positionè®¾å›ž0ï¼Œæ‰€ä»¥ä½ å¯ä»¥é‡è¯»Bufferä¸­çš„æ‰€æœ‰æ•°æ®ã€‚limitä¿æŒä¸å˜ï¼Œä»ç„¶è¡¨ç¤ºèƒ½ä»ŽBufferä¸­è¯»å–å¤šå°‘ä¸ªå…ƒç´ ï¼ˆbyteã€charç­‰ï¼‰ mark()ä¸Žreset():é€šè¿‡è°ƒç”¨Buffer.mark()æ–¹æ³•ï¼Œå¯ä»¥æ ‡è®°Bufferä¸­çš„ä¸€ä¸ªç‰¹å®špositionã€‚ä¹‹åŽå¯ä»¥é€šè¿‡è°ƒç”¨Buffer.reset()æ–¹æ³•æ¢å¤åˆ°è¿™ä¸ªposition equals():å½“æ»¡è¶³ä¸‹é¢ä¸‰ä¸ªæ¡ä»¶æ—¶ï¼Œä¸¤ä¸ªBufferæ‰æ˜¯ç›¸ç­‰ æœ‰ç›¸åŒçš„ç±»åž‹ï¼ˆbyteã€charã€intç­‰ï¼‰ Bufferä¸­å‰©ä½™çš„byteã€charç­‰çš„ä¸ªæ•°ç›¸ç­‰ Bufferä¸­æ‰€æœ‰å‰©ä½™çš„byteã€charç­‰éƒ½ç›¸åŒ åªæ¯”è¾ƒçš„æ˜¯å‰©ä½™çš„æ•°æ® compareTo():æ»¡è¶³ä¸‹åˆ—æ¡ä»¶ï¼Œåˆ™è®¤ä¸ºä¸€ä¸ªBufferâ€œå°äºŽâ€å¦ä¸€ä¸ªBuffer ç¬¬ä¸€ä¸ªä¸ç›¸ç­‰çš„å…ƒç´ å°äºŽå¦ä¸€ä¸ªBufferä¸­å¯¹åº”çš„å…ƒç´  æ‰€æœ‰å…ƒç´ éƒ½ç›¸ç­‰ï¼Œä½†ç¬¬ä¸€ä¸ªBufferæ¯”å¦ä¸€ä¸ªå…ˆè€—å°½(ç¬¬ä¸€ä¸ªBufferçš„å…ƒç´ ä¸ªæ•°æ¯”å¦ä¸€ä¸ªå°‘) SelectorSelectorå…è®¸å•çº¿ç¨‹å¤„ç†å¤šä¸ª Channelã€‚å¦‚æžœä½ çš„åº”ç”¨æ‰“å¼€äº†å¤šä¸ªè¿žæŽ¥ï¼ˆé€šé“ï¼‰ï¼Œä½†æ¯ä¸ªè¿žæŽ¥çš„æµé‡éƒ½å¾ˆä½Žï¼Œä½¿ç”¨Selectorå°±ä¼šå¾ˆæ–¹ä¾¿ å¤§è‡´æµç¨‹å½“æ‚¨è°ƒç”¨ä¸€ä¸ªé€‰æ‹©å™¨å¯¹è±¡çš„ select( )æ–¹æ³•æ—¶ï¼Œç›¸å…³çš„é”®ä¼šè¢«æ›´æ–°ï¼Œç”¨æ¥æ£€æŸ¥æ‰€æœ‰è¢«æ³¨å†Œåˆ°è¯¥é€‰æ‹©å™¨çš„é€šé“ã€‚æ‚¨å¯ä»¥èŽ·å–ä¸€ä¸ªé”®çš„é›†åˆï¼Œä»Žè€Œæ‰¾åˆ°å½“æ—¶å·²ç»å°±ç»ªçš„é€šé“ã€‚é€šè¿‡éåŽ†è¿™äº›é”®ï¼Œæ‚¨å¯ä»¥é€‰æ‹©å‡ºæ¯ä¸ªä»Žä¸Šæ¬¡æ‚¨è°ƒç”¨ select( )å¼€å§‹ç›´åˆ°çŽ°åœ¨ï¼Œå·²ç»å°±ç»ªçš„é€šé“ é€‰æ‹©å™¨(Selector)çš„ç‰¹ç‚¹12345678public abstract class Selector&#123;// This is a partial API listingpublic static Selector open( ) throws IOExceptionpublic abstract boolean isOpen( );//åˆ¤æ–­æ˜¯openpublic abstract void close( ) throws IOException;//é€‰æ‹©é”®è®¾ç½®æ— æ•ˆpublic abstract SelectionProvider provider( );&#125; é€‰æ‹©å™¨ç±»ç®¡ç†ç€ä¸€ä¸ªè¢«æ³¨å†Œçš„é€šé“é›†åˆçš„ä¿¡æ¯å’Œå®ƒä»¬çš„å°±ç»ªçŠ¶æ€ã€‚é€šé“æ˜¯å’Œé€‰æ‹©å™¨ä¸€èµ·è¢«æ³¨å†Œçš„ï¼Œå¹¶ä¸”ä½¿ç”¨é€‰æ‹©å™¨æ¥æ›´æ–°é€šé“çš„å°±ç»ªçŠ¶æ€ã€‚å½“è¿™ä¹ˆåšçš„æ—¶å€™ï¼Œå¯ä»¥é€‰æ‹©å°†è¢«æ¿€å‘çš„çº¿ç¨‹æŒ‚èµ·ï¼Œç›´åˆ°æœ‰å°±ç»ªçš„çš„é€šé“ ä¸èƒ½æ³¨å†Œå·²ç»å…³é—­çš„selectableChannel é€šè¿‡è°ƒç”¨ä¸€ä¸ªè‡ªå®šä¹‰çš„ SelectorProviderå¯¹è±¡çš„ openSelector( )æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Selector å®žä¾‹ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ provider( )æ–¹æ³•æ¥å†³å®šç”±å“ªä¸ª SelectorProvider å¯¹è±¡æ¥åˆ›å»ºç»™å®šçš„ Selector å®žä¾‹ é€šé“(Channel)çš„ç‰¹ç‚¹1234567891011121314public abstract class SelectableChannelextends AbstractChannelimplements Channel&#123;// This is a partial API listingpublic abstract SelectionKey register (Selector sel, int ops)throws ClosedChannelException;public abstract SelectionKey register (Selector sel, int ops,Object att)throws ClosedChannelException;public abstract boolean isRegistered( );public abstract SelectionKey keyFor (Selector sel);public abstract int validOps( );&#125; ç»§æ‰¿SelectableChannel ä¸€ä¸ªchannelå¯ä»¥æ³¨å†Œåˆ°å¤šä¸ªselectorä¸­ ä¸€ä¸ªselectorä¸­åŒä¸€ä¸ªchannelåªèƒ½æœ‰ä¸€ä¸ª é€šé“è¢«æ³¨å†Œå‰ï¼Œè¦éžé˜»å¡žæ¨¡å¼ æ”¯æŒConnectã€Acceptã€Readã€Writeå››ç§å¯é€‰æ‹©æ“ä½œäº‹ä»¶ï¼Œä½†å¹¶ä¸æ˜¯æ‰€æœ‰çš„SelectableChanneléƒ½å­˜åœ¨ä»¥ä¸Šå››ç±»ï¼Œå¯ä»¥é€šè¿‡validOps()èŽ·å–å¯ä»¥ä½¿ç”¨çš„æ“ä½œäº‹ä»¶é›†åˆ å¦‚æžœä½ å¯¹ä¸æ­¢ä¸€ç§äº‹ä»¶æ„Ÿå…´è¶£ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨â€œä½æˆ–â€æ“ä½œç¬¦å°†å¸¸é‡è¿žæŽ¥èµ·æ¥ ä»»ä½•ä¸€ä¸ªé€šé“å’Œé€‰æ‹©å™¨çš„æ³¨å†Œå…³ç³»éƒ½è¢«å°è£…åœ¨ä¸€ä¸ª SelectionKey å¯¹è±¡ä¸­ã€‚ keyFor( )æ–¹æ³•å°†è¿”å›žä¸Žè¯¥é€šé“å’ŒæŒ‡å®šçš„é€‰æ‹©å™¨ç›¸å…³çš„é”®ã€‚å¦‚æžœé€šé“è¢«æ³¨å†Œåˆ°æŒ‡å®šçš„é€‰æ‹©å™¨ä¸Šï¼Œé‚£ä¹ˆç›¸å…³çš„é”®å°†è¢«è¿”å›žã€‚å¦‚æžœå®ƒä»¬ä¹‹é—´æ²¡æœ‰æ³¨å†Œå…³ç³»ï¼Œé‚£ä¹ˆå°†è¿”å›ž null é€‰æ‹©é”®(SelectionKey)çš„ç‰¹ç‚¹123456789101112131415161718192021package java.nio.channels;public abstract class SelectionKey&#123;public static final int OP_READpublic static final int OP_WRITEpublic static final int OP_CONNECTpublic static final int OP_ACCEPTpublic abstract SelectableChannel channel( );public abstract Selector selector( );public abstract void cancel( );public abstract boolean isValid( );public abstract int interestOps( );public abstract void interestOps (int ops);public abstract int readyOps( );public final boolean isReadable( )public final boolean isWritable( )public final boolean isConnectable( )public final boolean isAcceptable( )public final Object attach (Object ob)public final Object attachment( )&#125; å°è£…äº†ç‰¹å®šçš„é€šé“ä¸Žç‰¹å®šçš„é€‰æ‹©å™¨çš„æ³¨å†Œå…³ç³» ä¸€ä¸ª SelectionKey å¯¹è±¡åŒ…å«ä¸¤ä¸ªä»¥æ•´æ•°å½¢å¼è¿›è¡Œç¼–ç çš„byteæŽ©ç ï¼šä¸€ä¸ªç”¨äºŽæŒ‡ç¤ºé‚£äº›é€šé“/é€‰æ‹©å™¨ç»„åˆä½“æ‰€å…³å¿ƒçš„æ“ä½œ(instrest é›†åˆ)ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºé€šé“å‡†å¤‡å¥½è¦æ‰§è¡Œçš„æ“ä½œï¼ˆ ready é›†åˆï¼‰ å½“ç»ˆç»“æ³¨å†Œå…³ç³»æ—¶ å½“åº”è¯¥ç»ˆç»“è¿™ç§å…³ç³»çš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨ SelectionKeyå¯¹è±¡çš„ cancel( )æ–¹æ³•ã€‚å¯ä»¥é€šè¿‡è°ƒç”¨ isValid( )æ–¹æ³•æ¥æ£€æŸ¥å®ƒæ˜¯å¦ä»ç„¶è¡¨ç¤ºä¸€ç§æœ‰æ•ˆçš„å…³ç³»ã€‚å½“é”®è¢«å–æ¶ˆæ—¶ï¼Œå®ƒå°†è¢«æ”¾åœ¨ç›¸å…³çš„é€‰æ‹©å™¨çš„å·²å–æ¶ˆçš„é”®çš„é›†åˆé‡Œã€‚æ³¨å†Œä¸ä¼šç«‹å³è¢«å–æ¶ˆï¼Œä½†é”®ä¼šç«‹å³å¤±æ•ˆã€‚å½“å†æ¬¡è°ƒç”¨ select( )æ–¹æ³•æ—¶ï¼ˆæˆ–è€…ä¸€ä¸ªæ­£åœ¨è¿›è¡Œçš„ select()è°ƒç”¨ç»“æŸæ—¶ï¼‰ï¼Œå·²å–æ¶ˆçš„é”®çš„é›†åˆä¸­çš„è¢«å–æ¶ˆçš„é”®å°†è¢«æ¸…ç†æŽ‰ï¼Œå¹¶ä¸”ç›¸åº”çš„æ³¨é”€ä¹Ÿå°†å®Œæˆã€‚é€šé“ä¼šè¢«æ³¨é”€ï¼Œè€Œæ–°çš„SelectionKey å°†è¢«è¿”å›ž å½“é€šé“å…³é—­æ—¶ å½“é€šé“å…³é—­æ—¶ï¼Œæ‰€æœ‰ç›¸å…³çš„é”®ä¼šè‡ªåŠ¨å–æ¶ˆï¼ˆè®°ä½ï¼Œä¸€ä¸ªé€šé“å¯ä»¥è¢«æ³¨å†Œåˆ°å¤šä¸ªé€‰æ‹©å™¨ä¸Šï¼‰ã€‚å½“é€‰æ‹©å™¨å…³é—­æ—¶ï¼Œæ‰€æœ‰è¢«æ³¨å†Œåˆ°è¯¥é€‰æ‹©å™¨çš„é€šé“éƒ½å°†è¢«æ³¨é”€ï¼Œå¹¶ä¸”ç›¸å…³çš„é”®å°†ç«‹å³è¢«æ— æ•ˆåŒ–ï¼ˆå–æ¶ˆï¼‰ã€‚ä¸€æ—¦é”®è¢«æ— æ•ˆåŒ–ï¼Œè°ƒç”¨å®ƒçš„ä¸Žé€‰æ‹©ç›¸å…³çš„æ–¹æ³•å°±å°†æŠ›å‡º CancelledKeyException interest é›†åˆ å½“å‰çš„ interest é›†åˆå¯ä»¥é€šè¿‡è°ƒç”¨é”®å¯¹è±¡çš„ interestOps( )æ–¹æ³•æ¥èŽ·å– æœ€åˆï¼Œè¿™åº”è¯¥æ˜¯é€šé“è¢«æ³¨å†Œæ—¶ä¼ è¿›æ¥çš„å€¼ã€‚è¿™ä¸ª interset é›†åˆæ°¸è¿œä¸ä¼šè¢«é€‰æ‹©å™¨æ”¹å˜ï¼Œä½†æ‚¨å¯ä»¥é€šè¿‡è°ƒç”¨ interestOps( )æ–¹æ³•å¹¶ä¼ å…¥ä¸€ä¸ªæ–°çš„byteæŽ©ç å‚æ•°æ¥æ”¹å˜å®ƒã€‚ interest é›†åˆä¹Ÿå¯ä»¥é€šè¿‡å°†é€šé“æ³¨å†Œåˆ°é€‰æ‹©å™¨ä¸Šæ¥æ”¹å˜ï¼ˆå®žé™…ä¸Šä½¿ç”¨ä¸€ç§è¿‚å›žçš„æ–¹å¼è°ƒç”¨ interestOps( )ï¼‰ï¼Œå°±åƒ 4.1.2 å°èŠ‚ä¸­æçš„é‚£æ ·ã€‚å½“ç›¸å…³çš„ Selector ä¸Šçš„ select( )æ“ä½œæ­£åœ¨è¿›è¡Œæ—¶æ”¹å˜é”®çš„ interest é›†åˆï¼Œä¸ä¼šå½±å“é‚£ä¸ªæ­£åœ¨è¿›è¡Œçš„é€‰æ‹©æ“ä½œã€‚æ‰€æœ‰æ›´æ”¹å°†ä¼šåœ¨ select( )çš„ä¸‹ä¸€ä¸ªè°ƒç”¨ä¸­ä½“çŽ°å‡ºæ¥ readyé›†åˆ å¯ä»¥é€šè¿‡è°ƒç”¨é”®çš„ readyOps( )æ–¹æ³•æ¥èŽ·å–ç›¸å…³çš„é€šé“çš„å·²ç»å°±ç»ªçš„æ“ä½œã€‚ ready é›†åˆæ˜¯ interesté›†åˆçš„å­é›†ï¼Œå¹¶ä¸”è¡¨ç¤ºäº† interest é›†åˆä¸­ä»Žä¸Šæ¬¡è°ƒç”¨ select( )ä»¥æ¥å·²ç»å°±ç»ªçš„é‚£äº›æ“ä½œ SelectionKey ç±»å®šä¹‰äº†å››ä¸ªä¾¿äºŽä½¿ç”¨çš„å¸ƒå°”æ–¹æ³•æ¥ä¸ºæ‚¨æµ‹è¯•è¿™äº›byteå€¼ï¼š isReadable( )ï¼Œ isWritable( )ï¼Œ isConnectable( )ï¼Œ å’Œ isAcceptable( ) SelectionKey å¯¹è±¡åŒ…å«çš„ ready é›†åˆä¸Žæœ€è¿‘ä¸€æ¬¡é€‰æ‹©å™¨å¯¹æ‰€æ³¨å†Œçš„é€šé“æ‰€ä½œçš„æ£€æŸ¥ç›¸åŒã€‚è€Œæ¯ä¸ªå•ç‹¬çš„é€šé“çš„å°±ç»ªçŠ¶æ€ä¼šåŒæ—¶æ”¹å˜ é™„åŠ çš„å¯¹è±¡ å¯ä»¥å°†ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ›´å¤šä¿¡æ¯é™„ç€åˆ°SelectionKeyä¸Šï¼Œè¿™æ ·å°±èƒ½æ–¹ä¾¿çš„è¯†åˆ«æŸä¸ªç»™å®šçš„é€šé“ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥é™„åŠ  ä¸Žé€šé“ä¸€èµ·ä½¿ç”¨çš„Bufferï¼Œæˆ–æ˜¯åŒ…å«èšé›†æ•°æ®çš„æŸä¸ªå¯¹è±¡ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š 12selectionKey.attach(theObject);Object attachedObj = selectionKey.attachment(); è¿˜å¯ä»¥åœ¨ç”¨register()æ–¹æ³•å‘Selectoræ³¨å†ŒChannelçš„æ—¶å€™é™„åŠ å¯¹è±¡ã€‚å¦‚ï¼š 1SelectionKey key = channel.register(selector, SelectionKey.OP_READ, theObject); å¦‚æžœé€‰æ‹©é”®çš„å­˜ç»­æ—¶é—´å¾ˆé•¿ï¼Œä½†æ‚¨é™„åŠ çš„å¯¹è±¡ä¸åº”è¯¥å­˜åœ¨é‚£ä¹ˆé•¿æ—¶é—´ï¼Œè¯·è®°å¾—åœ¨å®ŒæˆåŽæ¸…ç†é™„ä»¶ã€‚å¦åˆ™ï¼Œæ‚¨é™„åŠ çš„å¯¹è±¡å°†ä¸èƒ½è¢«åžƒåœ¾å›žæ”¶ï¼Œæ‚¨å°†ä¼šé¢ä¸´å†…å­˜æ³„æ¼é—®é¢˜ æ€»ä½“ä¸Šè¯´ï¼Œ SelectionKey å¯¹è±¡æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†çŸ¥é“ä¿®æ”¹ interest é›†åˆçš„æ“ä½œæ˜¯é€šè¿‡ Selector å¯¹è±¡è¿›è¡ŒåŒæ­¥çš„æ˜¯å¾ˆé‡è¦çš„ã€‚è¿™å¯èƒ½ä¼šå¯¼è‡´ interestOps( )æ–¹æ³•çš„è°ƒç”¨ä¼šé˜»å¡žä¸ç¡®å®šé•¿çš„ä¸€æ®µæ—¶é—´ã€‚é€‰æ‹©å™¨æ‰€ä½¿ç”¨çš„é”ç­–ç•¥ï¼ˆä¾‹å¦‚æ˜¯å¦åœ¨æ•´ä¸ªé€‰æ‹©è¿‡ç¨‹ä¸­ä¿æŒè¿™äº›é”ï¼‰æ˜¯ä¾èµ–äºŽå…·ä½“å®žçŽ°çš„ã€‚å¹¸å¥½ï¼Œè¿™ç§å¤šå…ƒå¤„ç†èƒ½åŠ›è¢«ç‰¹åˆ«åœ°è®¾è®¡ä¸ºå¯ä»¥ä½¿ç”¨å•çº¿ç¨‹æ¥ç®¡ç†å¤šä¸ªé€šé“ã€‚è¢«å¤šä¸ªçº¿ç¨‹ä½¿ç”¨çš„é€‰æ‹©å™¨ä¹Ÿåªä¼šåœ¨ç³»ç»Ÿç‰¹åˆ«å¤æ‚æ—¶äº§ç”Ÿé—®é¢˜ã€‚ é€‰æ‹©è¿‡ç¨‹123456789public abstract class Selector&#123;public abstract Set keys( );public abstract Set selectedKeys( );public abstract int select( ) throws IOException;public abstract int select (long timeout) throws IOException;public abstract int selectNow( ) throws IOException;public abstract void wakeup( );&#125; å·²æ³¨å†Œçš„é”®çš„é›†åˆ ä¸Žé€‰æ‹©å™¨å…³è”çš„å·²ç»æ³¨å†Œçš„é”®çš„é›†åˆã€‚å¹¶ä¸æ˜¯æ‰€æœ‰æ³¨å†Œè¿‡çš„é”®éƒ½ä»ç„¶æœ‰æ•ˆã€‚è¿™ä¸ªé›†åˆé€šè¿‡keys( )æ–¹æ³•è¿”å›žï¼Œå¹¶ä¸”å¯èƒ½æ˜¯ç©ºçš„ã€‚è¿™ä¸ªå·²æ³¨å†Œçš„é”®çš„é›†åˆä¸æ˜¯å¯ä»¥ç›´æŽ¥ä¿®æ”¹çš„ï¼›è¯•å›¾è¿™ä¹ˆåšçš„è¯å°†å¼• java.lang.UnsupportedOperationExceptionã€‚ å·²é€‰æ‹©çš„é”®çš„é›†åˆ å·²æ³¨å†Œçš„é”®çš„é›†åˆçš„å­é›†ã€‚è¿™ä¸ªé›†åˆçš„æ¯ä¸ªæˆå‘˜éƒ½æ˜¯ç›¸å…³çš„é€šé“è¢«é€‰æ‹©å™¨ï¼ˆåœ¨å‰ä¸€ä¸ªé€‰æ‹©æ“ä½œä¸­ï¼‰åˆ¤æ–­ä¸ºå·²ç»å‡†å¤‡å¥½çš„ï¼Œå¹¶ä¸”åŒ…å«äºŽé”®çš„ interest é›†åˆä¸­çš„æ“ä½œã€‚è¿™ä¸ªé›†åˆé€šè¿‡ selectedKeys( )æ–¹æ³•è¿”å›žï¼ˆå¹¶æœ‰å¯èƒ½æ˜¯ç©ºçš„ï¼‰ ä¸è¦å°†å·²é€‰æ‹©çš„é”®çš„é›†åˆä¸Ž ready é›†åˆå¼„æ··äº†ã€‚è¿™æ˜¯ä¸€ä¸ªé”®çš„é›†åˆï¼Œæ¯ä¸ªé”®éƒ½å…³è”ä¸€ä¸ªå·²ç»å‡†å¤‡å¥½è‡³å°‘ä¸€ç§æ“ä½œçš„é€šé“ã€‚æ¯ä¸ªé”®éƒ½æœ‰ä¸€ä¸ªå†…åµŒçš„ ready é›†åˆï¼ŒæŒ‡ç¤ºäº†æ‰€å…³è”çš„é€šé“å·²ç»å‡†å¤‡å¥½çš„æ“ä½œ é”®å¯ä»¥ç›´æŽ¥ä»Žè¿™ä¸ªé›†åˆä¸­ç§»é™¤ï¼Œä½†ä¸èƒ½æ·»åŠ  å·²å–æ¶ˆçš„é”®çš„é›†åˆ å·²æ³¨å†Œçš„é”®çš„é›†åˆçš„å­é›†ï¼Œè¿™ä¸ªé›†åˆåŒ…å«äº† cancel( )æ–¹æ³•è¢«è°ƒç”¨è¿‡çš„é”®ï¼ˆè¿™ä¸ªé”®å·²ç»è¢«æ— æ•ˆåŒ–ï¼‰ï¼Œä½†å®ƒä»¬è¿˜æ²¡æœ‰è¢«æ³¨é”€ã€‚è¿™ä¸ªé›†åˆæ˜¯é€‰æ‹©å™¨å¯¹è±¡çš„ç§æœ‰æˆå‘˜ï¼Œå› è€Œæ— æ³•ç›´æŽ¥è®¿é—® åœ¨ä¸€ä¸ªåˆšåˆå§‹åŒ–çš„ Selector å¯¹è±¡ä¸­ï¼Œè¿™ä¸‰ä¸ªé›†åˆéƒ½æ˜¯ç©ºçš„ã€‚ æ‰§è¡Œæ­¥éª¤ å·²å–æ¶ˆçš„é”®çš„é›†åˆå°†ä¼šè¢«æ£€æŸ¥ã€‚å¦‚æžœå®ƒæ˜¯éžç©ºçš„ï¼Œæ¯ä¸ªå·²å–æ¶ˆçš„é”®çš„é›†åˆä¸­çš„é”®å°†ä»Žå¦å¤–ä¸¤ä¸ªé›†åˆä¸­ç§»é™¤ï¼Œå¹¶ä¸”ç›¸å…³çš„é€šé“å°†è¢«æ³¨é”€ã€‚è¿™ä¸ªæ­¥éª¤ç»“æŸåŽï¼Œå·²å–æ¶ˆçš„é”®çš„é›†åˆå°†æ˜¯ç©ºçš„ã€‚ å·²æ³¨å†Œçš„é”®çš„é›†åˆä¸­çš„é”®çš„ interest é›†åˆå°†è¢«æ£€æŸ¥ã€‚åœ¨è¿™ä¸ªæ­¥éª¤ä¸­çš„æ£€æŸ¥æ‰§è¡Œè¿‡åŽï¼Œå¯¹interest é›†åˆçš„æ”¹åŠ¨ä¸ä¼šå½±å“å‰©ä½™çš„æ£€æŸ¥è¿‡ç¨‹ã€‚ a.å¦‚æžœé€šé“çš„é”®è¿˜æ²¡æœ‰å¤„äºŽå·²é€‰æ‹©çš„é”®çš„é›†åˆä¸­ï¼Œé‚£ä¹ˆé”®çš„ ready é›†åˆå°†è¢«æ¸…ç©ºï¼Œç„¶åŽè¡¨ç¤ºæ“ä½œç³»ç»Ÿå‘çŽ°çš„å½“å‰é€šé“å·²ç»å‡†å¤‡å¥½çš„æ“ä½œçš„æ¯”ç‰¹æŽ©ç å°†è¢«è®¾ç½®ã€‚ b.å¦åˆ™ï¼Œä¹Ÿå°±æ˜¯é”®åœ¨å·²é€‰æ‹©çš„é”®çš„é›†åˆä¸­ã€‚é”®çš„ ready é›†åˆå°†è¢«è¡¨ç¤ºæ“ä½œç³»ç»Ÿå‘çŽ°çš„å½“å‰å·²ç»å‡†å¤‡å¥½çš„æ“ä½œçš„æ¯”ç‰¹æŽ©ç æ›´æ–°ã€‚æ‰€æœ‰ä¹‹å‰çš„å·²ç»ä¸å†æ˜¯å°±ç»ªçŠ¶æ€çš„æ“ä½œä¸ä¼šè¢«æ¸…é™¤ã€‚äº‹å®žä¸Šï¼Œæ‰€æœ‰çš„æ¯”ç‰¹ä½éƒ½ä¸ä¼šè¢«æ¸…ç†ã€‚ç”±æ“ä½œç³»ç»Ÿå†³å®šçš„ ready é›†åˆæ˜¯ä¸Žä¹‹å‰çš„ ready é›†åˆæŒ‰ä½åˆ†ç¦»çš„ï¼Œä¸€æ—¦é”®è¢«æ”¾ç½®äºŽé€‰æ‹©å™¨çš„å·²é€‰æ‹©çš„é”®çš„é›†åˆä¸­ï¼Œå®ƒçš„ ready é›†åˆå°†æ˜¯ç´¯ç§¯çš„ã€‚æ¯”ç‰¹ä½åªä¼šè¢«è®¾ç½®ï¼Œä¸ä¼šè¢«æ¸…ç†ã€‚ æ­¥éª¤ 2 å¯èƒ½ä¼šèŠ±è´¹å¾ˆé•¿æ—¶é—´ï¼Œç‰¹åˆ«æ˜¯æ‰€æ¿€å‘çš„çº¿ç¨‹å¤„äºŽä¼‘çœ çŠ¶æ€æ—¶ã€‚ä¸Žè¯¥é€‰æ‹©å™¨ç›¸å…³çš„é”®å¯èƒ½ä¼šåŒæ—¶è¢«å–æ¶ˆã€‚å½“æ­¥éª¤ 2 ç»“æŸæ—¶ï¼Œæ­¥éª¤ 1 å°†é‡æ–°æ‰§è¡Œï¼Œä»¥å®Œæˆä»»æ„ä¸€ä¸ªåœ¨é€‰æ‹©è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œé”®å·²ç»è¢«å–æ¶ˆçš„é€šé“çš„æ³¨é”€ã€‚ select æ“ä½œè¿”å›žçš„å€¼æ˜¯ ready é›†åˆåœ¨æ­¥éª¤ 2 ä¸­è¢«ä¿®æ”¹çš„é”®çš„æ•°é‡ï¼Œè€Œä¸æ˜¯å·²é€‰æ‹©çš„é”®çš„é›†åˆä¸­çš„é€šé“çš„æ€»æ•°ã€‚è¿”å›žå€¼ä¸æ˜¯å·²å‡†å¤‡å¥½çš„é€šé“çš„æ€»æ•°ï¼Œè€Œæ˜¯ä»Žä¸Šä¸€ä¸ª select( )è°ƒç”¨ä¹‹åŽè¿›å…¥å°±ç»ªçŠ¶æ€çš„é€šé“çš„æ•°é‡ã€‚ä¹‹å‰çš„è°ƒç”¨ä¸­å°±ç»ªçš„ï¼Œå¹¶ä¸”åœ¨æœ¬æ¬¡è°ƒç”¨ä¸­ä»ç„¶å°±ç»ªçš„é€šé“ä¸ä¼šè¢«è®¡å…¥ï¼Œè€Œé‚£äº›åœ¨å‰ä¸€æ¬¡è°ƒç”¨ä¸­å·²ç»å°±ç»ªä½†å·²ç»ä¸å†å¤„äºŽå°±ç»ªçŠ¶æ€çš„é€šé“ä¹Ÿä¸ä¼šè¢«è®¡å…¥ã€‚è¿™äº›é€šé“å¯èƒ½ä»ç„¶åœ¨å·²é€‰æ‹©çš„é”®çš„é›†åˆä¸­ï¼Œä½†ä¸ä¼šè¢«è®¡å…¥è¿”å›žå€¼ä¸­ã€‚è¿”å›žå€¼å¯èƒ½æ˜¯ 0ã€‚ ä¸ºä»€ä¹ˆå»¶è¿Ÿæ³¨é”€ ä½¿ç”¨å†…éƒ¨çš„å·²å–æ¶ˆçš„é”®çš„é›†åˆæ¥å»¶è¿Ÿæ³¨é”€ï¼Œæ˜¯ä¸€ç§é˜²æ­¢çº¿ç¨‹åœ¨å–æ¶ˆé”®æ—¶é˜»å¡žï¼Œå¹¶é˜²æ­¢ä¸Žæ­£åœ¨è¿›è¡Œçš„é€‰æ‹©æ“ä½œå†²çªçš„ä¼˜åŒ–ã€‚æ³¨é”€é€šé“æ˜¯ä¸€ä¸ªæ½œåœ¨çš„ä»£ä»·å¾ˆé«˜çš„æ“ä½œï¼Œè¿™å¯èƒ½éœ€è¦é‡æ–°åˆ†é…èµ„æºï¼ˆè¯·è®°ä½ï¼Œé”®æ˜¯ä¸Žé€šé“ç›¸å…³çš„ï¼Œå¹¶ä¸”å¯èƒ½ä¸Žå®ƒä»¬ç›¸å…³çš„é€šé“å¯¹è±¡ä¹‹é—´æœ‰å¤æ‚çš„äº¤äº’ï¼‰ã€‚ ä¸‰ç§select()æ–¹æ³•ä»…ä»…åœ¨å®ƒä»¬åœ¨æ‰€æ³¨å†Œçš„é€šé“å½“å‰éƒ½æ²¡æœ‰å°±ç»ªæ—¶ï¼Œæ˜¯å¦é˜»å¡žçš„æ–¹é¢æœ‰æ‰€ä¸åŒã€‚ select():åœ¨æ²¡æœ‰é€šé“å°±ç»ªæ—¶å°†æ— é™é˜»å¡žã€‚ä¸€æ—¦è‡³å°‘æœ‰ä¸€ä¸ªå·²æ³¨å†Œçš„é€šé“å°±ç»ªï¼Œé€‰æ‹©å™¨çš„é€‰æ‹©é”®å°±ä¼šè¢«æ›´æ–°ï¼Œå¹¶ä¸”æ¯ä¸ªå°±ç»ªçš„é€šé“çš„ ready é›†åˆä¹Ÿå°†è¢«æ›´æ–°ã€‚è¿”å›žå€¼å°†ä¼šæ˜¯å·²ç»ç¡®å®šå°±ç»ªçš„é€šé“çš„æ•°ç›®ã€‚æ­£å¸¸æƒ…å†µä¸‹ï¼Œ è¿™äº›æ–¹æ³•å°†è¿”å›žä¸€ä¸ªé›¶çš„å€¼ï¼Œå› ä¸ºç›´åˆ°ä¸€ä¸ªé€šé“å°±ç»ªå‰å®ƒéƒ½ä¼šé˜»å¡žã€‚ select(long timeout):å¦‚æžœåœ¨æ‚¨æä¾›çš„è¶…æ—¶æ—¶é—´ï¼ˆä»¥æ¯«ç§’è®¡ç®—ï¼‰å†…æ²¡æœ‰é€šé“å°±ç»ªæ—¶ï¼Œå®ƒå°†è¿”å›ž 0ã€‚å¦‚æžœä¸€ä¸ªæˆ–è€…å¤šä¸ªé€šé“åœ¨æ—¶é—´é™åˆ¶ç»ˆæ­¢å‰å°±ç»ªï¼Œé”®çš„çŠ¶æ€å°†ä¼šè¢«æ›´æ–°ï¼Œå¹¶ä¸”æ–¹æ³•ä¼šåœ¨é‚£æ—¶ç«‹å³è¿”å›žã€‚å°†è¶…æ—¶å‚æ•°æŒ‡å®šä¸º 0 è¡¨ç¤ºå°†æ— é™æœŸç­‰å¾…ï¼Œé‚£ä¹ˆå®ƒå°±åœ¨å„ä¸ªæ–¹é¢éƒ½ç­‰åŒäºŽä½¿ç”¨select() selectNow():æ‰§è¡Œå°±ç»ªæ£€æŸ¥è¿‡ç¨‹ï¼Œä½†ä¸é˜»å¡žã€‚å¦‚æžœå½“å‰æ²¡æœ‰é€šé“å°±ç»ªï¼Œå®ƒå°†ç«‹å³è¿”å›ž 0 åœæ­¢é€‰æ‹©è¿‡ç¨‹wakeUp() æŸä¸ªçº¿ç¨‹è°ƒç”¨select()æ–¹æ³•åŽé˜»å¡žäº†ï¼Œå³ä½¿æ²¡æœ‰é€šé“å·²ç»å°±ç»ªï¼Œä¹Ÿæœ‰åŠžæ³•è®©å…¶ä»Žselect()æ–¹æ³•è¿”å›žã€‚åªè¦è®©å…¶å®ƒçº¿ç¨‹åœ¨ç¬¬ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨select()æ–¹æ³•çš„é‚£ä¸ªå¯¹è±¡ä¸Šè°ƒç”¨Selector.wakeup()æ–¹æ³•å³å¯ã€‚é˜»å¡žåœ¨select()æ–¹æ³•ä¸Šçš„çº¿ç¨‹ä¼šç«‹é©¬è¿”å›žã€‚ å¦‚æžœæœ‰å…¶å®ƒçº¿ç¨‹è°ƒç”¨äº†wakeup()æ–¹æ³•ï¼Œä½†å½“å‰æ²¡æœ‰çº¿ç¨‹é˜»å¡žåœ¨select()æ–¹æ³•ä¸Šï¼Œä¸‹ä¸ªè°ƒç”¨select()æ–¹æ³•çš„çº¿ç¨‹ä¼šç«‹å³â€œé†’æ¥ï¼ˆwake upï¼‰â€ã€‚ close() ç”¨å®ŒSelectoråŽè°ƒç”¨å…¶close()æ–¹æ³•ä¼šå…³é—­è¯¥Selectorï¼Œä¸”ä½¿æ³¨å†Œåˆ°è¯¥Selectorä¸Šçš„æ‰€æœ‰SelectionKeyå®žä¾‹æ— æ•ˆã€‚é€šé“æœ¬èº«å¹¶ä¸ä¼šå…³é—­ã€‚ interrupt() å¦‚æžœç¡çœ ä¸­çš„çº¿ç¨‹çš„ interrupt( )æ–¹æ³•è¢«è°ƒç”¨ï¼Œå®ƒçš„è¿”å›žçŠ¶æ€å°†è¢«è®¾ç½®ã€‚å¦‚æžœè¢«å”¤é†’çš„çº¿ç¨‹ä¹‹åŽå°†è¯•å›¾åœ¨é€šé“ä¸Šæ‰§è¡Œ I/O æ“ä½œï¼Œé€šé“å°†ç«‹å³å…³é—­ï¼Œç„¶åŽçº¿ç¨‹å°†æ•æ‰åˆ°ä¸€ä¸ªå¼‚å¸¸ã€‚ ä¾‹å­æœåŠ¡ç«¯ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283import java.net.InetSocketAddress;import java.nio.ByteBuffer;import java.nio.channels.SelectionKey;import java.nio.channels.Selector;import java.nio.channels.ServerSocketChannel;import java.nio.channels.SocketChannel;import java.util.Iterator;public class NIOServer &#123; // é€šé“ç®¡ç†å™¨ private Selector selector; public void initServer(int port) throws Exception &#123; // èŽ·å¾—ä¸€ä¸ªServerSocketé€šé“ ServerSocketChannel serverChannel = ServerSocketChannel.open(); // è®¾ç½®é€šé“ä¸º éžé˜»å¡ž serverChannel.configureBlocking(false); // å°†è¯¥é€šé“å¯¹äºŽçš„serverSocketç»‘å®šåˆ°portç«¯å£ serverChannel.socket().bind(new InetSocketAddress(port)); // èŽ·å¾—ä¸€è€³å…‰é€šé“ç®¡ç†å™¨ this.selector = Selector.open(); // å°†é€šé“ç®¡ç†å™¨å’Œè¯¥é€šé“ç»‘å®šï¼Œå¹¶ä¸ºè¯¥é€šé“æ³¨å†ŒselectionKey.OP_ACCEPTäº‹ä»¶ // æ³¨å†Œè¯¥äº‹ä»¶åŽï¼Œå½“äº‹ä»¶åˆ°è¾¾çš„æ—¶å€™ï¼Œselector.select()ä¼šè¿”å›žï¼Œ // å¦‚æžœäº‹ä»¶æ²¡æœ‰åˆ°è¾¾selector.select()ä¼šä¸€ç›´é˜»å¡ž serverChannel.register(selector, SelectionKey.OP_ACCEPT); &#125; // é‡‡ç”¨è½®è®­çš„æ–¹å¼ç›‘å¬selectorä¸Šæ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„äº‹ä»¶ï¼Œå¦‚æžœæœ‰ï¼Œè¿›è¡Œå¤„ç† public void listen() throws Exception &#123; System.out.println("start server"); // è½®è¯¢è®¿é—®selector while (true) &#123; // å½“æ³¨å†Œäº‹ä»¶åˆ°è¾¾æ—¶ï¼Œæ–¹æ³•è¿”å›žï¼Œå¦åˆ™è¯¥æ–¹æ³•ä¼šä¸€ç›´é˜»å¡ž selector.select(); // èŽ·å¾—selectorä¸­é€‰ä¸­çš„ç›¸çš„è¿­ä»£å™¨ï¼Œé€‰ä¸­çš„ç›¸ä¸ºæ³¨å†Œçš„äº‹ä»¶ Iterator ite = this.selector.selectedKeys().iterator(); while (ite.hasNext()) &#123; SelectionKey key = (SelectionKey) ite.next(); // åˆ é™¤å·²é€‰çš„key ä»¥é˜²é‡è´Ÿå¤„ç† ite.remove(); // å®¢æˆ·ç«¯è¯·æ±‚è¿žæŽ¥äº‹ä»¶ if (key.isAcceptable()) &#123; ServerSocketChannel server = (ServerSocketChannel) key.channel(); // èŽ·å¾—å’Œå®¢æˆ·ç«¯è¿žæŽ¥çš„é€šé“ SocketChannel channel = server.accept(); // è®¾ç½®æˆéžé˜»å¡ž channel.configureBlocking(false); // åœ¨è¿™é‡Œå¯ä»¥å‘é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ channel.write(ByteBuffer.wrap(new String("hello client").getBytes())); // åœ¨å®¢æˆ·ç«¯ è¿žæŽ¥æˆåŠŸä¹‹åŽï¼Œä¸ºäº†å¯ä»¥æŽ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œéœ€è¦ç»™é€šé“è®¾ç½®è¯»çš„æƒé™ channel.register(this.selector, SelectionKey.OP_READ); // èŽ·å¾—äº†å¯è¯»çš„äº‹ä»¶ &#125; else if (key.isReadable()) &#123; read(key); &#125; &#125; &#125; &#125; // å¤„ç† è¯»å–å®¢æˆ·ç«¯å‘æ¥çš„ä¿¡æ¯äº‹ä»¶ private void read(SelectionKey key) throws Exception &#123; // æœåŠ¡å™¨å¯è¯»æ¶ˆæ¯ï¼Œå¾—åˆ°äº‹ä»¶å‘ç”Ÿçš„socketé€šé“ SocketChannel channel = (SocketChannel) key.channel(); // ç©¿ä»¶è¯»å–çš„ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(10); channel.read(buffer); byte[] data = buffer.array(); String msg = new String(data).trim(); System.out.println("server receive from client: " + msg); ByteBuffer outBuffer = ByteBuffer.wrap(msg.getBytes()); channel.write(outBuffer); &#125; public static void main(String[] args) throws Throwable &#123; NIOServer server = new NIOServer(); server.initServer(8989); server.listen(); &#125;&#125; å®¢æˆ·ç«¯ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182import java.io.IOException;import java.net.InetSocketAddress;import java.nio.ByteBuffer;import java.nio.channels.SelectionKey;import java.nio.channels.Selector;import java.nio.channels.SocketChannel;import java.util.Iterator;public class NIOClient &#123; // é€šé“ç®¡ç†å™¨ private Selector selector; /** * * // èŽ·å¾—ä¸€ä¸ªSocketé€šé“ï¼Œå¹¶å¯¹è¯¥é€šé“åšä¸€äº›åˆå§‹åŒ–çš„å·¥ä½œ * @param ip è¿žæŽ¥çš„æœåŠ¡å™¨çš„ip // * @param port * è¿žæŽ¥çš„æœåŠ¡å™¨çš„ç«¯å£å· * @throws IOException */ public void initClient(String ip, int port) throws IOException &#123; // èŽ·å¾—ä¸€ä¸ªSocketé€šé“ SocketChannel channel = SocketChannel.open(); // è®¾ç½®é€šé“ä¸ºéžé˜»å¡ž channel.configureBlocking(false); // èŽ·å¾—ä¸€ä¸ªé€šé“ç®¡ç†å™¨ this.selector = Selector.open(); // å®¢æˆ·ç«¯è¿žæŽ¥æœåŠ¡å™¨,å…¶å®žæ–¹æ³•æ‰§è¡Œå¹¶æ²¡æœ‰å®žçŽ°è¿žæŽ¥ï¼Œéœ€è¦åœ¨listen()æ–¹æ³•ä¸­è°ƒ // ç”¨channel.finishConnect();æ‰èƒ½å®Œæˆè¿žæŽ¥ channel.connect(new InetSocketAddress(ip, port)); // å°†é€šé“ç®¡ç†å™¨å’Œè¯¥é€šé“ç»‘å®šï¼Œå¹¶ä¸ºè¯¥é€šé“æ³¨å†ŒSelectionKey.OP_CONNECTäº‹ä»¶ã€‚ channel.register(selector, SelectionKey.OP_CONNECT); &#125; /** * * // é‡‡ç”¨è½®è¯¢çš„æ–¹å¼ç›‘å¬selectorä¸Šæ˜¯å¦æœ‰éœ€è¦å¤„ç†çš„äº‹ä»¶ï¼Œå¦‚æžœæœ‰ï¼Œåˆ™è¿›è¡Œå¤„ç† * @throws // IOException * @throws Exception */ @SuppressWarnings("unchecked") public void listen() throws Exception &#123; // è½®è¯¢è®¿é—®selector while (true) &#123; // é€‰æ‹©ä¸€ç»„å¯ä»¥è¿›è¡ŒI/Oæ“ä½œçš„äº‹ä»¶ï¼Œæ”¾åœ¨selectorä¸­,å®¢æˆ·ç«¯çš„è¯¥æ–¹æ³•ä¸ä¼šé˜»å¡žï¼Œ // è¿™é‡Œå’ŒæœåŠ¡ç«¯çš„æ–¹æ³•ä¸ä¸€æ ·ï¼ŒæŸ¥çœ‹apiæ³¨é‡Šå¯ä»¥çŸ¥é“ï¼Œå½“è‡³å°‘ä¸€ä¸ªé€šé“è¢«é€‰ä¸­æ—¶ï¼Œ // selectorçš„wakeupæ–¹æ³•è¢«è°ƒç”¨ï¼Œæ–¹æ³•è¿”å›žï¼Œè€Œå¯¹äºŽå®¢æˆ·ç«¯æ¥è¯´ï¼Œé€šé“ä¸€ç›´æ˜¯è¢«é€‰ä¸­çš„ selector.select(); // èŽ·å¾—selectorä¸­é€‰ä¸­çš„é¡¹çš„è¿­ä»£å™¨ Iterator ite = this.selector.selectedKeys().iterator(); while (ite.hasNext()) &#123; SelectionKey key = (SelectionKey) ite.next(); // åˆ é™¤å·²é€‰çš„key,ä»¥é˜²é‡å¤å¤„ç† ite.remove(); // è¿žæŽ¥äº‹ä»¶å‘ç”Ÿ if (key.isConnectable()) &#123; SocketChannel channel = (SocketChannel) key.channel(); // å¦‚æžœæ­£åœ¨è¿žæŽ¥ï¼Œåˆ™å®Œæˆè¿žæŽ¥ if (channel.isConnectionPending()) &#123; channel.finishConnect(); &#125; // è®¾ç½®æˆéžé˜»å¡ž channel.configureBlocking(false); // åœ¨è¿™é‡Œå¯ä»¥ç»™æœåŠ¡ç«¯å‘é€ä¿¡æ¯å“¦ channel.write(ByteBuffer.wrap(new String("hello server!").getBytes())); // åœ¨å’ŒæœåŠ¡ç«¯è¿žæŽ¥æˆåŠŸä¹‹åŽï¼Œä¸ºäº†å¯ä»¥æŽ¥æ”¶åˆ°æœåŠ¡ç«¯çš„ä¿¡æ¯ï¼Œéœ€è¦ç»™é€šé“è®¾ç½®è¯»çš„æƒé™ã€‚ channel.register(this.selector, SelectionKey.OP_READ); // èŽ·å¾—äº†å¯è¯»çš„äº‹ä»¶ &#125; else if (key.isReadable()) &#123; read(key); &#125; &#125; &#125; &#125; private void read(SelectionKey key) throws Exception &#123; SocketChannel channel = (SocketChannel) key.channel(); // ç©¿ä»¶è¯»å–çš„ç¼“å†²åŒº ByteBuffer buffer = ByteBuffer.allocate(10); channel.read(buffer); byte[] data = buffer.array(); String msg = new String(data).trim(); System.out.println("client receive msg from server:" + msg); ByteBuffer outBuffer = ByteBuffer.wrap(msg.getBytes()); channel.write(outBuffer); &#125; /** * * // å¯åŠ¨å®¢æˆ·ç«¯æµ‹è¯• * @throws IOException * @throws Exception */ public static void main(String[] args) throws Exception &#123; NIOClient client = new NIOClient(); client.initClient("localhost", 8989); client.listen(); &#125;&#125; å‚è€ƒèµ„æ–™Java NIOç³»åˆ—æ•™ç¨‹ Java NIOå­¦ä¹ 8(Selectorï¼‰]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaåå°„èŽ·å–ç±»å’Œå¯¹è±¡ä¿¡æ¯å…¨è§£æž]]></title>
    <url>%2F2016%2F06%2F07%2Fjvm20160607%2F</url>
    <content type="text"><![CDATA[åå°„å¯ä»¥è§£å†³åœ¨ç¼–è¯‘æ—¶æ— æ³•é¢„çŸ¥å¯¹è±¡å’Œç±»æ˜¯å±žäºŽé‚£ä¸ªç±»çš„ï¼Œè¦æ ¹æ®ç¨‹åºè¿è¡Œæ—¶çš„ä¿¡æ¯æ‰èƒ½çŸ¥é“è¯¥å¯¹è±¡å’Œç±»çš„ä¿¡æ¯çš„é—®é¢˜ã€‚ åœ¨ä¸¤ä¸ªäººåä½œå¼€å‘æ—¶ï¼Œä½ åªè¦çŸ¥é“å¯¹æ–¹çš„ç±»åå°±å¯ä»¥è¿›è¡Œåˆæ­¥çš„å¼€å‘äº†ã€‚ èŽ·å–ç±»å¯¹è±¡ Class.forName(String clazzName)é™æ€æ–¹æ³• è°ƒç”¨ç±»çš„classå±žæ€§ï¼ŒPerson.classè¿”å›žçš„å°±æ˜¯Personçš„classå¯¹è±¡ï¼ˆæŽ¨èä½¿ç”¨ï¼‰ è°ƒç”¨æŸä¸ªå¯¹è±¡çš„getClass()æ–¹æ³• å…·ä½“ä½¿ç”¨è¿˜æ˜¯è¦æ ¹æ®å®žé™…æ¥é€‰æ‹©ï¼Œç¬¬ä¸€ç§æ–¹å¼æ˜¯æ¯”è¾ƒè‡ªç”±çš„ï¼Œåªè¦çŸ¥é“ä¸€ä¸ªç±»åå°±å¯ä»¥äº†ï¼Œå…¶ä¸ä¼šåšè¯¥ç±»æ˜¯å¦å­˜åœ¨çš„æ ¡éªŒï¼Œç¬¬äºŒç§ã€ç¬¬ä¸‰ç§åˆ™ä¼šåšæ ¡éªŒ èŽ·å–ç±»çš„ä¿¡æ¯èŽ·å–ç±»æž„é€ å™¨ Connstructor&lt;T&gt; getConstructor(Class&lt;?&gt;...parameterTypes):è¿”å›žæ­¤Classå¯¹è±¡å¯¹åº”ç±»çš„å¸¦æŒ‡å®šå½¢å‚çš„publicæž„é€ å™¨ Constructor&lt;?&gt;[] getConstructors():è¿”å›žæ­¤Classå¯¹è±¡å¯¹åº”ç±»çš„æ‰€æœ‰publicæž„é€ å™¨ Constructor&lt;T&gt;[] getDeclaredConstructor(Class&lt;?&gt;...parameterTypes):è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„å¸¦æŒ‡å®šå‚æ•°çš„æž„é€ å™¨ï¼Œä¸Žæž„é€ å™¨çš„è®¿é—®æƒé™æ— å…³ Constructor&lt;?&gt;[] getDeclaredConstructors():è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„æ‰€æœ‰æž„é€ å™¨ï¼Œä¸Žæž„é€ å™¨çš„è®¿é—®æƒé™æ— å…³ èŽ·å–ç±»æˆå‘˜æ–¹æ³• Method getMethod(String name,Class&lt;?&gt;...parameterTypes):è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„å¸¦æŒ‡å®šå½¢å‚çš„publicæ–¹æ³• Method[] getMethods():è¿”å›žæ­¤classå¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„æ‰€æœ‰publicæ–¹æ³• Method getDeclaredMethod(string name,Class&lt;?&gt;...parameterTypes):è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„å¸¦æŒ‡å®šå½¢å‚çš„æ–¹æ³•ï¼Œä¸Žæ–¹æ³•è®¿é—®æƒé™æ— å…³ Method[] getDeclaredMethods():è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„å…¨éƒ¨æ–¹æ³•ï¼Œä¸Žæ–¹æ³•çš„è®¿é—®æƒé™æ— å…³ èŽ·å–ç±»æˆå‘˜å˜é‡ Field getField(String name):è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„æŒ‡å®šåç§°çš„publicæˆå‘˜å˜é‡ Field[] getFields():è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„æ‰€æœ‰publicæˆå‘˜å˜é‡ Field getDeclaredField(String name):è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„æŒ‡å®šåç§°çš„æˆå‘˜å˜é‡ï¼Œä¸Žæˆå‘˜å˜é‡è®¿é—®æƒé™æ— å…³ Field[] getDeclaredFields():è¿”å›žæ­¤classå¯¹è±¡å¯¹åº”ç±»çš„å…¨éƒ¨æˆå‘˜å˜é‡ï¼Œä¸Žæˆå‘˜å˜é‡çš„è®¿é—®æƒé™æ— å…³ èŽ·å–ç±»æ³¨è§£ &lt;A extends Annotation&gt;A getAnnotation(Class&lt;A&gt;annotationClass):å°è¯•èŽ·å–è¯¥classå¯¹è±¡å¯¹åº”ç±»ä¸Šæ‘å­çš„æŒ‡å®šç±»åž‹çš„Annotationï¼Œå¦‚æžœè¯¥ç±»åž‹æ³¨è§£ä¸å­˜åœ¨ï¼Œåˆ™è¿”å›žnull &lt;A extends Annotation&gt;A getDeclaredAnnotation(Class&lt;A&gt;annotationClass):è¿™æ˜¯Java 8ä¸­æ–°å¢žçš„ï¼Œè¯¥æ–¹æ³•èŽ·å–ç›´æŽ¥ä¿®é¥°è¯¥classå¯¹è±¡å¯¹åº”ç±»çš„æŒ‡å®šç±»åž‹çš„Annotationï¼Œå¦‚æžœä¸å­˜åœ¨ï¼Œåˆ™è¿”å›žnull Annotation[] getAnnotations():è¿”å›žä¿®é¥°è¯¥classå¯¹è±¡å¯¹åº”ç±»ä¸Šå­˜åœ¨çš„æ‰€æœ‰Annotation Annotation[] getDeclaredAnnotations():è¿”å›žä¿®é¥°è¯¥Classå¯¹è±¡å¯¹åº”ç±»ä¸Šå­˜åœ¨çš„æ‰€æœ‰Annotation &lt;A extends Annotation&gt;A[] getAnnotationByType(Class&lt;A&gt;annotationClass):è¯¥æ–¹æ³•çš„åŠŸèƒ½ä¸Žå‰é¢ä»‹ç»çš„getAnnotation()æ–¹æ³•åŸºæœ¬ç›¸ä¼¼ï¼Œä½†ç”±äºŽJava8å¢žåŠ äº†é‡å¤æ³¨è§£åŠŸèƒ½ï¼Œå› æ­¤éœ€è¦ä½¿ç”¨è¯¥æ–¹æ³•èŽ·å–ä¿®é¥°è¯¥ç±»çš„æŒ‡å®šç±»åž‹çš„å¤šä¸ªAnnotation &lt;A extends Annotation&gt;A[] getDeclaredAnnotationByType(Class&lt;A&gt;annotationClass):è¯¥æ–¹æ³•å‘åŠŸèƒ½ä¸Žå‰é¢ä»‹ç»çš„getDeclaredAnnotations()æ–¹æ³•ç›¸ä¼¼ï¼Œä¹Ÿæ˜¯å› ä¸ºJava8çš„é‡å¤æ³¨è§£çš„åŠŸèƒ½ï¼Œéœ€è¦ä½¿ç”¨è¯¥æ–¹æ³•èŽ·å–ç›´æŽ¥ä¿®é¥°è¯¥ç±»çš„æŒ‡å®šç±»åž‹çš„å¤šä¸ªAnnotation èŽ·å–è¯¥ç±»å†…éƒ¨ç±» Class&lt;?&gt;[] getDeclaredClasses():è¿”å›žè¯¥classé˜Ÿå½¢å¯¹åº”ç±»é‡ŒåŒ…å«çš„å…¨éƒ¨å†…éƒ¨ç±» èŽ·å–è¯¥ç±»å¯¹è±¡æ‰€åœ¨çš„å¤–éƒ¨ç±» Class&lt;?&gt; getDeclaringClass():è¿”å›žè¯¥Classå¯¹è±¡å¯¹åº”ç±»æ‰€åœ¨çš„å¤–éƒ¨ç±» èŽ·å–è¯¥ç±»å¯¹è±¡å¯¹åº”ç±»æ‰€å®žçŽ°çš„æŽ¥å£ Class&lt;?&gt;[] getInterfaces():è¿”å›žè¯¥Classå¯¹è±¡å¯¹åº”ç±»æ‰€å®žçŽ°çš„å…¨éƒ¨æŽ¥å£ èŽ·å–è¯¥ç±»å¯¹è±¡å¯¹åº”ç±»æ‰€ç»§æ‰¿çš„çˆ¶ç±» Class&lt;? super T&gt; getSuperclass():è¿”å›žè¯¥Classå¯¹è±¡å¯¹åº”ç±»çš„è¶…ç±»çš„Classå¯¹è±¡ èŽ·å–è¯¥ç±»å¯¹è±¡å¯¹åº”ç±»çš„ä¿®é¥°ç¬¦ã€æ‰€åœ¨åŒ…ã€ç±»åç­‰åŸºæœ¬ä¿¡æ¯ int getModifiers():è¿”å›žæ­¤ç±»æˆ–æŽ¥å£çš„æ‰€æœ‰ä¿®é¥°ç¬¦ï¼Œä¿®é¥°ç¬¦ç”±publicã€protectedã€privateã€finalã€staticã€abstractç­‰å¯¹åº”çš„å¸¸é‡ç»„æˆï¼Œè¿”å›žçš„æ•´æ•°åº”ä½¿ç”¨Modifierå·¥å…·ç±»çš„æ–¹æ³•æ¥è§£ç ï¼Œæ‰å¯ä»¥èŽ·å–çœŸæ˜¯çš„ä¿®é¥°ç¬¦ Package getPackage():èŽ·å–è¯¥ç±»çš„åŒ… String getName():ä»¥å­—ç¬¦ä¸²å½¢å¼è¿”å›žæ­¤CLasså¯¹è±¡æ‰€è¡¨ç¤ºçš„ç±»çš„ç®€ç§° åˆ¤æ–­è¯¥ç±»æ˜¯å¦ä¸ºæŽ¥å£ã€æžšä¸¾ã€æ³¨è§£ç±»åž‹ boolean isAnnotation():è¿”å›žæ­¤classå¯¹è±¡æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæ³¨è§£ç±»åž‹ boolean isAnnotationPresent(Class&lt;? extends Annotation&gt;annotationClass):åˆ¤æ–­æ­¤Classå¯¹è±¡æ˜¯å¦ä½¿ç”¨ç±»Annotationä¿®é¥° boolean isAnonymousClass():è¿”å›žæ­¤classå¯¹è±¡æ˜¯å¦æ˜¯ä¸€ä¸ªåŒ¿åç±» boolean isArray():è¿”å›žæ­¤classå¯¹è±¡æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæ•°ç»„ç±» boolean isEnum():è¿”å›žæ­¤classå¯¹è±¡æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæžšä¸¾ boolean isInterface():è¿”å›žæ­¤classå¯¹è±¡æ˜¯å¦è¡¨ç¤ºä¸€ä¸ªæŽ¥å£ boolean isInstance(Object obj):åˆ¤æ–­objæ˜¯å¦æ˜¯æ­¤classå¯¹è±¡çš„å®žä¾‹ï¼Œè¯¥æ–¹æ³•å¯ä»¥å®Œå…¨ä»£æ›¿instanceofæ“ä½œç¬¦ 123public interface Colorable &#123; public void value();&#125; 12345678910public class ClassInfo &#123; public static void main(String[] args) throws NoSuchMethodException, SecurityException &#123; Class&lt;Colorable&gt; cls=Colorable.class; System.out.println(cls.getMethod("value")); System.out.println(cls.isAnnotation()); System.out.println(cls.isInterface()); &#125;&#125; ç»“æžœ 123public abstract void com.em.Colorable.value()falsetrue Java8ä¸­æ–°å¢žçš„æ–¹æ³•å‚æ•°åå°„ int getParameterCount():èŽ·å–è¯¥æž„é€ å™¨æˆ–æ–¹æ³•çš„å½¢å‚ä¸ªæ•° Parameter[] getParameters():èŽ·å–è¯¥æž„é€ å™¨æˆ–æ–¹æ³•çš„æ‰€æœ‰å½¢å‚ getModifiers():èŽ·å–ä¿®é¥°è¯¥å½¢å‚çš„ä¿®é¥°ç¬¦ String getName():èŽ·å–å½¢å‚å Type getParameterizedType():èŽ·å–å¸¦æ³›åž‹çš„å½¢å‚ç±»åž‹ Class&lt;?&gt;getType():èŽ·å–å½¢å‚ç±»åž‹ boolean isNamePresent():è¯¥æ–¹æ³•è¿”å›žè¯¥ç±»çš„classæ–‡ä»¶ä¸­æ˜¯å¦åŒ…å«äº†æ–¹æ³•çš„å½¢å‚åä¿¡æ¯ boolean isVarArgs():è¯¥æ–¹æ³•ç”¨äºŽåˆ¤æ–­è¯¥å‚æ•°æ˜¯å¦ä¸ºä¸ªæ•°å¯å˜çš„å½¢å‚ 12345public class Test &#123; public void getInfo(String str,List&lt;String&gt;list)&#123; System.out.println("æˆåŠŸ"); &#125;&#125; 12345678910111213141516public class ClassInfo &#123; public static void main(String[] args) throws NoSuchMethodException, SecurityException &#123; Class&lt;Test&gt; cls=Test.class; Method med=cls.getMethod("getInfo", String.class,List.class); System.out.println(med.getParameterCount()); Parameter[] params=med.getParameters(); System.out.println(params.length); for(Parameter par:params)&#123; System.out.println(par.getName()); System.out.println(par.getType()); System.out.println(par.getParameterizedType()); &#125; &#125;&#125; ç»“æžœ 1234567822arg0class java.lang.Stringclass java.lang.Stringarg1interface java.util.Listjava.util.List&lt;java.lang.String&gt; åå°„ç”Ÿæˆå¯¹è±¡ ä½¿ç”¨Classå¯¹è±¡çš„newInstance()æ–¹æ³•åˆ›å»ºClasså¯¹è±¡çš„å®žä¾‹ï¼Œè¯¥æ–¹æ³•è¦æ±‚è¦æœ‰é»˜è®¤æž„é€ å™¨ï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼‰ å…ˆä½¿ç”¨Classå¯¹è±¡èŽ·å–æŒ‡å®šçš„Constructorå¯¹è±¡ï¼Œåœ¨è°ƒç”¨Constructorå¯¹è±¡çš„newInstance()æ–¹æ³•æ¥åˆ›å»ºè¯¥Classå¯¹è±¡å¯¹åº”ç±»çš„å®žä¾‹ åå°„è°ƒç”¨æ–¹æ³• Object invoke(Object obj,Object...args):è¯¥æ–¹æ³•ä¸­çš„objæ˜¯æ‰§è¡Œè¯¥æ–¹æ³•çš„ä¸»è°ƒï¼ŒåŽé¢çš„argsæ˜¯æ‰§è¡Œè¯¥æ–¹æ³•æ—¶ä¼ å…¥è¯¥æ–¹æ³•çš„å®žå‚ 123456789public class Test &#123; public Test(String str) &#123; System.out.println(str); &#125; public void getInfo(String str)&#123; System.out.println(str); &#125;&#125; 1234567891011public class ClassInfo &#123; public static void main(String[] args) throws Exception &#123; Class&lt;Test&gt; cls=Test.class; Constructor&lt;Test&gt;construct=cls.getConstructor(String.class); Test test=construct.newInstance("åˆå§‹åŒ–"); Method med=cls.getMethod("getInfo", String.class); med.invoke(test, "è°ƒç”¨æ–¹æ³•æˆåŠŸ"); &#125;&#125; ç»“æžœ 12åˆå§‹åŒ–è°ƒç”¨æ–¹æ³•æˆåŠŸ æŽ¥ä¸‹æ¥çœ‹å®˜ä»”ç»†çœ‹ä¸‹é¢çš„æ —å­ 12345678910public class Test &#123; public Test(String str) &#123; System.out.println(str); &#125; //ç§æœ‰æ–¹æ³• private void getInfo(String str)&#123; System.out.println(str); &#125;&#125; 1234567891011121314public class ClassInfo &#123; public static void main(String[] args) throws Exception &#123; Class&lt;Test&gt; cls=Test.class; Constructor&lt;Test&gt;construct=cls.getConstructor(String.class); Test test=construct.newInstance("åˆå§‹åŒ–"); //ä¸ºå•¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ Method med=cls.getDeclaredMethod("getInfo", String.class); //ä¸ºå•¥ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å‘¢ï¼Ÿ med.setAccessible(true); med.invoke(test, "è°ƒç”¨æ–¹æ³•æˆåŠŸ"); &#125;&#125; ç»“æžœ 12åˆå§‹åŒ–è°ƒç”¨æ–¹æ³•æˆåŠŸ setAccessible(boolean flag):å°†å€¼è®¾ä¸ºtrueï¼ŒæŒ‡ç¤ºè¯¥Methodåœ¨ä½¿ç”¨æ˜¯åº”è¯¥å–æ¶ˆJavaè¯­è¨€çš„è®¿é—®æƒé™æ£€æŸ¥ è®¿é—®æˆå‘˜å˜é‡å€¼ getXxx(Object obj):èŽ·å–objå¯¹è±¡çš„è¯¥æˆå‘˜å˜é‡çš„å€¼ã€‚æ­¤å¤„çš„Xxxå¯¹åº”8ç§åŸºæœ¬ç±»åž‹ï¼Œå¦‚æžœè¯¥æˆå‘˜å˜é‡çš„ç±»åž‹æ˜¯å¼•ç”¨ç±»åž‹çš„ï¼Œåˆ™åŽ»æŽ‰Xxxéƒ¨åˆ† setXxx(Object obj,Xxx val):å°†objå¯¹è±¡çš„è¯¥æˆå‘˜å˜é‡è®¾ç½®ä¸ºvalå€¼ã€‚æ­¤å¤„çš„Xxxå¯¹åº”8ä¸­åŸºæœ¬ç±»åž‹ï¼Œå¦‚æžœè¯¥æˆå‘˜å˜é‡çš„ç±»åž‹æ˜¯å¼•ç”¨ç±»åž‹ï¼Œåˆ™å–æ¶ˆsetåŽé¢çš„Xxx ä»¥ä¸Šä¸¤ä¸ªæ–¹æ³•å¯ä»¥æ–¹æ³•æ‰€æœ‰çš„æˆå‘˜å˜é‡ï¼ŒåŒ…æ‹¬privateçš„ç§æœ‰æˆå‘˜å˜é‡ 1234567891011121314151617public class Test &#123; private int num; public Test(String str) &#123; System.out.println(str); &#125; private void getInfo(String str)&#123; System.out.println(str); &#125; public int getNum() &#123; return num; &#125; public void setNum(int num) &#123; this.num = num; &#125; &#125; 12345678910111213141516public class ClassInfo &#123; public static void main(String[] args) throws Exception &#123; Class&lt;Test&gt; cls=Test.class; Constructor&lt;Test&gt;construct=cls.getConstructor(String.class); Test test=construct.newInstance("åˆå§‹åŒ–"); Method med=cls.getDeclaredMethod("getInfo", String.class); med.setAccessible(true); med.invoke(test, "è°ƒç”¨æ–¹æ³•æˆåŠŸ"); Field fld=cls.getDeclaredField("num"); fld.setAccessible(true); fld.setInt(test, 12); System.out.println(fld.getInt(test)); &#125;&#125; ç»“æžœ 123åˆå§‹åŒ–è°ƒç”¨æ–¹æ³•æˆåŠŸ12 æ“ä½œæ•°ç»„java.lang.reflectåŒ…ä¸‹æœ‰ä¸€ä¸ªArrayç±»ï¼Œå…¶å¯ä»¥åŠ¨æ€åˆ›å»ºæ•°ç»„ static Object newInstance(Class&lt;?&gt;componentType,int...length):åˆ›å»ºä¸€ä¸ªå…·æœ‰æŒ‡å®šçš„å…ƒç´ ç±»åž‹ã€æŒ‡å®šç»´åº¦çš„æ–°æ•°ç»„ static xxx getXxx(Object array,int index):è¿”å›žarrayæ•°ç»„ä¸­ç¬¬indexä¸ªå…ƒç´ ã€‚å…¶ä¸­xxxæ˜¯å„ç§åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œå¦‚æžœæ•°ç»„å…ƒç´ æ˜¯å¼•ç”¨ç±»åž‹ï¼Œåˆ™è¯¥æ–¹æ³•å˜ä¸ºget() static void setXxx(Object array,int index,xxx val):å°†arrayæ•°ç»„ä¸­ä½Žindex ä¸ªå…ƒç´ çš„å€¼è®¾ä¸ºvalï¼Œå…¶ä¸­xxxæ˜¯å„ç§åŸºæœ¬æ•°æ®ç±»åž‹ï¼Œå¦‚æžœæ•°ç»„å…ƒç´ æ˜¯å¼•ç”¨ç±»åž‹ï¼Œåˆ™è¯¥æ–¹æ³•å˜ä¸ºset() 12345678910public class ArrayInfo &#123; public static void main(String[] args) &#123; Object arrays=Array.newInstance(String.class, 3); Array.set(arrays, 0, "ç¬¬ä¸€ä¸ª"); Array.set(arrays, 1, "ç¬¬äºŒä¸ª"); Array.set(arrays, 2, "ç¬¬ä¸‰ä¸ª"); System.out.println(Array.get(arrays, 2)); &#125;&#125;]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaä»£ç†è®¾è®¡æ¨¡å¼è¯¦è§£]]></title>
    <url>%2F2016%2F06%2F01%2Fjvm20160601%2F</url>
    <content type="text"><![CDATA[ä»£ç†å³é€šè¿‡ä»£ç†ç±»ï¼Œæ‰¾åˆ°é€‚åˆä½ çš„å®žçŽ°ç±»ã€‚ç›¸å½“äºŽçŽ°å®žç”Ÿæ´»ä¸­çš„ä¸­ä»‹çš„è§’è‰²ï¼Œä½ æƒ³ç§Ÿæˆ¿å­ï¼Œè¿™ä¸ªæ—¶å€™ä½ åˆä¸æƒ³è‡ªå·±æ‰¾æˆ¿å­ï¼Œé‚£ä½ å¯ä»¥æ‰¾ä¸­ä»‹ï¼Œé€šè¿‡ä¸­ä»‹æ‰¾åˆ°åˆé€‚è‡ªå·±çš„æˆ¿å­ï¼ŒåŒæ—¶ä½ ä¹Ÿå¯ä»¥è®©ä¸­ä»‹å¸®ä½ ç­¾åˆåŒç­‰å…¶ä»–äº‹å®œã€‚ä»£ç†å­˜åœ¨é™æ€ä»£ç†å’ŒåŠ¨æ€ä»£ç†ä¸¤ç§ é™æ€ä»£ç†123public interface Sourceable &#123; public void method(); &#125; 1234567public class Source implements Sourceable &#123; @Override public void method() &#123; System.out.println("the original method!"); &#125; &#125; 123456789101112131415161718192021public class Proxy implements Sourceable &#123; private Source source; public Proxy()&#123; super(); this.source = new Source(); &#125; @Override public void method() &#123; //æ–°å¢žçš„å¤„ç†ï¼Œä¸ªæ€§åŒ–å¤„ç† before(); source.method(); atfer(); &#125; private void atfer() &#123; System.out.println("after proxy!"); &#125; private void before() &#123; System.out.println("before proxy!"); &#125; &#125; æµ‹è¯•ç±» 12345678public class ProxyTest &#123; public static void main(String[] args) &#123; Sourceable source = new Proxy(); source.method(); &#125; &#125; åŠ¨æ€ä»£ç†JDKåŠ¨æ€ä»£ç†ã€AOPåŠ¨æ€ä»£ç† Proxyæä¾›äº†ç”¨äºŽåˆ›å»ºåŠ¨æ€ä»£ç†ç±»å’Œä»£ç†å¯¹è±¡çš„é™æ€æ–¹æ³•ï¼Œå®ƒä¹Ÿæ˜¯æ‰€æœ‰åŠ¨æ€ä»£ç†ç±»çš„çˆ¶ç±» åˆ›å»ºåŠ¨æ€ä»£ç†ç±» static Class&lt;?&gt;getProxyClass(ClassLoader loader,Class&lt;?&gt;â€¦interfaces):åˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†ç±»é”å¯¹åº”çš„Classå¯¹è±¡ï¼Œè¯¥ä»£ç†ç±»å°†å®žçŽ°interfaceæ‰€æŒ‡å®šçš„å¤šä¸ªæŽ¥å£ï¼Œç¬¬ä¸€ä¸ªClassLoader å‚æ•°æŒ‡ç”ŸæˆåŠ¨æ€ä»£ç†ç±»çš„ç±»åŠ è½½å™¨ã€‚ åˆ›å»ºåŠ¨æ€ä»£ç†å¯¹è±¡ static Object newProxyInstance(ClassLoader loader,Class&lt;?&gt;â€¦interfaces,InvocationHadnler h):ç›´æŽ¥åˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†å¯¹è±¡ï¼Œè¯¥ä»£ç†å¯¹è±¡çš„å®žçŽ°ç±»å®žçŽ°äº†interfacesæŒ‡å®šçš„ç³»åˆ—æŽ¥å£ï¼Œæ‰§è¡Œä»£ç†å¯¹è±¡çš„æ¯ä¸ªæ–¹æ³•æ—¶éƒ½ä¼šè¢«æ›¿æ¢æ‰§è¡ŒInvocationHadnlerå¯¹è±¡çš„invokeæ–¹æ³• 123public interface Colorable &#123; public void value();&#125; 123456public class RedColor implements Colorable&#123; @Override public void value() &#123; System.out.println("--------------red-------------"); &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940414243import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;public class ColorableProxy implements InvocationHandler &#123; private Colorable colorable; private Colorable proxy; public ColorableProxy(Colorable colorable) &#123; this.colorable = colorable; this.proxy = (Colorable) Proxy.newProxyInstance( Colorable.class.getClassLoader(), new Class&lt;?&gt;[] &#123; Colorable.class &#125;, this); &#125; public Colorable getProxy() &#123; return proxy; &#125; @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; String methodName = method.getName(); System.out.println("===========starting invoke function:" + methodName + "=========="); Object result = method.invoke(colorable, args); System.out.println("=========== invoke function:" + methodName + " success=========="); return result; &#125; public static void main(String[] args) &#123; Colorable proxy = new ColorableProxy(new RedColor()).getProxy(); //çœŸæ­£è°ƒç”¨invokeæ–¹æ³•æ˜¯åœ¨è¿™ä¸€æ­¥æ‰è¢«æ¿€å‘çš„ï¼Œå¯ä»¥debugè¯•ä¸€ä¸‹ proxy.value(); &#125;&#125; ç»“æžœ 123===========starting invoke function:value==========--------------red-------------=========== invoke function:value success========== proxyï¼šä»£è¡¨åŠ¨æ€ä»£ç†å¯¹è±¡ methodï¼šä»£è¡¨æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³• args:ä»£è¡¨è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ä¼ å…¥çš„å®žå‚ AOPåŠ¨æ€ä»£ç† 123public interface Colorable &#123; public void value();&#125; 123456public class RedColor implements Colorable&#123; @Override public void value() &#123; System.out.println("--------------red-------------"); &#125;&#125; 123456public class ToolUtility &#123; public void method()&#123; System.out.println("è¿è¡Œå·¥å…·æ–¹æ³•"); &#125;&#125; 12345678910111213141516171819202122232425262728293031323334353637383940import java.lang.reflect.InvocationHandler;import java.lang.reflect.Method;import java.lang.reflect.Proxy;public class ColorableAOProxy implements InvocationHandler &#123; private Colorable colorable; private Colorable proxy; public ColorableAOProxy(Colorable colorable) &#123; this.colorable = colorable; this.proxy = (Colorable) Proxy.newProxyInstance( Colorable.class.getClassLoader(), new Class&lt;?&gt;[] &#123; Colorable.class &#125;, this); &#125; public Colorable getProxy() &#123; return proxy; &#125; @Override public Object invoke(Object proxy, Method method, Object[] args) throws Throwable &#123; ToolUtility tool = new ToolUtility(); tool.method(); String methodName = method.getName(); System.out.println("===========starting invoke function:" + methodName + "=========="); Object result = method.invoke(colorable, args); System.out.println("=========== invoke function:" + methodName + " success=========="); return result; &#125; public static void main(String[] args) &#123; Colorable proxy = new ColorableAOProxy(new RedColor()).getProxy(); // çœŸæ­£è°ƒç”¨invokeæ–¹æ³•æ˜¯åœ¨è¿™ä¸€æ­¥æ‰è¢«æ¿€å‘çš„ï¼Œå¯ä»¥debugè¯•ä¸€ä¸‹ proxy.value(); &#125;&#125; ç»“æžœ 1234è¿è¡Œå·¥å…·æ–¹æ³•===========starting invoke function:value==========--------------red-------------=========== invoke function:value success==========]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JAVAç±»åŠ è½½æœºåˆ¶å…¨è§£æž]]></title>
    <url>%2F2016%2F05%2F31%2Fjvm20160531%2F</url>
    <content type="text"><![CDATA[å½“ç¨‹åºä½¿ç”¨æŸä¸ªç±»æ—¶ï¼Œå¦‚æžœè¯¥ç±»è¿˜æ²¡è¢«åˆå§‹åŒ–ï¼ŒåŠ è½½åˆ°å†…å­˜ä¸­ï¼Œåˆ™ç³»ç»Ÿä¼šé€šè¿‡åŠ è½½ã€è¿žæŽ¥ã€åˆå§‹åŒ–ä¸‰ä¸ªè¿‡ç¨‹æ¥å¯¹è¯¥ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚è¯¥è¿‡ç¨‹å°±è¢«ç§°ä¸ºç±»çš„åˆå§‹åŒ– ç±»åŠ è½½æŒ‡å°†ç±»çš„classæ–‡ä»¶è¯»å…¥å†…å­˜ï¼Œå¹¶ä¸ºä¹‹åˆ›å»ºä¸€ä¸ªjava.lang.Classçš„å¯¹è±¡ ç±»æ–‡ä»¶æ¥æº ä»Žæœ¬åœ°æ–‡ä»¶ç³»ç»ŸåŠ è½½çš„classæ–‡ä»¶ ä»ŽJARåŒ…åŠ è½½classæ–‡ä»¶ ä»Žç½‘ç»œåŠ è½½classæ–‡ä»¶ æŠŠä¸€ä¸ªJavaæºæ–‡ä»¶åŠ¨æ€ç¼–è¯‘ï¼Œå¹¶æ‰§è¡ŒåŠ è½½ ç±»åŠ è½½å™¨é€šå¸¸æ— é¡»ç­‰åˆ°â€œé¦–æ¬¡ä½¿ç”¨â€è¯¥ç±»æ—¶æ‰åŠ è½½è¯¥ç±»ï¼ŒJVMå…è®¸ç³»ç»Ÿé¢„å…ˆåŠ è½½æŸäº›ç±» ç±»åŠ è½½å™¨ç±»åŠ è½½å™¨å°±æ˜¯è´Ÿè´£åŠ è½½æ‰€æœ‰çš„ç±»ï¼Œå°†å…¶è½½å…¥å†…å­˜ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªjava.lang.Classå®žä¾‹ã€‚ä¸€æ—¦ä¸€ä¸ªç±»è¢«åŠ è½½åˆ°JVMä¸­ä¹‹åŽï¼Œå°±ä¸ä¼šå†æ¬¡è½½å…¥äº†ã€‚ æ ¹ç±»åŠ è½½å™¨ï¼ˆBootstrap ClassLoaderï¼‰ï¼šå…¶è´Ÿè´£åŠ è½½Javaçš„æ ¸å¿ƒç±»ï¼Œæ¯”å¦‚Stringã€Systemè¿™äº›ç±» æ‹“å±•ç±»åŠ è½½å™¨ï¼ˆExtension ClassLoaderï¼‰ï¼šå…¶è´Ÿè´£åŠ è½½JREçš„æ‹“å±•ç±»åº“ ç³»ç»Ÿç±»åŠ è½½å™¨ï¼ˆSystem ClassLoaderï¼‰ï¼šå…¶è´Ÿè´£åŠ è½½CLASSPATHçŽ¯å¢ƒå˜é‡æ‰€æŒ‡å®šçš„JARåŒ…å’Œç±»è·¯å¾„ ç”¨æˆ·ç±»åŠ è½½å™¨ï¼šç”¨æˆ·è‡ªå®šä¹‰çš„åŠ è½½å™¨ï¼Œä»¥ç±»åŠ è½½å™¨ä¸ºçˆ¶ç±» ç±»åŠ è½½å™¨ä¹‹é—´çš„çˆ¶å­å…³ç³»å¹¶ä¸æ˜¯ç»§æ‰¿å…³ç³»ï¼Œæ˜¯ç±»åŠ è½½å™¨å®žä¾‹ä¹‹é—´çš„å…³ç³» 1234567891011public static void main(String[] args) throws IOException &#123; ClassLoader systemLoader = ClassLoader.getSystemClassLoader(); System.out.println("ç³»ç»Ÿç±»åŠ è½½"); Enumeration&lt;URL&gt; em1 = systemLoader.getResources(""); while (em1.hasMoreElements()) &#123; System.out.println(em1.nextElement()); &#125; ClassLoader extensionLader = systemLoader.getParent(); System.out.println("æ‹“å±•ç±»åŠ è½½å™¨" + extensionLader); System.out.println("æ‹“å±•ç±»åŠ è½½å™¨çš„çˆ¶" + extensionLader.getParent());&#125; ç»“æžœ 1234ç³»ç»Ÿç±»åŠ è½½file:/E:/gaode/em/bin/æ‹“å±•ç±»åŠ è½½å™¨sun.misc.Launcher$ExtClassLoader@6d06d69cæ‹“å±•ç±»åŠ è½½å™¨çš„çˆ¶null ä¸ºä»€ä¹ˆæ ¹ç±»åŠ è½½å™¨ä¸ºNULL? æ ¹ç±»åŠ è½½å™¨å¹¶ä¸æ˜¯Javaå®žçŽ°çš„ï¼Œè€Œä¸”ç”±äºŽç¨‹åºé€šå¸¸é¡»è®¿é—®æ ¹åŠ è½½å™¨ï¼Œå› æ­¤è®¿é—®æ‰©å±•ç±»åŠ è½½å™¨çš„çˆ¶ç±»åŠ è½½å™¨æ—¶è¿”å›žNULL JVMç±»åŠ è½½æœºåˆ¶ å…¨ç›˜è´Ÿè´£ï¼Œå½“ä¸€ä¸ªç±»åŠ è½½å™¨è´Ÿè´£åŠ è½½æŸä¸ªClassæ—¶ï¼Œè¯¥Classæ‰€ä¾èµ–çš„å’Œå¼•ç”¨çš„å…¶ä»–Classä¹Ÿå°†ç”±è¯¥ç±»åŠ è½½å™¨è´Ÿè´£è½½å…¥ï¼Œé™¤éžæ˜¾ç¤ºä½¿ç”¨å¦å¤–ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è½½å…¥ çˆ¶ç±»å§”æ‰˜ï¼Œå…ˆè®©çˆ¶ç±»åŠ è½½å™¨è¯•å›¾åŠ è½½è¯¥ç±»ï¼Œåªæœ‰åœ¨çˆ¶ç±»åŠ è½½å™¨æ— æ³•åŠ è½½è¯¥ç±»æ—¶æ‰å°è¯•ä»Žè‡ªå·±çš„ç±»è·¯å¾„ä¸­åŠ è½½è¯¥ç±» ç¼“å­˜æœºåˆ¶ï¼Œç¼“å­˜æœºåˆ¶å°†ä¼šä¿è¯æ‰€æœ‰åŠ è½½è¿‡çš„Classéƒ½ä¼šè¢«ç¼“å­˜ï¼Œå½“ç¨‹åºä¸­éœ€è¦ä½¿ç”¨æŸä¸ªClassæ—¶ï¼Œç±»åŠ è½½å™¨å…ˆä»Žç¼“å­˜åŒºå¯»æ‰¾è¯¥Classï¼Œåªæœ‰ç¼“å­˜åŒºä¸å­˜åœ¨ï¼Œç³»ç»Ÿæ‰ä¼šè¯»å–è¯¥ç±»å¯¹åº”çš„äºŒè¿›åˆ¶æ•°æ®ï¼Œå¹¶å°†å…¶è½¬æ¢æˆClasså¯¹è±¡ï¼Œå­˜å…¥ç¼“å­˜åŒºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¿®æ”¹äº†ClassåŽï¼Œå¿…é¡»é‡å¯JVMï¼Œç¨‹åºçš„ä¿®æ”¹æ‰ä¼šç”Ÿæ•ˆ URLClassLoaderç±»URLClassLoaderä¸ºClassLoaderçš„ä¸€ä¸ªå®žçŽ°ç±»ï¼Œè¯¥ç±»ä¹Ÿæ˜¯ç³»ç»Ÿç±»åŠ è½½å™¨å’Œæ‹“å±•ç±»åŠ è½½å™¨çš„çˆ¶ç±»ï¼ˆç»§æ‰¿å…³ç³»ï¼‰ã€‚å®ƒæ—¢å¯ä»¥ä»Žæœ¬åœ°æ–‡ä»¶ç³»ç»ŸèŽ·å–äºŒè¿›åˆ¶æ–‡ä»¶æ¥åŠ è½½ç±»ï¼Œä¹Ÿå¯ä»¥è¿œç¨‹ä¸»æœºèŽ·å–äºŒè¿›åˆ¶æ–‡ä»¶æ¥åŠ è½½ç±»ã€‚ ä¸¤ä¸ªæž„é€ å™¨ URLClassLoader(URL[] urls):ä½¿ç”¨é»˜è®¤çš„çˆ¶ç±»åŠ è½½å™¨åˆ›å»ºä¸€ä¸ªClassLoaderå¯¹è±¡ï¼Œè¯¥å¯¹è±¡å°†ä»Žurlsæ‰€æŒ‡å®šçš„è·¯å¾„æ¥æŸ¥è¯¢å¹¶åŠ è½½ç±» URLClassLoader(URL[] urls,ClassLoader parent):ä½¿ç”¨æŒ‡å®šçš„çˆ¶ç±»åŠ è½½å™¨åˆ›å»ºä¸€ä¸ªClassLoaderå¯¹è±¡ï¼Œå…¶ä»–åŠŸèƒ½ä¸Žå‰ä¸€ä¸ªæž„é€ å™¨ç›¸åŒ 12345678910111213141516171819202122232425262728293031323334353637import java.net.MalformedURLException;import java.net.URL;import java.net.URLClassLoader;import java.sql.Connection;import java.sql.SQLException;import java.util.Properties;import com.mysql.jdbc.Driver;public class GetMysql &#123; private static Connection conn; public static Connection getConn(String url,String user,String pass) throws MalformedURLException, InstantiationException, IllegalAccessException, ClassNotFoundException, SQLException&#123; if(conn==null)&#123; URL[]urls=&#123;new URL("file:mysql-connector-java-5.1.18.jar")&#125;; URLClassLoader myClassLoader=new URLClassLoader(urls); Driver driver=(Driver) myClassLoader.loadClass("com.mysql.jdbc.Driver").newInstance(); Properties pros=new Properties(); pros.setProperty("user", user); pros.setProperty("password", pass); conn=driver.connect(url, pros); &#125; return conn; &#125; public static method1 getConn() throws MalformedURLException, InstantiationException, IllegalAccessException, ClassNotFoundException, SQLException&#123; URL[]urls=&#123;new URL("file:com.em")&#125;; URLClassLoader myClassLoader=new URLClassLoader(urls); method1 driver=(method1) myClassLoader.loadClass("com.em.method1").newInstance(); return driver; &#125; public static void main(String[] args) throws MalformedURLException, InstantiationException, IllegalAccessException, ClassNotFoundException, SQLException &#123; System.out.println(getConn("jdbc:mysql://10.10.16.11:3306/auto?useUnicode=true&amp;characterEncoding=utf8&amp;allowMultiQueries=true", "jiji", "jiji")); System.out.println(getConn()); &#125;&#125; èŽ·å¾—URLClassLoaderå¯¹è±¡åŽï¼Œè°ƒç”¨loanClass()æ–¹æ³•æ¥åŠ è½½æŒ‡å®šçš„ç±» è‡ªå®šä¹‰ç±»åŠ è½½å™¨123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204import java.io.File;import java.io.FileInputStream;import java.io.IOException;import java.lang.reflect.Method;public class CompileClassLoader extends ClassLoader&#123; // è¯»å–ä¸€ä¸ªæ–‡ä»¶çš„å†…å®¹ @SuppressWarnings("resource") private byte[] getBytes(String filename) throws IOException &#123; File file = new File(filename); long len = file.length(); byte[] raw = new byte[(int) len]; FileInputStream fin = new FileInputStream(file); // ä¸€æ¬¡è¯»å–classæ–‡ä»¶çš„å…¨éƒ¨äºŒè¿›åˆ¶æ•°æ® int r = fin.read(raw); if (r != len) throw new IOException("æ— æ³•è¯»å–å…¨éƒ¨æ–‡ä»¶" + r + "!=" + len); fin.close(); return raw; &#125; // å®šä¹‰ç¼–è¯‘æŒ‡å®šjavaæ–‡ä»¶çš„æ–¹æ³• private boolean compile(String javaFile) throws IOException &#123; System.out.println("CompileClassLoader:æ­£åœ¨ç¼–è¯‘" + javaFile + "â€¦â€¦.."); // è°ƒç”¨ç³»ç»Ÿçš„javacå‘½ä»¤ Process p = Runtime.getRuntime().exec("javac" + javaFile); try &#123; // å…¶å®ƒçº¿ç¨‹éƒ½ç­‰å¾…è¿™ä¸ªçº¿ç¨‹å®Œæˆ p.waitFor(); &#125; catch (InterruptedException ie) &#123; System.out.println(ie); &#125; // èŽ·å–javac çš„çº¿ç¨‹çš„é€€å‡ºå€¼ int ret = p.exitValue(); // è¿”å›žç¼–è¯‘æ˜¯å¦æˆåŠŸ return ret == 0; &#125; // é‡å†™Classloaderçš„findCLassæ–¹æ³• protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123; Class clazz = null; // å°†åŒ…è·¯å¾„ä¸­çš„.æ›¿æ¢æˆæ–œçº¿/ String fileStub = name.replace(".", "/"); String javaFilename = fileStub + ".java"; String classFilename = fileStub + ".class"; File javaFile = new File(javaFilename); File classFile = new File(classFilename); // å½“æŒ‡å®šJavaæºæ–‡ä»¶å­˜åœ¨ï¼Œä¸”classæ–‡ä»¶ä¸å­˜åœ¨ï¼Œæˆ–è€…Javaæºæ–‡ä»¶çš„ä¿®æ”¹æ—¶é—´æ¯”classæ–‡ä»¶//ä¿®æ”¹æ—¶é—´æ™šæ—¶ï¼Œé‡æ–°ç¼–è¯‘ if (javaFile.exists() &amp;&amp; (!classFile.exists()) || javaFile.lastModified() &gt; classFile.lastModified()) &#123; try &#123; // å¦‚æžœç¼–è¯‘å¤±è´¥ï¼Œæˆ–è¯¥Classæ–‡ä»¶ä¸å­˜åœ¨ if (!compile(javaFilename) || !classFile.exists()) &#123; throw new ClassNotFoundException("ClassNotFoundException:" + javaFilename); &#125; &#125; catch (IOException ex) &#123; ex.printStackTrace(); &#125; &#125; // å¦‚æžœclassæ–‡ä»¶å­˜åœ¨ï¼Œç³»ç»Ÿè´Ÿè´£å°†è¯¥æ–‡ä»¶è½¬åŒ–æˆclasså¯¹è±¡ if (classFile.exists()) &#123; try &#123; // å°†classæ–‡ä»¶çš„äºŒè¿›åˆ¶æ•°æ®è¯»å…¥æ•°ç»„ byte[] raw = getBytes(classFilename); // è°ƒç”¨Classloaderçš„defineClassæ–¹æ³•å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢æˆclasså¯¹è±¡ clazz = defineClass(name, raw, 0, raw.length); &#125; catch (IOException ie) &#123; ie.printStackTrace(); &#125; &#125; // å¦‚æžœclaszzä¸ºnull,è¡¨æ˜ŽåŠ è½½å¤±è´¥ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ if (clazz == null) &#123; throw new ClassNotFoundException(name); &#125; return clazz; &#125; // å®šä¹‰ä¸€ä¸ªä¸»æ–¹æ³• public static void main(String[] args) throws Exception &#123; // å¦‚æžœè¿è¡Œè¯¥ç¨‹åºæ—¶æ²¡æœ‰å‚æ•°ï¼Œå³æ²¡æœ‰ç›®æ ‡ç±» if (args.length &lt; 1) &#123; System.out.println("ç¼ºå°‘è¿è¡Œçš„ç›®æ ‡ç±»ï¼Œè¯·æŒ‰å¦‚ä¸‹æ ¼å¼è¿è¡Œjavaæºæ–‡ä»¶ï¼š"); System.out.println("java CompileClassLoader ClassName"); &#125; // ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯éœ€è¦è¿è¡Œçš„ç±» String progClass = args[0]; // å‰©ä¸‹çš„å‚æ•°å°†ä½œä¸ºè¿è¡Œç›®æ ‡ç±»æ—¶çš„å‚æ•°ï¼Œæ‰€ä»¥å°†è¿™äº›å‚æ•°å¤åˆ¶åˆ°ä¸€ä¸ªæ–°æ•°ç»„ä¸­ String progargs[] = new String[args.length - 1]; System.arraycopy(args, 1, progargs, 0, progargs.length); CompileClassLoader cl = new CompileClassLoader(); // åŠ è½½éœ€è¦è¿è¡Œçš„ç±» Class&lt;?&gt; clazz = cl.loadClass(progClass); // èŽ·å–éœ€è¦è¿è¡Œçš„ç±»çš„ä¸»æ–¹æ³• Method main = clazz.getMethod("main", (new String[0]).getClass()); Object argsArray[] = &#123; progargs &#125;; main.invoke(null, argsArray); &#125;&#125; JVMä¸­é™¤äº†æ ¹ç±»åŠ è½½å™¨ä¹‹å¤–çš„æ‰€æœ‰ç±»çš„åŠ è½½å™¨éƒ½æ˜¯ClassLoaderå­ç±»çš„å®žä¾‹ï¼Œé€šè¿‡é‡å†™ClassLoaderä¸­çš„æ–¹æ³•ï¼Œå®žçŽ°è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ loadClass(String name,boolean resolve):ä¸ºClassLoaderçš„å…¥å£ç‚¹ï¼Œæ ¹æ®æŒ‡å®šåç§°æ¥åŠ è½½ç±»ï¼Œç³»ç»Ÿå°±æ˜¯è°ƒç”¨ClassLoaderçš„è¯¥æ–¹æ³•æ¥èŽ·å–åˆ¶å®šç´¯å¯¹åº”çš„Classå¯¹è±¡ findClass(String name):æ ¹æ®æŒ‡å®šåç§°æ¥æŸ¥æ‰¾ç±» æŽ¨èä½¿ç”¨findClassæ–¹æ³• ç±»çš„é“¾æŽ¥å½“ç±»è¢«åŠ è½½åŽï¼Œç³»ç»Ÿä¼šä¸ºä¹‹ç”Ÿæˆä¸€ä¸ªClasså¯¹è±¡ï¼ŒæŽ¥ç€å°†ä¼šè¿›å…¥è¿žæŽ¥é˜¶æ®µï¼Œé“¾æŽ¥é˜¶æ®µè´Ÿè´£æŠŠç±»çš„äºŒè¿›åˆ¶æ•°æ®åˆå¹¶åˆ°JREä¸­ ä¸‰ä¸ªé˜¶æ®µ éªŒè¯ï¼šæ£€éªŒè¢«åŠ è½½çš„ç±»æ˜¯å¦æœ‰æ­£ç¡®çš„å†…éƒ¨ç»“æž„ï¼Œå¹¶å’Œå…¶ä»–ç±»åè°ƒä¸€è‡´ å‡†å¤‡ï¼šè´Ÿè´£ä¸ºç±»çš„ç±»å˜é‡åˆ†é…å†…å­˜ã€‚å¹¶è®¾ç½®é»˜è®¤åˆå§‹å€¼ è§£æžï¼šå°†ç±»çš„äºŒè¿›åˆ¶æ•°æ®ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢æˆç›´æŽ¥å¼•ç”¨ ç±»çš„åˆå§‹åŒ–JVMè´Ÿè´£å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ï¼Œä¸»è¦å¯¹ç±»å˜é‡è¿›è¡Œåˆå§‹åŒ– åœ¨Javaä¸­å¯¹ç±»å˜é‡è¿›è¡Œåˆå§‹å€¼è®¾å®šæœ‰ä¸¤ç§æ–¹å¼ï¼šâ‘ å£°æ˜Žç±»å˜é‡æ˜¯æŒ‡å®šåˆå§‹å€¼â‘¡ä½¿ç”¨é™æ€ä»£ç å—ä¸ºç±»å˜é‡æŒ‡å®šåˆå§‹å€¼ JVMåˆå§‹åŒ–æ­¥éª¤ å‡å¦‚è¿™ä¸ªç±»è¿˜æ²¡æœ‰è¢«åŠ è½½å’Œè¿žæŽ¥ï¼Œåˆ™ç¨‹åºå…ˆåŠ è½½å¹¶è¿žæŽ¥è¯¥ç±» å‡å¦‚è¯¥ç±»çš„ç›´æŽ¥çˆ¶ç±»è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œåˆ™å…ˆåˆå§‹åŒ–å…¶ç›´æŽ¥çˆ¶ç±» å‡å¦‚ç±»ä¸­æœ‰åˆå§‹åŒ–è¯­å¥ï¼Œåˆ™ç³»ç»Ÿä¾æ¬¡æ‰§è¡Œè¿™äº›åˆå§‹åŒ–è¯­å¥ ç±»åˆå§‹åŒ–æ—¶æœº åˆ›å»ºç±»å®žä¾‹ã€‚ä¹Ÿå°±æ˜¯newçš„æ–¹å¼ è°ƒç”¨æŸä¸ªç±»çš„ç±»æ–¹æ³• è®¿é—®æŸä¸ªç±»æˆ–æŽ¥å£çš„ç±»å˜é‡ï¼Œæˆ–ä¸ºè¯¥ç±»å˜é‡èµ‹å€¼ ä½¿ç”¨åå°„æ–¹å¼å¼ºåˆ¶åˆ›å»ºæŸä¸ªç±»æˆ–æŽ¥å£å¯¹åº”çš„java.lang.Classå¯¹è±¡ åˆå§‹åŒ–æŸä¸ªç±»çš„å­ç±»ï¼Œåˆ™å…¶çˆ¶ç±»ä¹Ÿä¼šè¢«åˆå§‹åŒ– ç›´æŽ¥ä½¿ç”¨java.exeå‘½ä»¤æ¥è¿è¡ŒæŸä¸ªä¸»ç±» ç±»åŠ è½½æœºåˆ¶ï¼ˆç±»åŠ è½½è¿‡ç¨‹å’Œç±»åŠ è½½å™¨ï¼‰]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[å¯¹è±¡ä¸Žå†…å­˜æŽ§åˆ¶]]></title>
    <url>%2F2016%2F05%2F26%2Fjvm20160526%2F</url>
    <content type="text"><![CDATA[JVMçš„åžƒåœ¾å›žæ”¶æœºåˆ¶æ˜¯ç”±ä¸€æ¡åŽå°çº¿ç¨‹æ‰§è¡Œçš„ï¼Œå…¶æœ¬èº«ä¹Ÿæ˜¯éžå¸¸æ¶ˆè€—å†…å­˜çš„ï¼Œå› æ­¤ï¼Œæ»¥ç”¨åˆ›å»ºå¯¹è±¡ï¼Œä¼šå¯¼è‡´æ€§èƒ½å¤§å¤§ä¸‹é™ï¼Œå¯¹å†…å­˜çš„åˆ†é…çš„äº†è§£å°±æ˜¾å¾—å°¤ä¸ºé‡è¦ å˜é‡åˆ†ç±»å±€éƒ¨å˜é‡ å½¢å‚ï¼šå­˜åœ¨äºŽæ–¹æ³•ç­¾åä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼Œæœ‰æ–¹æ³•è°ƒç”¨è€…ä¸ºå…¶èµ‹å€¼ï¼Œéšç€æ–¹æ³•çš„ç»“æŸè€Œæ¶ˆäº¡ æ–¹æ³•å†…éƒ¨å˜é‡ï¼šåœ¨æ–¹æ³•å†…éƒ¨å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼Œå¿…é¡»åœ¨æ–¹æ³•å†…å¯¹å…¶è¿›è¡Œæ˜¾ç¤ºåˆå§‹åŒ–ï¼Œéšç€æ–¹æ³•çš„ç»“æŸè€Œæ¶ˆäº¡ ä»£ç å—å†…éƒ¨çš„å±€éƒ¨å˜é‡ï¼šåœ¨ä»£ç å—å†…å®šä¹‰çš„å±€éƒ¨å˜é‡ï¼Œå¿…é¡»åœ¨ä»£ç å—å†…å¯¹å…¶æ˜¾å¼åˆå§‹åŒ–ï¼Œéšç€ä»£ç å—ç»“æŸè€Œæ¶ˆäº¡ æˆå‘˜å˜é‡ å®žä¾‹å˜é‡ï¼šéžé™æ€çš„æˆå‘˜å˜é‡ï¼Œéšç€å¯¹è±¡çš„äº§ç”Ÿï¼Œè¿›è¡Œåˆå§‹åŒ–ç­‰æ“ä½œï¼Œå¯¹è±¡ç»“æŸå˜é‡ä¹Ÿå°±æ¶ˆäº¡ ç±»å˜é‡ï¼šé™æ€çš„æˆå‘˜å˜é‡ï¼Œå¸¦æœ‰staticä¿®é¥°ç¬¦ï¼Œéšç€ç±»åˆå§‹åŒ–äº§ç”Ÿï¼Œéšç€ç±»æ¶ˆå¤±è€Œæ¶ˆå¤± åœ¨åˆ›å»ºå˜é‡çš„æ—¶å€™ï¼Œä¸€å®šè¦åˆæ³•çš„å‰å‘å¼•ç”¨ã€‚å…¶å«ä¹‰å°±æ˜¯å…ˆå®šä¹‰çš„å˜é‡ä¸èƒ½å¼•ç”¨åŽå®šä¹‰çš„å˜é‡ï¼Œåä¹‹åˆ™å¯ä»¥ å˜é‡çš„å†…å­˜åˆ†é…åœ¨åŒä¸€ä¸ªJVMä¸­æ¯ä¸€ä¸ªç±»åªä¼šå­˜åœ¨ä¸€ä¸ªClasså¯¹è±¡ï¼Œå› æ­¤JVMåªè¦åˆ†é…ä¸€å—å†…å­˜ç©ºé—´ç»™ç±»å˜é‡å°±å¯ä»¥äº†ï¼Œè€Œå®žä¾‹å˜é‡åˆ™æ¯æ¬¡åˆ›å»ºå¯¹è±¡éƒ½è¦ä¸ºå…¶åˆ†é…ä¸€å—å†…å­˜ï¼Œå‡ ä¸ªå®žä¾‹å°±è¦åˆ›å»ºå‡ å—å†…å­˜ç©ºé—´ å®žä¾‹å˜é‡çš„åˆå§‹åŒ–æ—¶æœº å®šä¹‰å˜é‡çš„æ—¶å€™ ä»£ç å—ä¸­ æž„é€ å™¨ä¸­ å®šä¹‰å®žä¾‹å˜é‡æ—¶æŒ‡å®šçš„åˆå§‹å€¼ã€åˆå§‹åŒ–å—ä¸­ä¸ºå®žä¾‹å˜é‡æŒ‡å®šåˆå§‹å€¼çš„è¯­å¥çš„åœ°ä½æ˜¯å¹³ç­‰çš„ï¼Œå½“ç»è¿‡ç¼–è¯‘å™¨å¤„ç†åŽï¼Œä»–ä»¬éƒ½å°†è¢«æå–åˆ°æž„é€ å™¨ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç¼–è¯‘åŽï¼Œåˆå§‹åŒ–éƒ½ä¼šè¢«æ”¾åœ¨æž„é€ å™¨ä¸­æŒ‰å…ˆåŽé¡ºåºè¿›è¡Œåˆå§‹åŒ–èµ‹å€¼ ç±»å˜é‡åˆå§‹åŒ–æ—¶æœºåŒä¸€ä¸ªJVMä¸­ï¼Œç±»å˜é‡åªèƒ½åˆå§‹åŒ–ä¸€æ¬¡ å®šä¹‰å˜é‡çš„æ—¶å€™ é™æ€ä»£ç å— çˆ¶ç±»æž„é€ å™¨åœ¨åˆ›å»ºJavaå¯¹è±¡çš„æ—¶å€™ï¼Œéƒ½ä¼šå…ˆåŽ»æ‰§è¡Œè¯¥ç±»çš„çˆ¶ç±»å¯¹è±¡çš„éžé™æ€ä»£ç å—å’Œæž„é€ å™¨ï¼Œæœ€åŽæ‰æ˜¯è¯¥ç±»çš„éžé™æ€ä»£ç å—å’Œæž„é€ å™¨ æ‰€è°“çš„éšå¼è°ƒç”¨å’Œæ˜¾å¼è°ƒç”¨ï¼Œå…¶å®žå°±æ˜¯æœ‰æ²¡æœ‰ç”¨superåŽ»è°ƒç”¨çˆ¶ç±»çš„æž„é€ å™¨çš„åŒºåˆ«ã€‚ å¦‚æžœçˆ¶ç±»è¿˜æ²¡è¢«åˆå§‹åŒ–è¿‡ï¼Œåˆ™ä¼šæœ€å…ˆå¯¹ç±»å˜é‡è¿›è¡Œåˆå§‹åŒ– è®¿é—®å­ç±»å¯¹è±¡çš„å®žä¾‹å˜é‡å­ç±»çš„æ–¹æ³•å¯ä»¥è®¿é—®çˆ¶ç±»çš„å®žä¾‹å˜é‡ï¼Œè¿™æ˜¯å› ä¸ºå­ç±»ç»§æ‰¿çˆ¶ç±»å°±ä¼šèŽ·å¾—çˆ¶ç±»çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œä½†çˆ¶ç±»çš„æ–¹æ³•ä¸èƒ½è®¿é—®å­ç±»çš„å®žä¾‹å˜é‡ï¼Œå› ä¸ºçˆ¶ç±»æ— æ³•çŸ¥é“å“ªä¸ªå­ç±»ç»§æ‰¿ä»– è€Œä¸”å­çˆ¶ç±»ä¸­çš„æˆå‘˜å˜é‡ï¼ˆç±»å˜é‡å’Œå®žä¾‹å˜é‡ï¼‰æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œçˆ¶ç±»ä¸­çš„æˆå‘˜å˜é‡ä¸ä¼šè¢«å­ç±»ä¸­åŒåçš„å˜é‡è¦†ç›– 123456789101112131415161718192021222324class Base &#123; static int count = 2;&#125;class Mid extends Base &#123; static int count = 20; &#125;public class Sub extends Mid &#123; static int count = 200; public static void main(String[] args) &#123; // åˆ›å»ºä¸€ä¸ªSubå¯¹è±¡ Sub s = new Sub(); // å°†Subå¯¹è±¡å‘ä¸Šè½¬åž‹åŽèµ‹ä¸ºMidã€Baseç±»åž‹çš„å˜é‡ Mid s2m = s; Base s2b = s; // åˆ†åˆ«é€šè¿‡3ä¸ªå˜é‡æ¥è®¿é—®countå®žä¾‹å˜é‡ System.out.println(s.count); System.out.println(s2m.count); System.out.println(s2b.count); &#125;&#125; ç»“æžœ 200202 å½“åˆ›å»ºSubçš„æ—¶å€™ï¼Œä¼šåˆå§‹åŒ–Baseã€Midå’ŒSubä¸‰ä¸ªå¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿå°±å­˜åœ¨ä¸‰ä¸ªcountå˜é‡äº†ï¼Œä¹Ÿå°±æ˜¯è¯´æœ‰ä¸‰å—å†…å­˜ä¿å­˜ç€è¿™ä¸‰ä¸ªå¯¹è±¡å’Œcountå˜é‡ï¼Œä»¥s2må˜é‡ä¸ºä¾‹ï¼Œs2mæ‹¥æœ‰çš„åœ°å€æ˜¯Subå¯¹è±¡çš„å †åœ°å€ï¼Œä½†s2må˜é‡ç±»æ˜¯æ˜¯Midï¼Œåˆ™ä¼šåŽ»å¯»æ‰¾Midä¸‹çš„å˜é‡å€¼ ä¹Ÿå°±è¯´æˆå‘˜å˜é‡çš„å€¼å–å†³äºŽå£°æ˜Žè¯¥å˜é‡å£°æ˜Žæ—¶æ˜¯æ‰€ç”¨çš„ç±»åž‹ è®¿é—®å­ç±»å¯¹è±¡çš„æ–¹æ³•å­ç±»å¯ä»¥é‡å†™çˆ¶ç±»çš„æ–¹æ³•ï¼Œå­ç±»ä¹Ÿå¯ä»¥é€šè¿‡superçš„æ–¹å¼è°ƒç”¨çˆ¶ç±»çš„æ–¹æ³•ï¼Œåœ¨å¤šæ€çš„æƒ…å†µä¸‹ï¼Œå­ç±»é‡å†™çš„æ–¹æ³•ä¼šè¦†ç›–æŽ‰çˆ¶ç±»çš„æ–¹æ³• 12345678910111213141516171819202122232425262728class Base&#123; int count =2; public void display()&#123; System.out.println(this.count); &#125;&#125;class Derived extends Base&#123; int count =20; @Override public void display() &#123; System.out.println(this.count); &#125;&#125;public class FieldAndMethod &#123; public static void main(String[] args) &#123; Base b=new Base(); System.out.println(b.count); b.display(); Derived d=new Derived(); System.out.println(d.count); d.display(); Base db=new Derived(); System.out.println(db.count); db.display(); Base b2d=d; System.out.println(b2d.count); &#125;&#125; ç»“æžœ 2220202202 ä¸€åˆ‡åœ¨ä½ æ‰§è¡Œè¿™æ®µä»£ç ä¹‹åŽï¼Œä½ å°±ä¼šæ˜Žç™½ä¸€åˆ‡äº†ã€‚]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaæ³›åž‹å…¨è§£æž]]></title>
    <url>%2F2016%2F05%2F25%2Fgeneric20160525%2F</url>
    <content type="text"><![CDATA[æŠŠä¸€ä¸ªå¯¹è±¡æ”¾è¿›é›†åˆä¸­ä¹‹åŽï¼Œé›†åˆå°±ä¼šå¿˜è®°è¿™ä¸ªå¯¹è±¡çš„æ•°æ®ç±»åž‹ï¼Œå½“å†æ¬¡å–å‡ºè¯¥å¯¹è±¡æ—¶ï¼Œè¯¥å¯¹è±¡çš„ç¼–è¯‘ç±»åž‹å°±å˜æˆObjectç±»åž‹äº† ä¸ºäº†è§£å†³ä¸Šé¢çš„é—®é¢˜ï¼Œå°±å¼•å‡ºäº†æ³›åž‹è¿™ä¸€ä¸ªæ¦‚å¿µ æ³›åž‹æŽ¥å£å’Œç±»12345678910111213141516171819202122public class Fruit&lt;T&gt; &#123; private T info; public Fruit(T info) &#123; this.info = info; &#125; public T getInfo() &#123; return info; &#125; public void setInfo(T info) &#123; this.info = info; &#125; public static void main(String[] args) &#123; Fruit&lt;String&gt; lt = new Fruit&lt;String&gt;("è‹¹æžœ"); System.out.println(lt.getInfo()); Fruit&lt;Integer&gt; intg = new Fruit&lt;Integer&gt;(1); System.out.println(intg.getInfo()); &#125;&#125; å¯ä»¥çµæ´»çš„å°è£…ï¼Œå¹¶ä¸”åŒæ—¶æœ‰å¯ä»¥é™å®šç±»åž‹ï¼Œæ³›åž‹çš„æŽ¥å£å’Œç±»æ›´åƒæ˜¯ä¸€ç§é€šç”¨çš„æ¨¡åž‹ï¼Œæ¨¡åž‹å†…éƒ¨çš„ç±»åž‹ç”±ä½¿ç”¨è€…è‡ªå·±é™å®š æ— è®ºä¸ºæ³›åž‹çš„ç±»åž‹å½¢å‚ä¼ å…¥å“ªä¸€ç§ç±»åž‹çš„å®žå‚ï¼Œå¯¹äºŽJavaæ¥è¯´ï¼Œä»–ä»¬ä¾ç„¶è¢«å½“æˆåŒä¸€ä¸ªç±»å¤„ç†ï¼Œåœ¨å†…å­˜ä¸­ä¹Ÿåªå ç”¨ä¸€å—å†…å­˜ç©ºé—´ï¼Œå› æ­¤åœ¨é™æ€æ–¹æ³•ã€é™æ€åˆå§‹åŒ–å—æˆ–è€…é™æ€å˜é‡çš„å£°æ˜Žå’Œåˆå§‹åŒ–ä¸­ä¸å…è®¸ä½¿ç”¨ç±»åž‹å½¢å‚ æ³›åž‹æŽ¥å£å’Œç±»çš„å­ç±»123456789101112public class Apple extends Fruit&lt;String&gt;&#123; public Apple(String info) &#123; super(info); &#125; @Override public String getInfo() &#123; return super.getInfo(); &#125;&#125; ä½¿ç”¨æ³›åž‹æŽ¥å£æˆ–ç±»çš„æ—¶å€™ï¼Œè™½ç„¶å¯ä»¥ä¸åŠ &lt;&gt;éƒ¨åˆ†ï¼Œä½†æ˜¯æŽ¨èåŠ ä¸Šï¼Œä¸ç„¶è¿˜è¦å¼ºåˆ¶ç±»åž‹è½¬æ¢ç­‰éº»çƒ¦æ“ä½œ é‡å†™çˆ¶ç±»æ–¹æ³•æˆ–è€…å®žçŽ°æŽ¥å£çš„æ—¶å€™ï¼Œè¿”å›žå€¼ä¸€å®šè¦è·Ÿçˆ¶ç±»ï¼ˆæŽ¥å£ï¼‰ä¸€è‡´ è®¾å®šç±»åž‹å½¢å‚çš„ä¸Šé™12345678910111213141516171819202122public class Fruit&lt;T extends String &amp; java.io.Serializable&gt; &#123; private T info; public Fruit(T info) &#123; this.info = info; &#125; public T getInfo() &#123; return info; &#125; public void setInfo(T info) &#123; this.info = info; &#125; public static void main(String[] args) &#123; Fruit&lt;String&gt; lt = new Fruit&lt;&gt;("è‹¹æžœ"); System.out.println(lt.getInfo()); Fruit&lt;?&gt; intg = new Fruit&lt;&gt;("1"); System.out.println(intg.getInfo()); &#125;&#125; å¯ä»¥æœ‰å¤šä¸ªé™å®šæ¡ä»¶ï¼Œå­˜åœ¨å¤šä¸ªé™å®šæ¡ä»¶çš„æ—¶å€™ï¼Œä½¿ç”¨&amp;è¿žæŽ¥ è‡³å¤šä¸€ä¸ªçˆ¶ç±»ä¸Šé™ï¼Œå¤šä¸ªæŽ¥å£ä¸Šé™ æŽ¥å£ä¸Šé™è¦åœ¨ç±»ä¸Šçº¿åŽé¢ ç±»åž‹é€šé…ç¬¦ä½¿ç”¨ç±»åž‹é€šé…ç¬¦çš„ç±»æ˜¯å„ç§è¯¥ç±»çš„æ³›åž‹çš„çˆ¶ç±» 12345678910111213141516171819202122public class Fruit&lt;T&gt; &#123; private T info; public Fruit(T info) &#123; this.info = info; &#125; public T getInfo() &#123; return info; &#125; public void setInfo(T info) &#123; this.info = info; &#125; public static void main(String[] args) &#123; Fruit&lt;String&gt; lt = new Fruit&lt;&gt;("è‹¹æžœ"); System.out.println(lt.getInfo()); Fruit&lt;?&gt; intg = new Fruit&lt;&gt;(1); System.out.println(intg.getInfo()); &#125;&#125; åœ¨Java 7ä»¥åŽå¯ä»¥ä½¿ç”¨è±å½¢è¯­æ³•ï¼Œåœ¨æž„é€ å™¨åŽä¸éœ€è¦å®Œæ•´çš„æ³›åž‹ä¿¡æ¯ â€œ?â€ç”¨äºŽæ“ä½œå…·ä½“çš„æŸä¸ªæ³›åž‹ç±»çš„æ—¶å€™ï¼Œè¿˜æœªç¡®å®šæœ€ç»ˆä½¿ç”¨æ—¶ï¼Œé‡‡ç”¨çš„å¯¹è±¡ç±»åž‹ï¼Œå°±ç”¨é—®å·ä½œä¸ºå ä½çš„å«ä¹‰ é€šé…ç¬¦çš„ä¸Šé™è®¾å®š1Fruit&lt;? extends String&gt; intg = new Fruit&lt;&gt;("1"); ä½¿ç”¨extendsçš„æ–¹å¼é™å®š?å¿…é¡»æ˜¯Stringç±»åž‹æˆ–è€…æ˜¯å…¶å­ç±»ç±»åž‹ é€šé…ç¬¦çš„ä¸‹é™è®¾å®š123static &lt;T,B&gt; void getCollection(Fruit&lt;? super T&gt;b)&#123; System.out.println(b);&#125; ä¸€å®šè¦æ˜¯Tæˆ–è€…Tçš„çˆ¶ç±» æ³›åž‹æ–¹æ³•12345ä¿®é¥°ç¬¦&lt;T,S&gt;è¿”å›žå€¼ç±»åž‹ æ–¹æ³•å(å½¢å‚åˆ—è¡¨)&#123; æ–¹æ³•ä½“&#125; 123static &lt;T,B&gt; void getCollection(B[]b,Collection&lt;T&gt; c)&#123; &#125; å¤šä¸ªç±»åž‹å½¢å‚ä¹‹é—´ç”¨é€—å·åˆ†éš” æ‰€æœ‰ç±»åž‹å½¢å‚å£°æ˜Žæ”¾åœ¨ä¿®é¥°ç¬¦å’Œæ–¹æ³•è¿”å›žç±»åž‹ä¹‹é—´ æ–¹æ³•ä¸­å®šä¹‰çš„ç±»åž‹å½¢å‚åªèƒ½åœ¨è¯¥æ–¹æ³•é‡Œä½¿ç”¨ï¼Œè€ŒæŽ¥å£æˆ–ç±»ä¸­å®šä¹‰çš„ç±»åž‹å½¢å‚å¯ä»¥åœ¨æ•´ä¸ªæŽ¥å£ã€ç±»ä¸­ä½¿ç”¨ æ–¹æ³•ä¸­çš„æ³›åž‹å‚æ•°æ— éœ€æ˜¾å¼ä¼ å…¥å®žé™…ç±»åž‹å‚æ•° 123456789101112131415161718192021public class Fruit&lt;T extends String &amp; java.io.Serializable&gt; &#123; private T info; public Fruit(T info) &#123; this.info = info; &#125; static &lt;T,B&gt; void getCollection(B[]b)&#123; System.out.println(b); &#125; public T getInfo() &#123; return info; &#125; public void setInfo(T info) &#123; this.info = info; &#125; public static void main(String[] args) &#123; Fruit.getCollection(new String[]&#123;"1"&#125;); &#125;&#125; å­˜åœ¨æ³›åž‹æž„é€ å™¨ï¼Œä¸èƒ½ä½¿ç”¨â€è±å½¢â€œè¯­æ³• 123public &lt;T&gt; Fruit(T info) &#123; System.out.println(info);&#125; æ³›åž‹æ–¹æ³•ä¸Žç±»åž‹é€šé…ç¬¦çš„åŒºåˆ« æ³›åž‹æ–¹æ³•å…è®¸ç±»åž‹å½¢å‚è¢«ç”¨æ¥è¡¨ç¤ºæ–¹æ³•çš„ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ä¹‹é—´çš„ç±»åž‹ä¾èµ–å…³ç³»ï¼Œæˆ–è€…æ–¹æ³•è¿”å›žå€¼ä¸Žå‚æ•°ä¹‹é—´çš„ç±»åž‹ä¾èµ–å…³ç³»ï¼Œå¦‚æžœæ²¡æœ‰è¿™æ ·çš„ç±»åž‹ä¾èµ–å…³ç³»ï¼Œå°±ä¸åº”è¯¥ä½¿ç”¨æ³›åž‹æ–¹æ³• ç±»åž‹é€šé…ç¬¦æ—¢å¯ä»¥åœ¨æ–¹æ³•ç­¾åä¸­å®šä¹‰å½¢å‚çš„ç±»åž‹ï¼Œä¹Ÿå¯ä»¥ç”¨äºŽå®šä¹‰å˜é‡ç±»åž‹ï¼Œä½†æ³›åž‹æ–¹æ³•ä¸­çš„ç±»åž‹å½¢å‚å¿…é¡»åœ¨å¯¹åº”æ–¹æ³•ä¸­æ˜¾å¼å£°æ˜Ž æ“¦é™¤å’Œè½¬æ¢æ“¦é™¤ å½“æŠŠä¸€ä¸ªå…·æœ‰æ³›åž‹ä¿¡æ¯çš„å¯¹è±¡èµ‹å€¼ç»™å¦ä¸€ä¸ªæ²¡æœ‰æ³›åž‹ä¿¡æ¯çš„å˜é‡æ—¶ï¼Œå°–æ‹¬å·ä¸­çš„æ³›åž‹ä¿¡æ¯å°±ä¼šè¢«æ“¦é™¤æ‰”æŽ‰ è½¬æ¢ å½“æŠŠä¸€ä¸ªæ²¡æœ‰æ³›åž‹ä¿¡æ¯çš„å¯¹è±¡èµ‹å€¼ç»™å¦ä¸€ä¸ªæ³›åž‹ä¿¡æ¯çš„å˜é‡æ—¶ï¼Œä¸ä¼šå‘ç”ŸæŠ¥é”™ï¼Œä¼šè‡ªåŠ¨è½¬æ¢]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaæžšä¸¾å…¨è§£æž]]></title>
    <url>%2F2016%2F05%2F25%2Fenum20150525%2F</url>
    <content type="text"><![CDATA[enumå…³é”®å­—ä¸Žclasså’Œinterfaceåœ°ä½ç›¸åŒï¼Œå…¶ä¸€æ ·æœ‰æˆå‘˜å˜é‡ã€æ–¹æ³•ã€å¯ä»¥å®žçŽ°ä¸€ä¸ªæˆ–å¤šä¸ªæŽ¥å£ï¼Œä¹Ÿå¯ä»¥æœ‰æž„é€ å™¨ æžšä¸¾ç±»ä¸Žæ™®é€šç±»çš„åŒºåˆ« æžšä¸¾ç±»çš„çˆ¶ç±»æ˜¯java.lang.Enumç±» éžæŠ½è±¡æžšä¸¾ç±»é»˜è®¤ä½¿ç”¨finalä¿®é¥°ï¼Œä¸èƒ½å­˜åœ¨å­ç±» æžšä¸¾ç±»çš„æž„é€ å™¨åªèƒ½ä½¿ç”¨privateä¿®é¥°ç¬¦ï¼Œé»˜è®¤å°±æ˜¯private æžšä¸¾ç±»çš„æ‰€æœ‰å®žä¾‹å¿…é¡»åœ¨æžšä¸¾ç±»çš„ç¬¬ä¸€è¡Œæ˜¾å¼åˆ—å‡ºï¼Œå¦åˆ™è¿™ä¸ªæžšä¸¾ç±»æ°¸è¿œä¸èƒ½äº§ç”Ÿå®žä¾‹ï¼Œåˆ—å‡ºçš„å®žä¾‹ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ·»åŠ public static finalä¿®é¥° æŠ½è±¡çš„æžšä¸¾ç±»ï¼Œç³»ç»Ÿé»˜è®¤ä½¿ç”¨abstractä¿®é¥°ï¼Œè€Œä¸ç”¨finalä¿®é¥° 1234567package com.em;public enum EmFestival &#123; //ä¼šäº§ç”Ÿå¦‚ä¸‹å››ä¸ªå®žä¾‹ SPRING,SUMMER,FALL,WINTER;&#125; æžšä¸¾å€¼å°±ä»£è¡¨å¯èƒ½ä¼šäº§ç”Ÿçš„å®žä¾‹ 123456789101112131415161718192021package com.em;public class FestivalTest &#123; public static String jude(EmFestival v)&#123; switch (v) &#123; case SPRING: return "æ˜¥å¤©"; case SUMMER: return "å¤å¤©"; case FALL: return "ç§‹å¤©"; case WINTER: return "å†¬å¤©"; &#125; return null; &#125; public static void main(String[] args) &#123; System.out.println(jude(EmFestival.SPRING)); &#125;&#125; ä¸ºä»€ä¹ˆä½¿ç”¨æžšä¸¾ç±»ï¼Ÿ å­˜åœ¨å‘½åç©ºé—´ï¼Œå¯ä»¥å°†å…¶ä»–çš„é™æ€å¸¸é‡åŒºåˆ†å¼€ æ‰“å°è¾“å‡ºçš„æ„ä¹‰æ˜Žç¡®ï¼Œä¸æƒ³æ™®é€šå¸¸é‡é‚£æ ·ï¼Œéƒ½ç”¨æ•°å­—è¡¨ç¤ºå«ä¹‰ï¼Œæ— æ³•ç›´æŽ¥è¡¨è¾¾å«ä¹‰ æžšä¸¾ç±»æ–¹æ³• compare(E o)ï¼šç”¨äºŽä¸ŽæŒ‡å®šçš„æžšä¸¾å¯¹è±¡æ¯”è¾ƒé¡ºåºï¼ŒåŒä¸€ä¸ªæžšä¸¾å®žä¾‹åªèƒ½ä¸Žç›¸åŒç±»åž‹çš„æžšä¸¾å®žä¾‹è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æžœè¯¥æžšä¸¾å¯¹è±¡ä½äºŽæŒ‡å®šæžšä¸¾å¯¹è±¡ä¹‹åŽï¼Œåˆ™è¿”å›žæ­£æ•´æ•° name()ï¼šè¿”å›žæ­¤æžšä¸¾å®žä¾‹çš„åç§° ordinal()ï¼šè¿”å›žæžšä¸¾å€¼åœ¨æžšä¸¾ç±»ä¸­çš„ç´¢å¼•å€¼ï¼ˆä»Ž0å¼€å§‹ï¼‰ toString()ï¼šä¸Žnameæ–¹æ³•ä¸€è‡´ï¼ŒæŽ¨èä½¿ç”¨toString valueOf()ï¼šä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œç”¨äºŽè¿”å›žæŒ‡å®šæžšä¸¾ç±»ä¸­æŒ‡å®šåç§°çš„æžšä¸¾å€¼ 123456789101112131415package com.em;public enum EmFestival &#123; //ä¼šäº§ç”Ÿå¦‚ä¸‹å››ä¸ªå®žä¾‹ SPRING("æ˜¥å¤©"),SUMMER("å¤å¤©"),FALL("ç§‹å¤©"),WINTER("å†¬å¤©"); private final String fest; private EmFestival(String fest)&#123; this.fest=fest; &#125; public String getFest() &#123; return fest; &#125; &#125; å®žçŽ°æŽ¥å£çš„æžšä¸¾ç±»æžšä¸¾ç±»å®žçŽ°æŽ¥å£ï¼Œä¸Žæ­£å¸¸ç±»æ²¡æœ‰ä»€ä¹ˆåŒºåˆ« 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576package com.em;import java.io.FileDescriptor;import java.io.IOException;import sun.nio.ch.SelChImpl;import sun.nio.ch.SelectionKeyImpl;public enum EmFestival implements SelChImpl&#123;// ä¼šäº§ç”Ÿå¦‚ä¸‹å››ä¸ªå®žä¾‹ SPRING("æ˜¥å¤©"),SUMMER("å¤å¤©"),FALL("ç§‹å¤©"),WINTER("å†¬å¤©"); @Override public boolean isOpen() &#123; // TODO Auto-generated method stub return false; &#125; @Override public void close() throws IOException &#123; // TODO Auto-generated method stub &#125; @Override public FileDescriptor getFD() &#123; // TODO Auto-generated method stub return null; &#125; @Override public int getFDVal() &#123; // TODO Auto-generated method stub return 0; &#125; @Override public void kill() throws IOException &#123; // TODO Auto-generated method stub &#125; @Override public void translateAndSetInterestOps(int arg0, SelectionKeyImpl arg1) &#123; // TODO Auto-generated method stub &#125; @Override public boolean translateAndSetReadyOps(int arg0, SelectionKeyImpl arg1) &#123; // TODO Auto-generated method stub return false; &#125; @Override public boolean translateAndUpdateReadyOps(int arg0, SelectionKeyImpl arg1) &#123; // TODO Auto-generated method stub return false; &#125; @Override public int validOps() &#123; // TODO Auto-generated method stub return 0; &#125; private final String fest; private EmFestival(String fest)&#123; this.fest=fest; &#125; public String getFest() &#123; return fest; &#125; &#125; åŒ…å«æŠ½è±¡æ–¹æ³•çš„æžšä¸¾ç±»æžšä¸¾ç±»é‡Œå®šä¹‰æŠ½è±¡æ–¹æ³•æ—¶ä¸èƒ½ä½¿ç”¨abstractå…³é”®å­—å°†æžšä¸¾ç±»å®šä¹‰æˆæŠ½è±¡ç±»ï¼ˆå› ä¸ºç³»ç»Ÿè‡ªåŠ¨ä¼šæ·»åŠ abastractï¼‰ï¼Œä½†å› ä¸ºæžšä¸¾ç±»éœ€è¦æ˜¾å¼åˆ›å»ºæžšä¸¾å€¼ï¼Œè€Œä¸æ˜¯ä½œä¸ºçˆ¶ç±»ï¼Œæ‰€ä»¥å®šä¹‰æ¯ä¸ªæžšä¸¾å€¼æ—¶å¿…é¡»ä¸ºæŠ½è±¡æ–¹æ³•æä¾›å®žçŽ°ï¼Œå¦åˆ™å‡ºçŽ°ç¼–è¯‘é”™è¯¯ 1234567891011121314151617181920212223242526272829303132333435363738394041package com.em;public enum EmFestival &#123; // ä¼šäº§ç”Ÿå¦‚ä¸‹å››ä¸ªå®žä¾‹ SPRING("æ˜¥å¤©") &#123; @Override public String getFestival() &#123; return "æ˜¥å¤©"; &#125; &#125;, SUMMER("å¤å¤©") &#123; @Override public String getFestival() &#123; return "å¤å¤©"; &#125; &#125;, FALL("ç§‹å¤©") &#123; @Override public String getFestival() &#123; return "ç§‹å¤©"; &#125; &#125;, WINTER("å†¬å¤©") &#123; @Override public String getFestival() &#123; return "å†¬å¤©"; &#125; &#125;; public abstract String getFestival(); private final String fest; private EmFestival(String fest) &#123; this.fest = fest; &#125; public String getFest() &#123; return fest; &#125;&#125;]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ¶ˆæ¯æŽ¨é€åŽŸç†]]></title>
    <url>%2F2016%2F05%2F20%2Fsendmessage20160520%2F</url>
    <content type="text"><![CDATA[æ¶ˆæ¯æ¨¡å¼å½’æ ¹ç»“åº•ï¼Œä¼ä¸šåº”ç”¨ç³»ç»Ÿå°±æ˜¯å¯¹æ•°æ®çš„å¤„ç†ï¼Œè€Œå¯¹äºŽä¸€ä¸ªæ‹¥æœ‰å¤šä¸ªå­ç³»ç»Ÿçš„ä¼ä¸šåº”ç”¨ç³»ç»Ÿè€Œè¨€ï¼Œå®ƒçš„åŸºç¡€æ”¯æ’‘æ— ç–‘å°±æ˜¯å¯¹æ¶ˆæ¯çš„å¤„ç†ã€‚ä¸Žå¯¹è±¡ä¸åŒï¼Œæ¶ˆæ¯æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ•°æ®ç»“æž„ï¼ˆå½“ç„¶ï¼Œå¯¹è±¡ä¹Ÿå¯ä»¥çœ‹åšæ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¶ˆæ¯ï¼‰ï¼Œå®ƒåŒ…å«æ¶ˆè´¹è€…ä¸ŽæœåŠ¡åŒæ–¹éƒ½èƒ½è¯†åˆ«çš„æ•°æ®ï¼Œè¿™äº›æ•°æ®éœ€è¦åœ¨ä¸åŒçš„è¿›ç¨‹ï¼ˆæœºå™¨ï¼‰ä¹‹é—´è¿›è¡Œä¼ é€’ï¼Œå¹¶å¯èƒ½ä¼šè¢«å¤šä¸ªå®Œå…¨ä¸åŒçš„å®¢æˆ·ç«¯æ¶ˆè´¹ã€‚æ¶ˆæ¯ä¼ é€’ç›¸è¾ƒæ–‡ä»¶ä¼ é€’ä¸Žè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼ˆRPCï¼‰è€Œè¨€ï¼Œä¼¼ä¹Žæ›´èƒœä¸€ç­¹ï¼Œå› ä¸ºå®ƒå…·æœ‰æ›´å¥½çš„å¹³å°æ— å…³æ€§ï¼Œå¹¶èƒ½å¤Ÿå¾ˆå¥½åœ°æ”¯æŒå¹¶å‘ä¸Žå¼‚æ­¥è°ƒç”¨ã€‚ å¯¹äºŽWeb Serviceä¸ŽRESTfulè€Œè¨€ï¼Œåˆ™å¯ä»¥çœ‹åšæ˜¯æ¶ˆæ¯ä¼ é€’æŠ€æœ¯çš„ä¸€ç§è¡ç”Ÿæˆ–å°è£…ã€‚ æ¶ˆæ¯ä¼ é€’æµç¨‹å‘èµ·è¯·æ±‚å°†æ¶ˆæ¯åºåˆ—åŒ–ä¼ é€’â†’æŽ¥å—è¯·æ±‚å°†æ¶ˆæ¯ååºåˆ—åŒ–â†’è¿”å›žç»“æžœç»™è¯·æ±‚ç«¯å°†æ¶ˆæ¯åºåˆ—åŒ–ä¼ é€’ æŒ‰ç…§ç½‘ç»œé€šä¿¡åŽŸç†ï¼Œéœ€è¦å®žçŽ°è¿™ä¸ªéœ€è¦åšçš„å°±æ˜¯å°†è¯·æ±‚è½¬æ¢æˆæµï¼Œé€šè¿‡ä¼ è¾“åè®®ä¼ è¾“è‡³è¿œç«¯ï¼Œè¿œç«¯è®¡ç®—æœºåœ¨æŽ¥æ”¶åˆ°è¯·æ±‚çš„æµåŽè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæ¯•åŽå°†ç»“æžœè½¬åŒ–ä¸ºæµï¼Œå¹¶é€šè¿‡ä¼ è¾“åè®®è¿”å›žç»™è°ƒç”¨ç«¯ã€‚ å¤„ç†æ¶ˆæ¯çš„æ–¹å¼ä¸€ç§æ–¹å¼æ˜¯å¹¿æ’­æœºåˆ¶ï¼Œè¿™æ—¶æ¶ˆæ¯é€šé“ä¸­çš„æ¶ˆæ¯åœ¨å‡ºåˆ—çš„åŒæ—¶ï¼Œè¿˜éœ€è¦å¤åˆ¶æ¶ˆæ¯å¯¹è±¡ï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™å¤šä¸ªè®¢é˜…è€…ã€‚ å¦ä¸€ç§æ–¹å¼åˆ™å±žäºŽæŠ¢å æœºåˆ¶ï¼Œå®ƒéµå¾ªåŒæ­¥æ–¹å¼ï¼Œåœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªè®¢é˜…è€…èƒ½å¤Ÿå¤„ç†è¯¥æ¶ˆæ¯ã€‚ æ¶ˆæ¯é€šé“ï¼ˆMessage Channelï¼‰æ¨¡å¼ å¹³å°æ— å…³æ€§ ç”Ÿäº§è€…ä¸Žæ¶ˆè´¹è€…åªè¦éµå®ˆæ¶ˆæ¯é€šé“çš„æ•°æ®ä¼ é€’æ ¼å¼ã€å¤„ç†æ¶ˆæ¯çš„æœºåˆ¶ä¸Žæ—¶æœºå°±å¯ä»¥äº† æ”¯æŒå¹¶å‘ æ¶ˆæ¯æ˜¯ä»¥é˜Ÿåˆ—çš„å½¢å¼å­˜åœ¨ï¼Œå…ˆè¿›å…ˆå‡ºï¼Œå¯ä»¥å¾ˆå¥½çš„ä¿è¯æ¶ˆæ¯çš„é¡ºç•… å¼‚æ­¥è°ƒç”¨ ç”Ÿäº§è€…ä¸Žæ¶ˆè´¹è€…ä¹‹é—´æ˜¯é€šè¿‡æ¶ˆæ¯é€šé“ï¼ˆMessage Channelï¼‰è¿žæŽ¥ï¼Œæ˜¯ä½Žè€¦åˆçš„ã€‚ ç‰¹ç‚¹ ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¿…é¡»çŸ¥é“é€šé“èµ„æºçš„ä½ç½®ï¼Œå¦åˆ™æ— æ³•çŸ¥é“ä»Žå“ªé‡Œå‘é€ï¼ˆæŽ¥å—ï¼‰æ¶ˆæ¯ï¼ˆè€ƒè™‘å¼•ç”¨LookupæœåŠ¡è¿›è¡ŒæŸ¥æ‰¾ï¼‰ ä»¥é˜Ÿåˆ—å½¢å¼å­˜åœ¨ï¼Œå…ˆè¿›å…ˆå‡º å¯ä»¥å­˜åœ¨å¤šä¸ªç”Ÿäº§è€…å’Œæ¶ˆè´¹è€… å…³é”®å­—è§£é‡ŠLookupæœåŠ¡ LookupæœåŠ¡æ˜¯ç”¨æ¥æŸ¥æ‰¾é€šé“èµ„æºï¼Œå¯ä»¥å°†ä¸Žé€šé“ç›¸å…³çš„ä¿¡æ¯å­˜å‚¨åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼ŒLookupæœåŠ¡é¦–å…ˆé€šè¿‡è¯»å–é…ç½®æ–‡ä»¶æ¥èŽ·å¾—é€šé“ã€‚åœ¨JMSä¸­å°±å¯ä»¥é€šè¿‡JNDIæ¥èŽ·å–æ¶ˆæ¯é€šé“Queueã€‚ å‘å¸ƒè€…-è®¢é˜…è€…ï¼ˆPublisher-Subscriberï¼‰æ¨¡å¼å‘å¸ƒè€…-è®¢é˜…è€…ï¼ˆPublisher-Subscriberï¼‰æ¨¡åž‹ä¸¤ç§æ¨¡åž‹çš„é€‰æ‹©ï¼šæ‹‰æ¨¡åž‹ä¸ŽæŽ¨æ¨¡åž‹ æ‹‰æ¨¡åž‹æ˜¯ç”±æ¶ˆæ¯çš„æ¶ˆè´¹è€…å‘èµ·çš„ï¼Œä¸»åŠ¨æƒæŠŠæ¡åœ¨æ¶ˆè´¹è€…æ‰‹ä¸­ï¼Œå®ƒä¼šæ ¹æ®è‡ªå·±çš„æƒ…å†µå¯¹ç”Ÿäº§è€…å‘èµ·è°ƒç”¨ã€‚ åœ¨åŸºäºŽæ¶ˆæ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæ‹‰æ¨¡åž‹çš„æ¶ˆè´¹è€…é€šå¸¸ä»¥Batch Jobçš„å½¢å¼ï¼Œæ ¹æ®äº‹å…ˆè®¾å®šçš„æ—¶é—´é—´éš”ï¼Œå®šæœŸä¾¦å¬é€šé“çš„æƒ…å†µã€‚ä¸€æ—¦å‘çŽ°æœ‰æ¶ˆæ¯ä¼ é€’è¿›æ¥ï¼Œå°±ä¼šè½¬è€Œå°†æ¶ˆæ¯ä¼ é€’ç»™çœŸæ­£çš„å¤„ç†å™¨ï¼ˆä¹Ÿå¯ä»¥çœ‹åšæ˜¯æ¶ˆè´¹è€…ï¼‰å¤„ç†æ¶ˆæ¯ï¼Œæ‰§è¡Œç›¸å…³çš„ä¸šåŠ¡ã€‚ æŽ¨æ¨¡åž‹çš„ä¸»åŠ¨æƒå¸¸å¸¸æŽŒæ¡åœ¨ç”Ÿäº§è€…æ‰‹ä¸­ï¼Œæ¶ˆè´¹è€…è¢«åŠ¨åœ°ç­‰å¾…ç”Ÿäº§è€…å‘å‡ºçš„é€šçŸ¥ï¼Œè¿™å°±è¦æ±‚ç”Ÿäº§è€…å¿…é¡»äº†è§£æ¶ˆè´¹è€…çš„ç›¸å…³ä¿¡æ¯ã€‚ å¯¹äºŽæŽ¨æ¨¡åž‹è€Œè¨€ï¼Œæ¶ˆè´¹è€…æ— éœ€äº†è§£ç”Ÿäº§è€…ã€‚åœ¨ç”Ÿäº§è€…é€šçŸ¥æ¶ˆè´¹è€…æ—¶ï¼Œä¼ é€’çš„å¾€å¾€æ˜¯æ¶ˆæ¯ï¼ˆæˆ–äº‹ä»¶ï¼‰ï¼Œè€Œéžç”Ÿäº§è€…è‡ªèº«ã€‚åŒæ—¶ï¼Œç”Ÿäº§è€…è¿˜å¯ä»¥æ ¹æ®ä¸åŒçš„æƒ…å†µï¼Œæ³¨å†Œä¸åŒçš„æ¶ˆè´¹è€…ï¼Œåˆæˆ–è€…åœ¨å°è£…çš„é€šçŸ¥é€»è¾‘ä¸­ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€å˜åŒ–ï¼Œé€šçŸ¥ä¸åŒçš„æ¶ˆè´¹è€…ã€‚ ç‰¹ç‚¹ å¹¿æ’­æœºåˆ¶ï¼Œè¿™æ—¶æ¶ˆæ¯é€šé“ä¸­çš„æ¶ˆæ¯åœ¨å‡ºåˆ—çš„åŒæ—¶ï¼Œè¿˜éœ€è¦å¤åˆ¶æ¶ˆæ¯å¯¹è±¡ï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™å¤šä¸ªè®¢é˜…è€… ç‚¹å¯¹ç‚¹P2Pæ¨¡åž‹ ç‰¹ç‚¹ å±žäºŽæŠ¢å æœºåˆ¶ï¼Œå®ƒéµå¾ªåŒæ­¥æ–¹å¼ï¼Œåœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªè®¢é˜…è€…èƒ½å¤Ÿå¤„ç†è¯¥æ¶ˆæ¯ã€‚ æ¶ˆæ¯è·¯ç”±ï¼ˆMessage Routerï¼‰æ¨¡å¼ æ— è®ºæ˜¯Message Channelæ¨¡å¼ï¼Œè¿˜æ˜¯Publisher-Subscriberæ¨¡å¼ï¼Œé˜Ÿåˆ—åœ¨å…¶ä¸­éƒ½æ‰®æ¼”äº†ä¸¾è¶³è½»é‡çš„è§’è‰²ã€‚ç„¶è€Œï¼Œåœ¨ä¼ä¸šåº”ç”¨ç³»ç»Ÿä¸­ï¼Œå½“ç³»ç»Ÿå˜å¾—è¶Šæ¥è¶Šå¤æ‚æ—¶ï¼Œå¯¹æ€§èƒ½çš„è¦æ±‚ä¹Ÿä¼šè¶Šæ¥è¶Šé«˜ï¼Œæ­¤æ—¶å¯¹äºŽç³»ç»Ÿè€Œè¨€ï¼Œå¯èƒ½å°±éœ€è¦æ”¯æŒåŒæ—¶éƒ¨ç½²å¤šä¸ªé˜Ÿåˆ—ï¼Œå¹¶å¯èƒ½è¦æ±‚åˆ†å¸ƒå¼éƒ¨ç½²ä¸åŒçš„é˜Ÿåˆ—ã€‚è¿™äº›é˜Ÿåˆ—å¯ä»¥æ ¹æ®å®šä¹‰æŽ¥æ”¶ä¸åŒçš„æ¶ˆæ¯ï¼Œä¾‹å¦‚è®¢å•å¤„ç†çš„æ¶ˆæ¯ï¼Œæ—¥å¿—ä¿¡æ¯ï¼ŒæŸ¥è¯¢ä»»åŠ¡æ¶ˆæ¯ç­‰ã€‚è¿™æ—¶ï¼Œå¯¹äºŽæ¶ˆæ¯çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…è€Œè¨€ï¼Œå¹¶ä¸é€‚å®œæ‰¿æ‹…å†³å®šæ¶ˆæ¯ä¼ é€’è·¯å¾„çš„èŒè´£ã€‚äº‹å®žä¸Šï¼Œæ ¹æ®Så•ä¸€èŒè´£åŽŸåˆ™ï¼Œè¿™ç§èŒè´£åˆ†é…ä¹Ÿæ˜¯ä¸åˆç†çš„ï¼Œå®ƒæ—¢ä¸åˆ©äºŽä¸šåŠ¡é€»è¾‘çš„é‡ç”¨ï¼Œä¹Ÿä¼šé€ æˆç”Ÿäº§è€…ã€æ¶ˆè´¹è€…ä¸Žæ¶ˆæ¯é˜Ÿåˆ—ä¹‹é—´çš„è€¦åˆï¼Œä»Žè€Œå½±å“ç³»ç»Ÿçš„æ‰©å±•ã€‚ æ—¢ç„¶è¿™ä¸‰ç§å¯¹è±¡ï¼ˆç»„ä»¶ï¼‰éƒ½ä¸å®œæ‰¿æ‹…è¿™æ ·çš„èŒè´£ï¼Œå°±æœ‰å¿…è¦å¼•å…¥ä¸€ä¸ªæ–°çš„å¯¹è±¡ä¸“é—¨è´Ÿè´£ä¼ é€’è·¯å¾„é€‰æ‹©çš„åŠŸèƒ½ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„Message Routeræ¨¡å¼ã€‚ é€šè¿‡æ¶ˆæ¯è·¯ç”±ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®è·¯ç”±è§„åˆ™æŒ‡å®šæ¶ˆæ¯ä¼ é€’çš„è·¯å¾„ï¼Œä»¥åŠæŒ‡å®šå…·ä½“çš„æ¶ˆè´¹è€…æ¶ˆè´¹å¯¹åº”çš„ç”Ÿäº§è€…ã€‚ä¾‹å¦‚æŒ‡å®šè·¯ç”±çš„å…³é”®å­—ï¼Œå¹¶ç”±å®ƒæ¥ç»‘å®šå…·ä½“çš„é˜Ÿåˆ—ä¸ŽæŒ‡å®šçš„ç”Ÿäº§è€…ï¼ˆæˆ–æ¶ˆè´¹è€…ï¼‰ã€‚è·¯ç”±çš„æ”¯æŒæä¾›äº†æ¶ˆæ¯ä¼ é€’ä¸Žå¤„ç†çš„çµæ´»æ€§ï¼Œä¹Ÿæœ‰åˆ©äºŽæé«˜æ•´ä¸ªç³»ç»Ÿçš„æ¶ˆæ¯å¤„ç†èƒ½åŠ›ã€‚åŒæ—¶ï¼Œè·¯ç”±å¯¹è±¡æœ‰æ•ˆåœ°å°è£…äº†å¯»æ‰¾ä¸ŽåŒ¹é…æ¶ˆæ¯è·¯å¾„çš„é€»è¾‘ï¼Œå°±å¥½ä¼¼ä¸€ä¸ªè°ƒåœè€…ï¼ˆMeditatorï¼‰ï¼Œè´Ÿè´£åè°ƒæ¶ˆæ¯ã€é˜Ÿåˆ—ä¸Žè·¯å¾„å¯»å€ä¹‹é—´å…³ç³»ã€‚ åº”ç”¨çº§åè®®ä¸ºäº†åº”ç”¨çš„æ–¹ä¾¿ï¼Œä¸šç•ŒæŽ¨å‡ºäº†å¾ˆå¤šåŸºäºŽæ­¤åŽŸç†ä¹‹ä¸Šçš„åº”ç”¨çº§çš„åè®®ï¼Œä½¿å¾—å¤§å®¶å¯ä»¥ä¸ç”¨åŽ»ç›´æŽ¥æ“ä½œè¿™ä¹ˆåº•å±‚çš„ä¸œè¥¿ï¼Œé€šå¸¸åº”ç”¨çº§çš„è¿œç¨‹é€šä¿¡åè®®ä¼šæä¾›ï¼š ä¸ºäº†é¿å…ç›´æŽ¥åšæµæ“ä½œè¿™ä¹ˆéº»çƒ¦ï¼Œæä¾›ä¸€ç§æ›´åŠ æ˜“ç”¨æˆ–è´´åˆè¯­è¨€çš„æ ‡å‡†ä¼ è¾“æ ¼å¼ï¼› ç½‘ç»œé€šä¿¡æœºåˆ¶çš„å®žçŽ°ï¼Œå°±æ˜¯æ›¿ä½ å®Œæˆäº†å°†ä¼ è¾“æ ¼å¼è½¬åŒ–ä¸ºæµï¼Œé€šè¿‡æŸç§ä¼ è¾“åè®®ä¼ è¾“è‡³è¿œç«¯è®¡ç®—æœºï¼Œè¿œç«¯è®¡ç®—æœºåœ¨æŽ¥æ”¶åˆ°æµåŽè½¬åŒ–ä¸ºä¼ è¾“æ ¼å¼ï¼Œå¹¶è¿›è¡Œå­˜å‚¨æˆ–ä»¥æŸç§æ–¹å¼é€šçŸ¥è¿œç«¯è®¡ç®—æœºã€‚ åœ¨å­¦ä¹ åº”ç”¨çº§çš„è¿œç¨‹é€šä¿¡åè®®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å¸¦ç€è¿™å‡ ä¸ªé—®é¢˜è¿›è¡Œå­¦ä¹ ï¼š ä¼ è¾“çš„æ ‡å‡†æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿ æ€Žä¹ˆæ ·å°†è¯·æ±‚è½¬åŒ–ä¸ºä¼ è¾“çš„æµï¼Ÿ æ€Žä¹ˆæŽ¥æ”¶å’Œå¤„ç†æµï¼Ÿ ä¼ è¾“åè®®æ˜¯ï¼Ÿ ä¸è¿‡åº”ç”¨çº§çš„è¿œç¨‹é€šä¿¡åè®®å¹¶ä¸ä¼šåœ¨ä¼ è¾“åè®®ä¸Šåšä»€ä¹ˆå¤šå¤§çš„æ”¹è¿›ï¼Œä¸»è¦æ˜¯åœ¨æµæ“ä½œæ–¹é¢ï¼Œè®©åº”ç”¨å±‚ç”Ÿæˆæµå’Œå¤„ç†æµçš„è¿™ä¸ªè¿‡ç¨‹æ›´åŠ çš„è´´åˆæ‰€ä½¿ç”¨çš„è¯­è¨€æˆ–æ ‡å‡†ï¼Œè‡³äºŽä¼ è¾“åè®®åˆ™é€šå¸¸éƒ½æ˜¯å¯é€‰çš„ï¼Œåœ¨javaé¢†åŸŸä¸­çŸ¥åçš„æœ‰ï¼šRMIã€XML-RPCã€Binary-RPCã€SOAPã€CORBAã€JMSã€HTTPï¼Œæ¥å…·ä½“çš„çœ‹çœ‹è¿™äº›è¿œç¨‹é€šä¿¡çš„åº”ç”¨çº§åè®®ã€‚ RMIï¼ˆè¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼‰ RMIæ˜¯ä¸ªå…¸åž‹çš„ä¸ºjavaå®šåˆ¶çš„è¿œç¨‹é€šä¿¡åè®®ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“ï¼Œåœ¨single vmä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç›´æŽ¥è°ƒç”¨java object instanceæ¥å®žçŽ°é€šä¿¡ï¼Œé‚£ä¹ˆåœ¨è¿œç¨‹é€šä¿¡æ—¶ï¼Œå¦‚æžœä¹Ÿèƒ½æŒ‰ç…§è¿™ç§æ–¹å¼å½“ç„¶æ˜¯æœ€å¥½äº†ï¼Œè¿™ç§è¿œç¨‹é€šä¿¡çš„æœºåˆ¶æˆä¸ºRPCï¼ˆRemote Procedure Callï¼‰ï¼ŒRMIæ­£æ˜¯æœç€è¿™ä¸ªç›®æ ‡è€Œè¯žç”Ÿçš„ã€‚ RMI é‡‡ç”¨stubs å’Œ skeletons æ¥è¿›è¡Œè¿œç¨‹å¯¹è±¡(remote object)çš„é€šè®¯ã€‚stub å……å½“è¿œç¨‹å¯¹è±¡çš„å®¢æˆ·ç«¯ä»£ç†ï¼Œæœ‰ç€å’Œè¿œç¨‹å¯¹è±¡ç›¸åŒçš„è¿œç¨‹æŽ¥å£ï¼Œè¿œç¨‹å¯¹è±¡çš„è°ƒç”¨å®žé™…æ˜¯é€šè¿‡è°ƒç”¨è¯¥å¯¹è±¡çš„å®¢æˆ·ç«¯ä»£ç†å¯¹è±¡stubæ¥å®Œæˆçš„ï¼Œé€šè¿‡è¯¥æœºåˆ¶RMIå°±å¥½æ¯”å®ƒæ˜¯æœ¬åœ°å·¥ä½œï¼Œé‡‡ç”¨tcp/ipåè®®ï¼Œå®¢æˆ·ç«¯ç›´æŽ¥è°ƒç”¨æœåŠ¡ç«¯ä¸Šçš„ä¸€äº›æ–¹æ³•ã€‚ä¼˜ç‚¹æ˜¯å¼ºç±»åž‹ï¼Œç¼–è¯‘æœŸå¯æ£€æŸ¥é”™è¯¯ï¼Œç¼ºç‚¹æ˜¯åªèƒ½åŸºäºŽJAVAè¯­è¨€ï¼Œå®¢æˆ·æœºä¸ŽæœåŠ¡å™¨ç´§è€¦åˆã€‚ æ¥çœ‹ä¸‹åŸºäºŽRMIçš„ä¸€æ¬¡å®Œæ•´çš„è¿œç¨‹é€šä¿¡è¿‡ç¨‹çš„åŽŸç†ï¼š å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼Œè¯·æ±‚è½¬äº¤è‡³RMIå®¢æˆ·ç«¯çš„stubç±»ï¼› stubç±»å°†è¯·æ±‚çš„æŽ¥å£ã€æ–¹æ³•ã€å‚æ•°ç­‰ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–ï¼› åŸºäºŽsocketå°†åºåˆ—åŒ–åŽçš„æµä¼ è¾“è‡³æœåŠ¡å™¨ç«¯ï¼› æœåŠ¡å™¨ç«¯æŽ¥æ”¶åˆ°æµåŽè½¬å‘è‡³ç›¸åº”çš„skeltonç±»ï¼› skeltonç±»å°†è¯·æ±‚çš„ä¿¡æ¯ååºåˆ—åŒ–åŽè°ƒç”¨å®žé™…çš„å¤„ç†ç±»ï¼› å¤„ç†ç±»å¤„ç†å®Œæ¯•åŽå°†ç»“æžœè¿”å›žç»™skeltonç±»ï¼› Skeltonç±»å°†ç»“æžœåºåˆ—åŒ–ï¼Œé€šè¿‡socketå°†æµä¼ é€ç»™å®¢æˆ·ç«¯çš„stubï¼› stubåœ¨æŽ¥æ”¶åˆ°æµåŽååºåˆ—åŒ–ï¼Œå°†ååºåˆ—åŒ–åŽçš„Java Objectè¿”å›žç»™è°ƒç”¨è€…ã€‚ æ ¹æ®åŽŸç†æ¥å›žç­”ä¸‹ä¹‹å‰å­¦ä¹ åº”ç”¨çº§åè®®å¸¦ç€çš„å‡ ä¸ªé—®é¢˜ï¼š ä¼ è¾“çš„æ ‡å‡†æ ¼å¼æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯Java ObjectStreamã€‚ æ€Žä¹ˆæ ·å°†è¯·æ±‚è½¬åŒ–ä¸ºä¼ è¾“çš„æµï¼ŸåŸºäºŽJavaä¸²è¡ŒåŒ–æœºåˆ¶å°†è¯·æ±‚çš„java objectä¿¡æ¯è½¬åŒ–ä¸ºæµã€‚ æ€Žä¹ˆæŽ¥æ”¶å’Œå¤„ç†æµï¼Ÿæ ¹æ®é‡‡ç”¨çš„åè®®å¯åŠ¨ç›¸åº”çš„ç›‘å¬ç«¯å£ï¼Œå½“æœ‰æµè¿›å…¥åŽåŸºäºŽJavaä¸²è¡ŒåŒ–æœºåˆ¶å°†æµè¿›è¡Œååºåˆ—åŒ–ï¼Œå¹¶æ ¹æ®RMIåè®®èŽ·å–åˆ°ç›¸åº”çš„å¤„ç†å¯¹è±¡ä¿¡æ¯ï¼Œè¿›è¡Œè°ƒç”¨å¹¶å¤„ç†ï¼Œå¤„ç†å®Œæ¯•åŽçš„ç»“æžœåŒæ ·åŸºäºŽjavaä¸²è¡ŒåŒ–æœºåˆ¶è¿›è¡Œè¿”å›žã€‚ ä¼ è¾“åè®®æ˜¯ï¼ŸSocketã€‚ XML-RPC RPCä½¿ç”¨C/Sæ–¹å¼ï¼Œé‡‡ç”¨httpåè®®ï¼Œå‘é€è¯·æ±‚åˆ°æœåŠ¡å™¨ï¼Œç­‰å¾…æœåŠ¡å™¨è¿”å›žç»“æžœã€‚è¿™ä¸ªè¯·æ±‚åŒ…æ‹¬ä¸€ä¸ªå‚æ•°é›†å’Œä¸€ä¸ªæ–‡æœ¬é›†ï¼Œé€šå¸¸å½¢æˆâ€œclassname.methodnameâ€å½¢å¼ã€‚ä¼˜ç‚¹æ˜¯è·¨è¯­è¨€è·¨å¹³å°ï¼ŒCç«¯ã€Sç«¯æœ‰æ›´å¤§çš„ç‹¬ç«‹æ€§ï¼Œç¼ºç‚¹æ˜¯ä¸æ”¯æŒå¯¹è±¡ï¼Œæ— æ³•åœ¨ç¼–è¯‘å™¨æ£€æŸ¥é”™è¯¯ï¼Œåªèƒ½åœ¨è¿è¡ŒæœŸæ£€æŸ¥ã€‚ XML-RPCä¹Ÿæ˜¯ä¸€ç§å’ŒRMIç±»ä¼¼çš„è¿œç¨‹è°ƒç”¨çš„åè®®ï¼Œå®ƒå’ŒRMIçš„ä¸åŒä¹‹å¤„åœ¨äºŽå®ƒä»¥æ ‡å‡†çš„xmlæ ¼å¼æ¥å®šä¹‰è¯·æ±‚çš„ä¿¡æ¯(è¯·æ±‚çš„å¯¹è±¡ã€æ–¹æ³•ã€å‚æ•°ç­‰)ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯ä»€ä¹ˆå‘¢ï¼Œå°±æ˜¯åœ¨è·¨è¯­è¨€é€šè®¯çš„æ—¶å€™ä¹Ÿå¯ä»¥ä½¿ç”¨ã€‚ æ¥çœ‹ä¸‹XML-RPCåè®®çš„ä¸€æ¬¡è¿œç¨‹é€šä¿¡è¿‡ç¨‹ï¼š å®¢æˆ·ç«¯å‘èµ·è¯·æ±‚ï¼ŒæŒ‰ç…§XML-RPCåè®®å°†è¯·æ±‚ä¿¡æ¯è¿›è¡Œå¡«å……ï¼› å¡«å……å®Œæ¯•åŽå°†xmlè½¬åŒ–ä¸ºæµï¼Œé€šè¿‡ä¼ è¾“åè®®è¿›è¡Œä¼ è¾“ï¼› æŽ¥æ”¶åˆ°åœ¨æŽ¥æ”¶åˆ°æµåŽè½¬æ¢ä¸ºxmlï¼ŒæŒ‰ç…§XML-RPCåè®®èŽ·å–è¯·æ±‚çš„ä¿¡æ¯å¹¶è¿›è¡Œå¤„ç†ï¼› å¤„ç†å®Œæ¯•åŽå°†ç»“æžœæŒ‰ç…§XML-RPCåè®®å†™å…¥xmlä¸­å¹¶è¿”å›žã€‚ åŒæ ·æ¥å›žç­”é—®é¢˜ï¼š ä¼ è¾“çš„æ ‡å‡†æ ¼å¼æ˜¯ï¼Ÿæ ‡å‡†æ ¼å¼çš„XMLã€‚ æ€Žä¹ˆæ ·å°†è¯·æ±‚è½¬åŒ–ä¸ºä¼ è¾“çš„æµï¼Ÿå°†XMLè½¬åŒ–ä¸ºæµã€‚ æ€Žä¹ˆæŽ¥æ”¶å’Œå¤„ç†æµï¼Ÿé€šè¿‡ç›‘å¬çš„ç«¯å£èŽ·å–åˆ°è¯·æ±‚çš„æµï¼Œè½¬åŒ–ä¸ºXMLï¼Œå¹¶æ ¹æ®åè®®èŽ·å–è¯·æ±‚çš„ä¿¡æ¯ï¼Œè¿›è¡Œå¤„ç†å¹¶å°†ç»“æžœå†™å…¥XMLä¸­è¿”å›žã€‚ ä¼ è¾“åè®®æ˜¯ï¼ŸHttpã€‚ Binary-RPC Binary-RPCçœ‹åå­—å°±çŸ¥é“å’ŒXML-RPCæ˜¯å·®ä¸å¤šçš„äº†ï¼Œä¸åŒä¹‹å¤„ä»…åœ¨äºŽä¼ è¾“çš„æ ‡å‡†æ ¼å¼ç”±XMLè½¬ä¸ºäº†äºŒè¿›åˆ¶çš„æ ¼å¼ã€‚ åŒæ ·æ¥å›žç­”é—®é¢˜ï¼š ä¼ è¾“çš„æ ‡å‡†æ ¼å¼æ˜¯ï¼Ÿæ ‡å‡†æ ¼å¼çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ æ€Žä¹ˆæ ·å°†è¯·æ±‚è½¬åŒ–ä¸ºä¼ è¾“çš„æµï¼Ÿå°†äºŒè¿›åˆ¶æ ¼å¼æ–‡ä»¶è½¬åŒ–ä¸ºæµã€‚ æ€Žä¹ˆæŽ¥æ”¶å’Œå¤„ç†æµï¼Ÿé€šè¿‡ç›‘å¬çš„ç«¯å£èŽ·å–åˆ°è¯·æ±‚çš„æµï¼Œè½¬åŒ–ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ ¹æ®åè®®èŽ·å–è¯·æ±‚çš„ä¿¡æ¯ï¼Œè¿›è¡Œå¤„ç†å¹¶å°†ç»“æžœå†™å…¥XMLä¸­è¿”å›žã€‚ ä¼ è¾“åè®®æ˜¯ï¼ŸHttpã€‚ SOAP SOAPåŽŸæ„ä¸ºSimple Object Access Protocolï¼Œæ˜¯ä¸€ä¸ªç”¨äºŽåˆ†å¸ƒå¼çŽ¯å¢ƒçš„ã€è½»é‡çº§çš„ã€åŸºäºŽXMLè¿›è¡Œä¿¡æ¯äº¤æ¢çš„é€šä¿¡åè®®ï¼Œå¯ä»¥è®¤ä¸ºSOAPæ˜¯XML RPCçš„é«˜çº§ç‰ˆï¼Œä¸¤è€…çš„åŽŸç†å®Œå…¨ç›¸åŒï¼Œéƒ½æ˜¯http+XMLï¼Œä¸åŒçš„ä»…åœ¨äºŽä¸¤è€…å®šä¹‰çš„XMLè§„èŒƒä¸åŒï¼ŒSOAPä¹Ÿæ˜¯Webserviceé‡‡ç”¨çš„æœåŠ¡è°ƒç”¨åè®®æ ‡å‡†ï¼Œå› æ­¤åœ¨æ­¤å°±ä¸å¤šåŠ é˜è¿°äº†ã€‚ Web Serviceæä¾›çš„æœåŠ¡æ˜¯åŸºäºŽwebå®¹å™¨çš„ï¼Œåº•å±‚ä½¿ç”¨httpåè®®ï¼Œç±»ä¼¼ä¸€ä¸ªè¿œç¨‹çš„æœåŠ¡æä¾›è€…ï¼Œæ¯”å¦‚å¤©æ°”é¢„æŠ¥æœåŠ¡ï¼Œå¯¹å„åœ°å®¢æˆ·ç«¯æä¾›å¤©æ°”é¢„æŠ¥ï¼Œæ˜¯ä¸€ç§è¯·æ±‚åº”ç­”çš„æœºåˆ¶ï¼Œæ˜¯è·¨ç³»ç»Ÿè·¨å¹³å°çš„ã€‚å°±æ˜¯é€šè¿‡ä¸€ä¸ªservletï¼Œæä¾›æœåŠ¡å‡ºåŽ»ã€‚ é¦–å…ˆå®¢æˆ·ç«¯ä»ŽæœåŠ¡å™¨èŽ·å¾—WebServiceçš„WSDLï¼ŒåŒæ—¶åœ¨å®¢æˆ·ç«¯ç”Ÿæˆä¸€ä¸ªä»£ç†ç±»(Proxy Class)ï¼Œè¿™ä¸ªä»£ç†ç±»è´Ÿè´£ä¸ŽWebServiceæœåŠ¡å™¨è¿›è¡ŒRequestå’ŒResponseã€‚å½“ä¸€ä¸ªæ•°æ®ï¼ˆXMLæ ¼å¼çš„ï¼‰è¢«å°è£…æˆSOAPæ ¼å¼çš„æ•°æ®æµå‘é€åˆ°æœåŠ¡å™¨ç«¯çš„æ—¶å€™ï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªè¿›ç¨‹å¯¹è±¡å¹¶ä¸”æŠŠæŽ¥æ”¶åˆ°è¿™ä¸ªRequestçš„SOAPåŒ…è¿›è¡Œè§£æžï¼Œç„¶åŽå¯¹äº‹ç‰©è¿›è¡Œå¤„ç†ï¼Œå¤„ç†ç»“æŸä»¥åŽå†å¯¹è¿™ä¸ªè®¡ç®—ç»“æžœè¿›è¡ŒSOAPåŒ…è£…ï¼Œç„¶åŽæŠŠè¿™ä¸ªåŒ…ä½œä¸ºä¸€ä¸ªResponseå‘é€ç»™å®¢æˆ·ç«¯çš„ä»£ç†ç±»(Proxy Class)ï¼ŒåŒæ ·åœ°ï¼Œè¿™ä¸ªä»£ç†ç±»ä¹Ÿå¯¹è¿™ä¸ªSOAPåŒ…è¿›è¡Œè§£æžå¤„ç†ï¼Œç»§è€Œè¿›è¡ŒåŽç»­æ“ä½œã€‚è¿™å°±æ˜¯WebServiceçš„ä¸€ä¸ªè¿è¡Œè¿‡ç¨‹ã€‚ Web Serviceå¤§ä½“ä¸Šåˆ†ä¸º5ä¸ªå±‚æ¬¡: Httpä¼ è¾“ä¿¡é“ï¼›XMLçš„æ•°æ®æ ¼å¼ï¼›SOAPå°è£…æ ¼å¼ï¼›WSDLçš„æè¿°æ–¹å¼ï¼›UDDI UDDIæ˜¯ä¸€ç§ç›®å½•æœåŠ¡ï¼Œä¼ä¸šå¯ä»¥ä½¿ç”¨å®ƒå¯¹Webservicesè¿›è¡Œæ³¨å†Œå’Œæœç´¢ï¼› JMS JMSæ˜¯å®žçŽ°javaé¢†åŸŸè¿œç¨‹é€šä¿¡çš„ä¸€ç§æ‰‹æ®µå’Œæ–¹æ³•ï¼ŒåŸºäºŽJMSå®žçŽ°è¿œç¨‹é€šä¿¡æ—¶å’ŒRPCæ˜¯ä¸åŒçš„ï¼Œè™½ç„¶å¯ä»¥åšåˆ°RPCçš„æ•ˆæžœï¼Œä½†å› ä¸ºä¸æ˜¯ä»Žåè®®çº§åˆ«å®šä¹‰çš„ï¼Œå› æ­¤æˆ‘ä»¬ä¸è®¤ä¸ºJMSæ˜¯ä¸ªRPCåè®®ï¼Œä½†å®ƒç¡®å®žæ˜¯ä¸ªè¿œç¨‹é€šä¿¡åè®®ï¼Œåœ¨å…¶ä»–çš„è¯­è¨€ä½“ç³»ä¸­ä¹Ÿå­˜åœ¨ç€ç±»ä¼¼JMSçš„ä¸œè¥¿ï¼Œå¯ä»¥ç»Ÿä¸€çš„å°†è¿™ç±»æœºåˆ¶ç§°ä¸ºæ¶ˆæ¯æœºåˆ¶ï¼Œè€Œæ¶ˆæ¯æœºåˆ¶å‘¢ï¼Œé€šå¸¸æ˜¯é«˜å¹¶å‘ã€åˆ†å¸ƒå¼é¢†åŸŸæŽ¨èçš„ä¸€ç§é€šä¿¡æœºåˆ¶ï¼Œè¿™é‡Œçš„ä¸»è¦ä¸€ä¸ªé—®é¢˜æ˜¯å®¹é”™ã€‚ JMSæ˜¯Javaçš„æ¶ˆæ¯æœåŠ¡ï¼ŒJMSçš„å®¢æˆ·ç«¯ä¹‹é—´å¯ä»¥é€šè¿‡JMSæœåŠ¡è¿›è¡Œå¼‚æ­¥çš„æ¶ˆæ¯ä¼ è¾“ã€‚JMSæ”¯æŒä¸¤ç§æ¶ˆæ¯æ¨¡åž‹ï¼šPoint-to-Pointï¼ˆP2Pï¼‰å’ŒPublish/Subscribeï¼ˆPub/Subï¼‰ï¼Œå³ç‚¹å¯¹ç‚¹å’Œå‘å¸ƒè®¢é˜…æ¨¡åž‹ã€‚ æ¥çœ‹JMSä¸­çš„ä¸€æ¬¡è¿œç¨‹é€šä¿¡çš„è¿‡ç¨‹ï¼š å®¢æˆ·ç«¯å°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆJMSè§„å®šçš„Messageï¼› é€šè¿‡JMS APIå°†Messageæ”¾å…¥JMS Queueæˆ–Topicä¸­ï¼› å¦‚ä¸ºJMS Queueï¼Œåˆ™å‘é€ä¸­ç›¸åº”çš„ç›®æ ‡Queueä¸­ï¼Œå¦‚ä¸ºTopicï¼Œåˆ™å‘é€ç»™è®¢é˜…äº†æ­¤Topicçš„JMS Queueã€‚ å¤„ç†ç«¯åˆ™é€šè¿‡è½®è®­JMS Queueï¼Œæ¥èŽ·å–æ¶ˆæ¯ï¼ŒæŽ¥æ”¶åˆ°æ¶ˆæ¯åŽæ ¹æ®JMSåè®®æ¥è§£æžMessageå¹¶å¤„ç†ã€‚ åŒæ ·æ¥å›žç­”é—®é¢˜ï¼š ä¼ è¾“çš„æ ‡å‡†æ ¼å¼æ˜¯ï¼ŸJMSè§„å®šçš„Messageã€‚ æ€Žä¹ˆæ ·å°†è¯·æ±‚è½¬åŒ–ä¸ºä¼ è¾“çš„æµï¼Ÿå°†å‚æ•°ä¿¡æ¯æ”¾å…¥Messageä¸­å³å¯ã€‚ æ€Žä¹ˆæŽ¥æ”¶å’Œå¤„ç†æµï¼Ÿè½®è®­JMS Queueæ¥æŽ¥æ”¶Messageï¼ŒæŽ¥æ”¶åˆ°åŽè¿›è¡Œå¤„ç†ï¼Œå¤„ç†å®Œæ¯•åŽä»ç„¶æ˜¯ä»¥Messageçš„æ–¹å¼æ”¾å…¥Queueä¸­å‘é€æˆ–Multicastã€‚ ä¼ è¾“åè®®æ˜¯ï¼Ÿä¸é™ã€‚ åŸºäºŽJMSä¹Ÿæ˜¯å¸¸ç”¨çš„å®žçŽ°è¿œç¨‹å¼‚æ­¥è°ƒç”¨çš„æ–¹æ³•ä¹‹ä¸€ã€‚ ä¹‹é—´çš„åŒºåˆ«RPCä¸ŽRMI RPCè·¨è¯­è¨€ï¼Œè€ŒRMIåªæ”¯æŒJavaã€‚ RMIè°ƒç”¨è¿œç¨‹å¯¹è±¡æ–¹æ³•ï¼Œå…è®¸æ–¹æ³•è¿”å›žJavaå¯¹è±¡ä»¥åŠåŸºæœ¬æ•°æ®ç±»åž‹ï¼Œè€ŒRPCä¸æ”¯æŒå¯¹è±¡çš„æ¦‚å¿µï¼Œä¼ é€åˆ°RPCæœåŠ¡çš„æ¶ˆæ¯ç”±å¤–éƒ¨æ•°æ®è¡¨ç¤º (External Data Representation, XDR) è¯­è¨€è¡¨ç¤ºï¼Œè¿™ç§è¯­è¨€æŠ½è±¡äº†å­—èŠ‚åºç±»å’Œæ•°æ®ç±»åž‹ç»“æž„ä¹‹é—´çš„å·®å¼‚ã€‚åªæœ‰ç”± XDR å®šä¹‰çš„æ•°æ®ç±»åž‹æ‰èƒ½è¢«ä¼ é€’ï¼Œå¯ä»¥è¯´ RMI æ˜¯é¢å‘å¯¹è±¡æ–¹å¼çš„Java RPCã€‚ åœ¨æ–¹æ³•è°ƒç”¨ä¸Šï¼ŒRMIä¸­ï¼Œè¿œç¨‹æŽ¥å£ä½¿æ¯ä¸ªè¿œç¨‹æ–¹æ³•éƒ½å…·æœ‰æ–¹æ³•ç­¾åã€‚å¦‚æžœä¸€ä¸ªæ–¹æ³•åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œï¼Œä½†æ˜¯æ²¡æœ‰ç›¸åŒ¹é…çš„ç­¾åè¢«æ·»åŠ åˆ°è¿™ä¸ªè¿œç¨‹æŽ¥å£ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°æ–¹æ³•å°±ä¸èƒ½è¢«RMIå®¢æˆ·æ–¹æ‰€è°ƒç”¨ã€‚åœ¨RPCä¸­ï¼Œå½“ä¸€ä¸ªè¯·æ±‚åˆ°è¾¾RPCæœåŠ¡å™¨æ—¶ï¼Œè¿™ä¸ªè¯·æ±‚å°±åŒ…å«äº†ä¸€ä¸ªå‚æ•°é›†å’Œä¸€ä¸ªæ–‡æœ¬å€¼ï¼Œé€šå¸¸å½¢æˆâ€œclassname.methodnameâ€çš„å½¢å¼ã€‚è¿™å°±å‘RPCæœåŠ¡å™¨è¡¨æ˜Žï¼Œè¢«è¯·æ±‚çš„æ–¹æ³•åœ¨ä¸º â€œclassnameâ€çš„ç±»ä¸­ï¼Œåå«â€œmethodnameâ€ã€‚ç„¶åŽRPCæœåŠ¡å™¨å°±åŽ»æœç´¢ä¸Žä¹‹ç›¸åŒ¹é…çš„ç±»å’Œæ–¹æ³•ï¼Œå¹¶æŠŠå®ƒä½œä¸ºé‚£ç§æ–¹æ³•å‚æ•°ç±»åž‹çš„è¾“å…¥ã€‚è¿™é‡Œçš„å‚æ•°ç±»åž‹æ˜¯ä¸ŽRPCè¯·æ±‚ä¸­çš„ç±»åž‹æ˜¯åŒ¹é…çš„ã€‚ä¸€æ—¦åŒ¹é…æˆåŠŸï¼Œè¿™ä¸ªæ–¹æ³•å°±è¢«è°ƒç”¨äº†ï¼Œå…¶ç»“æžœè¢«ç¼–ç åŽè¿”å›žå®¢æˆ·æ–¹ã€‚ RPCæœ¬èº«æ²¡æœ‰è§„èŒƒ,ä½†åŸºæœ¬çš„å·¥ä½œæœºåˆ¶æ˜¯ä¸€æ ·çš„ï¼Œå³ï¼šserialization/deserialization+stub+skeletonï¼Œå®½æ³›çš„è®²ï¼Œåªè¦èƒ½å®žçŽ°è¿œç¨‹è°ƒç”¨ï¼Œéƒ½æ˜¯RPCï¼Œå¦‚:rmi .net-remoting ws/soap/rest hessian xmlrpc thrift potocolbufferã€‚ åœ¨Javaé‡Œæä¾›äº†å®Œæ•´çš„socketsé€šè®¯æŽ¥å£ï¼Œä½†socketsè¦æ±‚å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å¿…é¡»è¿›è¡Œåº”ç”¨çº§åè®®çš„ç¼–ç äº¤æ¢æ•°æ®ï¼Œé‡‡ç”¨socketsæ˜¯éžå¸¸éº»çƒ¦çš„ã€‚ä¸€ä¸ªä»£æ›¿Socketsçš„åè®®æ˜¯RPC(Remote Procedure Call), å®ƒæŠ½è±¡å‡ºäº†é€šè®¯æŽ¥å£ç”¨äºŽè¿‡ç¨‹è°ƒç”¨ï¼Œä½¿å¾—ç¼–ç¨‹è€…è°ƒç”¨ä¸€ä¸ªè¿œç¨‹è¿‡ç¨‹å’Œè°ƒç”¨æœ¬åœ°è¿‡ç¨‹åŒæ ·æ–¹ä¾¿ã€‚RPC ç³»ç»Ÿé‡‡ç”¨XDRæ¥ç¼–ç è¿œç¨‹è°ƒç”¨çš„å‚æ•°å’Œè¿”å›žå€¼ã€‚ä½†RPCå¹¶ä¸æ”¯æŒå¯¹è±¡ï¼Œæ‰€ä»¥ï¼Œé¢å‘å¯¹è±¡çš„è¿œç¨‹è°ƒç”¨RMI(Remote Method Invocation)æˆä¸ºå¿…ç„¶é€‰æ‹©ã€‚é‡‡ç”¨RMIï¼Œè°ƒç”¨è¿œç¨‹å¯¹è±¡å’Œè°ƒç”¨æœ¬åœ°å¯¹è±¡åŒæ ·æ–¹ä¾¿ã€‚RMI é‡‡ç”¨JRMP(Java Remote Method Protocol)é€šè®¯åè®®ï¼Œæ˜¯æž„å»ºåœ¨TCP/IPåè®®ä¸Šçš„ä¸€ç§è¿œç¨‹è°ƒç”¨æ–¹æ³•ã€‚ JMSä¸ŽRMI é‡‡ç”¨JMSæœåŠ¡ï¼Œå¯¹è±¡æ˜¯åœ¨ç‰©ç†ä¸Šè¢«å¼‚æ­¥ä»Žç½‘ç»œçš„æŸä¸ªJVM ä¸Šç›´æŽ¥ç§»åŠ¨åˆ°å¦ä¸€ä¸ªJVM ä¸Šï¼ˆæ˜¯æ¶ˆæ¯é€šçŸ¥æœºåˆ¶ï¼‰ï¼Œè€ŒRMIå¯¹è±¡æ˜¯ç»‘å®šåœ¨æœ¬åœ°JVM ä¸­ï¼Œåªæœ‰å‡½æ•°å‚æ•°å’Œè¿”å›žå€¼æ˜¯é€šè¿‡ç½‘ç»œä¼ é€çš„ï¼ˆæ˜¯è¯·æ±‚åº”ç­”æœºåˆ¶ï¼‰ã€‚ RMIä¸€èˆ¬éƒ½æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“clientè°ƒç”¨Serverçš„ä¸€ä¸ªæ–¹æ³•çš„æ—¶å€™ï¼Œéœ€è¦ç­‰åˆ°å¯¹æ–¹çš„è¿”å›žï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œclientç«¯ï¼Œè¿™ä¸ªè¿‡ç¨‹è°ƒç”¨æœ¬åœ°æ–¹æ³•æ„Ÿè§‰ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œè¿™ä¹Ÿæ˜¯RMIçš„ä¸€ä¸ªç‰¹ç‚¹ã€‚JMS ä¸€èˆ¬åªæ˜¯ä¸€ä¸ªç‚¹å‘å‡ºä¸€ä¸ªMessageåˆ°Message Server,å‘å‡ºä¹‹åŽä¸€èˆ¬ä¸ä¼šå…³å¿ƒè°ç”¨äº†è¿™ä¸ªmessageã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬RMIçš„åº”ç”¨æ˜¯ç´§è€¦åˆï¼ŒJMSçš„åº”ç”¨ç›¸å¯¹æ¥è¯´æ˜¯æ¾æ•£è€¦åˆåº”ç”¨ã€‚ Webserviceä¸ŽRMI RMIæ˜¯åœ¨tcpåè®®ä¸Šä¼ é€’å¯åºåˆ—åŒ–çš„javaå¯¹è±¡ï¼Œåªèƒ½ç”¨åœ¨javaè™šæ‹Ÿæœºä¸Šï¼Œç»‘å®šè¯­è¨€ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¿…é¡»æ˜¯javaã€‚webserviceæ²¡æœ‰è¿™ä¸ªé™åˆ¶ï¼Œwebserviceæ˜¯åœ¨httpåè®®ä¸Šä¼ é€’xmlæ–‡æœ¬æ–‡ä»¶ï¼Œä¸Žè¯­è¨€å’Œå¹³å°æ— å…³ã€‚ Webserviceä¸ŽJMS Webserviceä¸“æ³¨äºŽè¿œç¨‹æœåŠ¡è°ƒç”¨ï¼Œjmsä¸“æ³¨äºŽä¿¡æ¯äº¤æ¢ã€‚ å¤§å¤šæ•°æƒ…å†µä¸‹Webserviceæ˜¯ä¸¤ç³»ç»Ÿé—´çš„ç›´æŽ¥äº¤äº’ï¼ˆConsumer Producerï¼‰ï¼Œè€Œå¤§å¤šæ•°æƒ…å†µä¸‹jmsæ˜¯ä¸‰æ–¹ç³»ç»Ÿäº¤äº’ï¼ˆConsumer Producerï¼‰ã€‚å½“ç„¶ï¼ŒJMSä¹Ÿå¯ä»¥å®žçŽ°request-responseæ¨¡å¼çš„é€šä¿¡ï¼Œåªè¦Consumeræˆ–Producerå…¶ä¸­ä¸€æ–¹å…¼ä»»brokerå³å¯ã€‚ JMSå¯ä»¥åšåˆ°å¼‚æ­¥è°ƒç”¨å®Œå…¨éš”ç¦»äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡æä¾›è€…ï¼Œèƒ½å¤ŸæŠµå¾¡æµé‡æ´ªå³°ï¼›WebServiceæœåŠ¡é€šå¸¸ä¸ºåŒæ­¥è°ƒç”¨ï¼Œéœ€è¦æœ‰å¤æ‚çš„å¯¹è±¡è½¬æ¢ï¼Œç›¸æ¯”SOAPï¼ŒçŽ°åœ¨JSONï¼Œrestéƒ½æ˜¯å¾ˆå¥½çš„httpæž¶æž„æ–¹æ¡ˆï¼› JMSæ˜¯javaå¹³å°ä¸Šçš„æ¶ˆæ¯è§„èŒƒã€‚ä¸€èˆ¬jmsæ¶ˆæ¯ä¸æ˜¯ä¸€ä¸ªxmlï¼Œè€Œæ˜¯ä¸€ä¸ªjavaå¯¹è±¡ï¼Œå¾ˆæ˜Žæ˜¾ï¼Œjmsæ²¡è€ƒè™‘å¼‚æž„ç³»ç»Ÿï¼Œè¯´ç™½äº†ï¼ŒJMSå°±æ²¡è€ƒè™‘éžjavaçš„ä¸œè¥¿ã€‚ä½†æ˜¯å¥½åœ¨çŽ°åœ¨å¤§å¤šæ•°çš„jms providerï¼ˆå°±æ˜¯JMSçš„å„ç§å®žçŽ°äº§å“ï¼‰éƒ½è§£å†³äº†å¼‚æž„é—®é¢˜ã€‚ç›¸æ¯”WebServiceçš„è·¨å¹³å°å„æœ‰åƒç§‹å§ã€‚ å¯é€‰å®žçŽ°æŠ€æœ¯ç›®å‰javaé¢†åŸŸå¯ç”¨äºŽå®žçŽ°è¿œç¨‹é€šè®¯çš„æ¡†æž¶æˆ–libraryï¼ŒçŸ¥åçš„æœ‰ï¼šJBoss-Remotingã€Spring-Remotingã€Hessianã€Burlapã€XFire(Axis)ã€ActiveMQã€Minaã€Muleã€EJB3ç­‰ç­‰ï¼Œæ¥å¯¹æ¯ç§åšä¸ªç®€å•çš„ä»‹ç»å’Œè¯„ä»·ï¼Œå…¶å®žå‘¢ï¼Œè¦åšåˆ†å¸ƒå¼æœåŠ¡æ¡†æž¶ï¼Œè¿™äº›ä¸œè¥¿éƒ½æ˜¯è¦æœ‰éžå¸¸æ·±åˆ»çš„äº†è§£çš„ï¼Œå› ä¸ºåˆ†å¸ƒå¼æœåŠ¡æ¡†æž¶å…¶å®žæ˜¯åŒ…å«äº†è§£å†³åˆ†å¸ƒå¼é¢†åŸŸä»¥åŠåº”ç”¨å±‚é¢é¢†åŸŸä¸¤æ–¹é¢é—®é¢˜çš„ã€‚ å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥è‡ªå·±æ ¹æ®è¿œç¨‹ç½‘ç»œé€šä¿¡åŽŸç†(transport protocol+Net IO)åŽ»å®žçŽ°è‡ªå·±çš„é€šè®¯æ¡†æž¶æˆ–libraryã€‚ é‚£ä¹ˆåœ¨äº†è§£è¿™äº›è¿œç¨‹é€šè®¯çš„æ¡†æž¶æˆ–libraryæ—¶ï¼Œä¼šå¸¦ç€ä»€ä¹ˆé—®é¢˜åŽ»å­¦ä¹ å‘¢ï¼Ÿ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼Ÿ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼Ÿ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼Ÿ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼Ÿ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿ Spring-Remoting Spring-remotingæ˜¯Springæä¾›javaé¢†åŸŸçš„è¿œç¨‹é€šè®¯æ¡†æž¶ï¼ŒåŸºäºŽæ­¤æ¡†æž¶ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å¾ˆç®€å•çš„å°†æ™®é€šçš„spring beanä»¥æŸç§è¿œç¨‹åè®®çš„æ–¹å¼æ¥å‘å¸ƒï¼ŒåŒæ ·ä¹Ÿå¯ä»¥é…ç½®spring beanä¸ºè¿œç¨‹è°ƒç”¨çš„beanã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼Ÿä½œä¸ºä¸€ä¸ªè¿œç¨‹é€šè®¯çš„æ¡†æž¶ï¼ŒSpringé€šè¿‡é›†æˆå¤šç§è¿œç¨‹é€šè®¯çš„libraryï¼Œä»Žè€Œå®žçŽ°äº†å¯¹å¤šç§åè®®çš„æ”¯æŒï¼Œä¾‹å¦‚rmiã€http+ioã€xml-rpcã€binary-rpcç­‰ã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿåœ¨Springä¸­ï¼Œç”±äºŽå…¶å¯¹äºŽè¿œç¨‹è°ƒç”¨çš„beané‡‡ç”¨çš„æ˜¯proxyå®žçŽ°ï¼Œå‘èµ·è¯·æ±‚å®Œå…¨æ˜¯é€šè¿‡æœåŠ¡æŽ¥å£è°ƒç”¨çš„æ–¹å¼ã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼ŸSpringæŒ‰ç…§åè®®æ–¹å¼å°†è¯·æ±‚çš„å¯¹è±¡ä¿¡æ¯è½¬åŒ–ä¸ºæµï¼Œä¾‹å¦‚Spring Http Invokeræ˜¯åŸºäºŽSpringè‡ªå·±å®šä¹‰çš„ä¸€ä¸ªåè®®æ¥å®žçŽ°çš„ï¼Œä¼ è¾“åè®®ä¸Šé‡‡ç”¨çš„ä¸ºhttpï¼Œè¯·æ±‚ä¿¡æ¯æ˜¯åŸºäºŽjavaä¸²è¡ŒåŒ–æœºåˆ¶è½¬åŒ–ä¸ºæµè¿›è¡Œä¼ è¾“ã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼Ÿæ”¯æŒå¤šç§ä¼ è¾“åè®®ï¼Œä¾‹å¦‚rmiã€httpç­‰ç­‰ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿå“åº”ç«¯éµå¾ªåè®®æ–¹å¼æ¥æŽ¥æ”¶è¯·æ±‚ï¼Œå¯¹äºŽä½¿ç”¨è€…è€Œè¨€ï¼Œåˆ™åªéœ€é€šè¿‡springçš„é…ç½®æ–¹å¼å°†æ™®é€šçš„spring beané…ç½®ä¸ºå“åº”ç«¯æˆ–è€…è¯´æä¾›æœåŠ¡ç«¯ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼ŸæŒ‰ç…§åè®®æ–¹å¼æ¥è¿›è¡Œè¿˜åŽŸã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿå¤„ç†å®Œæ¯•åŽç›´æŽ¥è¿”å›žå³å¯ï¼Œspring-remotingå°†æ ¹æ®åè®®æ–¹å¼æ¥åšç›¸åº”çš„åºåˆ—åŒ–ã€‚ Hessian Hessianæ˜¯ç”±cauchoæä¾›çš„ä¸€ä¸ªåŸºäºŽbinary-RPCå®žçŽ°çš„è¿œç¨‹é€šè®¯libraryã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼ŸåŸºäºŽBinary-RPCåè®®å®žçŽ°ã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿéœ€é€šè¿‡Hessianæœ¬èº«æä¾›çš„APIæ¥å‘èµ·è¯·æ±‚ã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼ŸHessiané€šè¿‡å…¶è‡ªå®šä¹‰çš„ä¸²è¡ŒåŒ–æœºåˆ¶å°†è¯·æ±‚ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–ï¼Œäº§ç”ŸäºŒè¿›åˆ¶æµã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼ŸHessianåŸºäºŽHttpåè®®è¿›è¡Œä¼ è¾“ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿå“åº”ç«¯æ ¹æ®Hessianæä¾›çš„APIæ¥æŽ¥æ”¶è¯·æ±‚ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼ŸHessianæ ¹æ®å…¶ç§æœ‰çš„ä¸²è¡ŒåŒ–æœºåˆ¶æ¥å°†è¯·æ±‚ä¿¡æ¯è¿›è¡Œååºåˆ—åŒ–ï¼Œä¼ é€’ç»™ä½¿ç”¨è€…æ—¶å·²æ˜¯ç›¸åº”çš„è¯·æ±‚ä¿¡æ¯å¯¹è±¡äº†ã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿå¤„ç†å®Œæ¯•åŽç›´æŽ¥è¿”å›žï¼Œhessianå°†ç»“æžœå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œä¼ è¾“è‡³è°ƒç”¨ç«¯ã€‚ Burlap Burlapä¹Ÿæ˜¯æœ‰cauchoæä¾›ï¼Œå®ƒå’Œhessiançš„ä¸åŒåœ¨äºŽï¼Œå®ƒæ˜¯åŸºäºŽXML-RPCåè®®çš„ã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼ŸåŸºäºŽXML-RPCåè®®å®žçŽ°ã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿæ ¹æ®Burlapæä¾›çš„APIã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼Ÿå°†è¯·æ±‚ä¿¡æ¯è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„XMLæ ¼å¼ï¼Œè½¬åŒ–ä¸ºæµè¿›è¡Œä¼ è¾“ã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼ŸHttpåè®®ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿç›‘å¬Httpè¯·æ±‚ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼Ÿæ ¹æ®XML-RPCåè®®è¿›è¡Œè¿˜åŽŸã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿè¿”å›žç»“æžœå†™å…¥XMLä¸­ï¼Œç”±Burlapè¿”å›žè‡³è°ƒç”¨ç«¯ã€‚ XFireã€Axis XFireã€Axisæ˜¯Webserviceçš„å®žçŽ°æ¡†æž¶ï¼ŒWebServiceå¯ç®—æ˜¯ä¸€ä¸ªå®Œæ•´çš„SOAæž¶æž„å®žçŽ°æ ‡å‡†äº†ï¼Œå› æ­¤é‡‡ç”¨XFireã€Axisè¿™äº›ä¹Ÿå°±æ„å‘³ç€æ˜¯é‡‡ç”¨webserviceæ–¹å¼äº†ã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼ŸåŸºäºŽSOAPåè®®ã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼ŸèŽ·å–åˆ°è¿œç«¯serviceçš„proxyåŽç›´æŽ¥è°ƒç”¨ã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼Ÿå°†è¯·æ±‚ä¿¡æ¯è½¬åŒ–ä¸ºéµå¾ªSOAPåè®®çš„XMLæ ¼å¼ï¼Œç”±æ¡†æž¶è½¬åŒ–ä¸ºæµè¿›è¡Œä¼ è¾“ã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼ŸHttpåè®®ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿç›‘å¬Httpè¯·æ±‚ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼Ÿæ ¹æ®SOAPåè®®è¿›è¡Œè¿˜åŽŸã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿè¿”å›žç»“æžœå†™å…¥XMLä¸­ï¼Œç”±æ¡†æž¶è¿”å›žè‡³è°ƒç”¨ç«¯ã€‚ ActiveMQ ActiveMQæ˜¯JMSçš„å®žçŽ°ï¼ŒåŸºäºŽJMSè¿™ç±»æ¶ˆæ¯æœºåˆ¶å®žçŽ°è¿œç¨‹é€šè®¯æ˜¯ä¸€ç§ä¸é”™çš„é€‰æ‹©ï¼Œæ¯•ç«Ÿæ¶ˆæ¯æœºåˆ¶æœ¬èº«çš„åŠŸèƒ½ä½¿å¾—åŸºäºŽå®ƒå¯ä»¥å¾ˆå®¹æ˜“çš„åŽ»å®žçŽ°åŒæ­¥/å¼‚æ­¥/å•å‘è°ƒç”¨ç­‰ï¼Œè€Œä¸”æ¶ˆæ¯æœºåˆ¶ä»Žå®¹é”™è§’åº¦ä¸Šæ¥è¯´ä¹Ÿæ˜¯ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œè¿™æ˜¯Erlangèƒ½å¤Ÿåšåˆ°å®¹é”™çš„é‡è¦åŸºç¡€ã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼ŸåŸºäºŽJMSåè®®ã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿéµå¾ªJMS APIå‘èµ·è¯·æ±‚ã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼Ÿä¸å¤ªæ¸…æ¥šï¼ŒçŒœæƒ³åº”è¯¥æ˜¯äºŒè¿›åˆ¶æµã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼Ÿæ”¯æŒå¤šç§ä¼ è¾“åè®®ï¼Œä¾‹å¦‚socketã€httpç­‰ç­‰ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿç›‘å¬ç¬¦åˆåè®®çš„ç«¯å£ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼ŸåŒé—®é¢˜3ã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿéµå¾ªJMS APIç”Ÿæˆæ¶ˆæ¯ï¼Œå¹¶å†™å…¥JMS Queueä¸­ã€‚ Mina Minaæ˜¯Apacheæä¾›çš„é€šè®¯æ¡†æž¶ï¼Œåœ¨ä¹‹å‰ä¸€ç›´æ²¡æœ‰æåˆ°ç½‘ç»œIOè¿™å—ï¼Œä¹‹å‰æåŠçš„æ¡†æž¶æˆ–libraryåŸºæœ¬éƒ½æ˜¯åŸºäºŽBIOçš„ï¼Œè€ŒMinaæ˜¯é‡‡ç”¨NIOçš„ï¼ŒNIOåœ¨å¹¶å‘é‡å¢žé•¿æ—¶å¯¹æ¯”BIOè€Œè¨€ä¼šæœ‰æ˜Žæ˜¾çš„æ€§èƒ½æå‡ï¼Œè€Œjavaæ€§èƒ½çš„æå‡ï¼Œä¸Žå…¶NIOè¿™å—ä¸ŽOSçš„ç´§å¯†ç»“åˆæ˜¯æœ‰ä¸å°çš„å…³ç³»çš„ã€‚ æ˜¯åŸºäºŽä»€ä¹ˆåè®®å®žçŽ°çš„ï¼ŸåŸºäºŽçº¯ç²¹çš„Socket+NIOã€‚ æ€Žä¹ˆå‘èµ·è¯·æ±‚ï¼Ÿé€šè¿‡Minaæä¾›çš„Client APIã€‚ æ€Žä¹ˆå°†è¯·æ±‚è½¬åŒ–ä¸ºç¬¦åˆåè®®çš„æ ¼å¼çš„ï¼ŸMinaéµå¾ªjavaä¸²è¡ŒåŒ–æœºåˆ¶å¯¹è¯·æ±‚å¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ã€‚ ä½¿ç”¨ä»€ä¹ˆä¼ è¾“åè®®ä¼ è¾“ï¼Ÿæ”¯æŒå¤šç§ä¼ è¾“åè®®ï¼Œä¾‹å¦‚socketã€httpç­‰ç­‰ã€‚ å“åº”ç«¯åŸºäºŽä»€ä¹ˆæœºåˆ¶æ¥æŽ¥æ”¶è¯·æ±‚ï¼Ÿä»¥NIOçš„æ–¹å¼ç›‘å¬åè®®ç«¯å£ã€‚ æ€Žä¹ˆå°†æµè¿˜åŽŸä¸ºä¼ è¾“æ ¼å¼çš„ï¼Ÿéµå¾ªjavaä¸²è¡ŒåŒ–æœºåˆ¶å¯¹è¯·æ±‚å¯¹è±¡è¿›è¡Œååºåˆ—åŒ–ã€‚ å¤„ç†å®Œæ¯•åŽæ€Žä¹ˆå›žåº”ï¼Ÿéµå¾ªMina APIè¿›è¡Œè¿”å›žã€‚ MINAæ˜¯NIOæ–¹å¼çš„ï¼Œå› æ­¤æ”¯æŒå¼‚æ­¥è°ƒç”¨æ˜¯æ¯«æ— æ‚¬å¿µçš„ã€‚ RPCæ¡†æž¶çš„å‘å±•ä¸ŽçŽ°çŠ¶RPCï¼ˆRemote Procedure Callï¼‰æ˜¯ä¸€ç§è¿œç¨‹è°ƒç”¨åè®®ï¼Œç®€å•åœ°è¯´å°±æ˜¯èƒ½ä½¿åº”ç”¨åƒè°ƒç”¨æœ¬åœ°æ–¹æ³•ä¸€æ ·çš„è°ƒç”¨è¿œç¨‹çš„è¿‡ç¨‹æˆ–æœåŠ¡ï¼Œå¯ä»¥åº”ç”¨åœ¨åˆ†å¸ƒå¼æœåŠ¡ã€åˆ†å¸ƒå¼è®¡ç®—ã€è¿œç¨‹æœåŠ¡è°ƒç”¨ç­‰è®¸å¤šåœºæ™¯ã€‚è¯´èµ· RPC å¤§å®¶å¹¶ä¸é™Œç”Ÿï¼Œä¸šç•Œæœ‰å¾ˆå¤šå¼€æºçš„ä¼˜ç§€ RPC æ¡†æž¶ï¼Œä¾‹å¦‚ Dubboã€Thriftã€gRPCã€Hprose ç­‰ç­‰ã€‚ä¸‹é¢å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ RPC ä¸Žå¸¸ç”¨è¿œç¨‹è°ƒç”¨æ–¹å¼çš„ç‰¹ç‚¹ï¼Œä»¥åŠä¸€äº›ä¼˜ç§€çš„å¼€æº RPC æ¡†æž¶ã€‚ RPC ä¸Žå…¶å®ƒè¿œç¨‹è°ƒç”¨æ–¹å¼æ¯”è¾ƒï¼ŒRPC ä¸Ž HTTPã€RMIã€Web Service éƒ½èƒ½å®Œæˆè¿œç¨‹è°ƒç”¨ï¼Œä½†æ˜¯å®žçŽ°æ–¹å¼å’Œä¾§é‡ç‚¹å„æœ‰ä¸åŒã€‚ RPCä¸ŽHTTP HTTPï¼ˆHyperText Transfer Protocolï¼‰æ˜¯åº”ç”¨å±‚é€šä¿¡åè®®ï¼Œä½¿ç”¨æ ‡å‡†è¯­ä¹‰è®¿é—®æŒ‡å®šèµ„æºï¼ˆå›¾ç‰‡ã€æŽ¥å£ç­‰ï¼‰ï¼Œç½‘ç»œä¸­çš„ä¸­è½¬æœåŠ¡å™¨èƒ½è¯†åˆ«åè®®å†…å®¹ã€‚HTTP åè®®æ˜¯ä¸€ç§èµ„æºè®¿é—®åè®®ï¼Œé€šè¿‡ HTTP åè®®å¯ä»¥å®Œæˆè¿œç¨‹è¯·æ±‚å¹¶è¿”å›žè¯·æ±‚ç»“æžœã€‚ HTTP çš„ä¼˜ç‚¹æ˜¯ç®€å•ã€æ˜“ç”¨ã€å¯ç†è§£æ€§å¼ºä¸”è¯­è¨€æ— å…³ï¼Œåœ¨è¿œç¨‹æœåŠ¡è°ƒç”¨ä¸­åŒ…æ‹¬å¾®åšæœ‰ç€å¹¿æ³›åº”ç”¨ã€‚HTTP çš„ç¼ºç‚¹æ˜¯åè®®å¤´è¾ƒé‡ï¼Œä¸€èˆ¬è¯·æ±‚åˆ°å…·ä½“æœåŠ¡å™¨çš„é“¾è·¯è¾ƒé•¿ï¼Œå¯èƒ½ä¼šæœ‰ DNS è§£æžã€Nginx ä»£ç†ç­‰ã€‚ RPC æ˜¯ä¸€ç§åè®®è§„èŒƒï¼Œå¯ä»¥æŠŠ HTTP çœ‹ä½œæ˜¯ä¸€ç§ RPC çš„å®žçŽ°ï¼Œä¹Ÿå¯ä»¥æŠŠ HTTP ä½œä¸º RPC çš„ä¼ è¾“åè®®æ¥åº”ç”¨ã€‚RPC æœåŠ¡çš„è‡ªåŠ¨åŒ–ç¨‹åº¦æ¯”è¾ƒé«˜ï¼Œèƒ½å¤Ÿå®žçŽ°å¼ºå¤§çš„æœåŠ¡æ²»ç†åŠŸèƒ½ï¼Œå’Œè¯­è¨€ç»“åˆæ›´å‹å¥½ï¼Œæ€§èƒ½ä¹Ÿååˆ†ä¼˜ç§€ã€‚ä¸Ž HTTP ç›¸æ¯”ï¼ŒRPC çš„ç¼ºç‚¹å°±æ˜¯ç›¸å¯¹å¤æ‚ï¼Œå­¦ä¹ æˆæœ¬ç¨é«˜ã€‚ RPCä¸ŽRMI RMIï¼ˆRemote Method Invocationï¼‰æ˜¯æŒ‡ Java è¯­è¨€ä¸­çš„è¿œç¨‹æ–¹æ³•è°ƒç”¨ï¼ŒRMI ä¸­çš„æ¯ä¸ªæ–¹æ³•éƒ½å…·æœ‰æ–¹æ³•ç­¾åï¼ŒRMI å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯é€šè¿‡æ–¹æ³•ç­¾åè¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨ã€‚RMI åªèƒ½åœ¨ Java è¯­è¨€ä¸­ä½¿ç”¨ï¼Œå¯ä»¥æŠŠ RMI çœ‹ä½œé¢å‘å¯¹è±¡çš„ Java RPCã€‚ RPCä¸ŽWeb Service Web Service æ˜¯ä¸€ç§åŸºäºŽ Web è¿›è¡ŒæœåŠ¡å‘å¸ƒã€æŸ¥è¯¢ã€è°ƒç”¨çš„æž¶æž„æ–¹å¼ï¼Œé‡ç‚¹åœ¨äºŽæœåŠ¡çš„ç®¡ç†ä¸Žä½¿ç”¨ã€‚Web Service ä¸€èˆ¬é€šè¿‡ WSDL æè¿°æœåŠ¡ï¼Œä½¿ç”¨ SOAPé€šè¿‡ HTTP è°ƒç”¨æœåŠ¡ã€‚ RPC æ˜¯ä¸€ç§è¿œç¨‹è®¿é—®åè®®ï¼Œè€Œ Web Service æ˜¯ä¸€ç§ä½“ç³»ç»“æž„ï¼ŒWeb Service ä¹Ÿå¯ä»¥é€šè¿‡ RPC æ¥è¿›è¡ŒæœåŠ¡è°ƒç”¨ï¼Œå› æ­¤ Web Service æ›´é€‚åˆåŒä¸€ä¸ª RPC æ¡†æž¶è¿›è¡Œæ¯”è¾ƒã€‚å½“ RPC æ¡†æž¶æä¾›äº†æœåŠ¡çš„å‘çŽ°ä¸Žç®¡ç†ï¼Œå¹¶ä½¿ç”¨ HTTP ä½œä¸ºä¼ è¾“åè®®æ—¶ï¼Œå…¶å®žå°±æ˜¯ Web Serviceã€‚ ç›¸å¯¹ Web Serviceï¼ŒRPC æ¡†æž¶å¯ä»¥å¯¹æœåŠ¡è¿›è¡Œæ›´ç»†ç²’åº¦çš„æ²»ç†ï¼ŒåŒ…æ‹¬æµé‡æŽ§åˆ¶ã€SLA ç®¡ç†ç­‰ï¼Œåœ¨å¾®æœåŠ¡åŒ–ã€åˆ†å¸ƒå¼è®¡ç®—æ–¹é¢æœ‰æ›´å¤§çš„ä¼˜åŠ¿ã€‚ RPC å¯åŸºäºŽ HTTP æˆ– TCP åè®®ï¼ŒWeb Service å°±æ˜¯åŸºäºŽ HTTP åè®®çš„ RPCï¼Œå®ƒå…·æœ‰è‰¯å¥½çš„è·¨å¹³å°æ€§ï¼Œä½†å…¶æ€§èƒ½å´ä¸å¦‚åŸºäºŽ TCP åè®®çš„ RPCã€‚ä¼šä¸¤æ–¹é¢ä¼šç›´æŽ¥å½±å“ RPC çš„æ€§èƒ½ï¼Œä¸€æ˜¯ä¼ è¾“æ–¹å¼ï¼ŒäºŒæ˜¯åºåˆ—åŒ–ã€‚ ä¼—æ‰€å‘¨çŸ¥ï¼ŒTCP æ˜¯ä¼ è¾“å±‚åè®®ï¼ŒHTTP æ˜¯åº”ç”¨å±‚åè®®ï¼Œè€Œä¼ è¾“å±‚è¾ƒåº”ç”¨å±‚æ›´åŠ åº•å±‚ï¼Œåœ¨æ•°æ®ä¼ è¾“æ–¹é¢ï¼Œè¶Šåº•å±‚è¶Šå¿«ï¼Œå› æ­¤ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒTCP ä¸€å®šæ¯” HTTP å¿«ã€‚]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Javaå®šæ—¶ä»»åŠ¡]]></title>
    <url>%2F2016%2F05%2F20%2Ftask20160520%2F</url>
    <content type="text"><![CDATA[åœ¨javaä¸­ä¸€ä¸ªå®Œæ•´å®šæ—¶ä»»åŠ¡éœ€è¦ç”±Timerã€TimerTaskä¸¤ä¸ªç±»æ¥é…åˆå®Œæˆã€‚ APIä¸­æ˜¯è¿™æ ·å®šä¹‰ä»–ä»¬çš„ï¼ŒTimerï¼šä¸€ç§å·¥å…·ï¼Œçº¿ç¨‹ç”¨å…¶å®‰æŽ’ä»¥åŽåœ¨åŽå°çº¿ç¨‹ä¸­æ‰§è¡Œçš„ä»»åŠ¡ã€‚å¯å®‰æŽ’ä»»åŠ¡æ‰§è¡Œä¸€æ¬¡ï¼Œæˆ–è€…å®šæœŸé‡å¤æ‰§è¡Œã€‚ç”±TimerTaskï¼šTimer å®‰æŽ’ä¸ºä¸€æ¬¡æ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚æˆ‘ä»¬å¯ä»¥è¿™æ ·ç†è§£Timeræ˜¯ä¸€ç§å®šæ—¶å™¨å·¥å…·ï¼Œç”¨æ¥åœ¨ä¸€ä¸ªåŽå°çº¿ç¨‹è®¡åˆ’æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œè€ŒTimerTaskä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå®ƒçš„å­ç±»ä»£è¡¨ä¸€ä¸ªå¯ä»¥è¢«Timerè®¡åˆ’çš„ä»»åŠ¡ã€‚ Timerç±»åœ¨å·¥å…·ç±»Timerä¸­ï¼Œæä¾›äº†å››ä¸ªæž„é€ æ–¹æ³•ï¼Œæ¯ä¸ªæž„é€ æ–¹æ³•éƒ½å¯åŠ¨äº†è®¡æ—¶å™¨çº¿ç¨‹ï¼ŒåŒæ—¶Timerç±»å¯ä»¥ä¿è¯å¤šä¸ªçº¿ç¨‹å¯ä»¥å…±äº«å•ä¸ªTimerå¯¹è±¡è€Œæ— éœ€è¿›è¡Œå¤–éƒ¨åŒæ­¥ï¼Œæ‰€ä»¥Timerç±»æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚ä½†æ˜¯ç”±äºŽæ¯ä¸€ä¸ªTimerå¯¹è±¡å¯¹åº”çš„æ˜¯å•ä¸ªåŽå°çº¿ç¨‹ï¼Œç”¨äºŽé¡ºåºæ‰§è¡Œæ‰€æœ‰çš„è®¡æ—¶å™¨ä»»åŠ¡ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬çš„çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œæ‰€æ¶ˆè€—çš„æ—¶é—´åº”è¯¥éžå¸¸çŸ­ï¼Œä½†æ˜¯ç”±äºŽç‰¹æ®Šæƒ…å†µå¯¼è‡´æŸä¸ªå®šæ—¶å™¨ä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´å¤ªé•¿ï¼Œé‚£ä¹ˆä»–å°±ä¼šâ€œç‹¬å â€è®¡æ—¶å™¨çš„ä»»åŠ¡æ‰§è¡Œçº¿ç¨‹ï¼Œå…¶åŽçš„æ‰€æœ‰çº¿ç¨‹éƒ½å¿…é¡»ç­‰å¾…å®ƒæ‰§è¡Œå®Œï¼Œè¿™å°±ä¼šå»¶è¿ŸåŽç»­ä»»åŠ¡çš„æ‰§è¡Œï¼Œä½¿è¿™äº›ä»»åŠ¡å †ç§¯åœ¨ä¸€èµ·ï¼Œå…·ä½“æƒ…å†µæˆ‘ä»¬åŽé¢åˆ†æžã€‚ å½“ç¨‹åºåˆå§‹åŒ–å®ŒæˆTimeråŽï¼Œå®šæ—¶ä»»åŠ¡å°±ä¼šæŒ‰ç…§æˆ‘ä»¬è®¾å®šçš„æ—¶é—´åŽ»æ‰§è¡Œï¼ŒTimeræä¾›äº†scheduleæ–¹æ³•ï¼Œè¯¥æ–¹æ³•æœ‰å¤šä¸­é‡è½½æ–¹å¼æ¥é€‚åº”ä¸åŒçš„æƒ…å†µï¼Œå¦‚ä¸‹ï¼š schedule(TimerTask task, Date time)ï¼šå®‰æŽ’åœ¨æŒ‡å®šçš„æ—¶é—´æ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚ schedule(TimerTask task, Date firstTime, long period) ï¼šå®‰æŽ’æŒ‡å®šçš„ä»»åŠ¡åœ¨æŒ‡å®šçš„æ—¶é—´å¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šå»¶è¿Ÿæ‰§è¡Œã€‚ schedule(TimerTask task, long delay) ï¼šå®‰æŽ’åœ¨æŒ‡å®šå»¶è¿ŸåŽæ‰§è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚ schedule(TimerTask task, long delay, long period) ï¼šå®‰æŽ’æŒ‡å®šçš„ä»»åŠ¡ä»ŽæŒ‡å®šçš„å»¶è¿ŸåŽå¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šå»¶è¿Ÿæ‰§è¡Œã€‚ åŒæ—¶ä¹Ÿé‡è½½äº†scheduleAtFixedRateæ–¹æ³•ï¼ŒscheduleAtFixedRateæ–¹æ³•ä¸Žscheduleç›¸åŒï¼Œåªä¸è¿‡ä»–ä»¬çš„ä¾§é‡ç‚¹ä¸åŒï¼ŒåŒºåˆ«åŽé¢åˆ†æžã€‚ scheduleAtFixedRate(TimerTask task, Date firstTime, long period)ï¼šå®‰æŽ’æŒ‡å®šçš„ä»»åŠ¡åœ¨æŒ‡å®šçš„æ—¶é—´å¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šé€ŸçŽ‡æ‰§è¡Œã€‚ scheduleAtFixedRate(TimerTask task, long delay, long period)ï¼šå®‰æŽ’æŒ‡å®šçš„ä»»åŠ¡åœ¨æŒ‡å®šçš„å»¶è¿ŸåŽå¼€å§‹è¿›è¡Œé‡å¤çš„å›ºå®šé€ŸçŽ‡æ‰§è¡Œã€‚ TimerTaskTimerTaskç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œç”±Timer å®‰æŽ’ä¸ºä¸€æ¬¡æ‰§è¡Œæˆ–é‡å¤æ‰§è¡Œçš„ä»»åŠ¡ã€‚å®ƒæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•run()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•ç”¨äºŽæ‰§è¡Œç›¸åº”è®¡æ—¶å™¨ä»»åŠ¡è¦æ‰§è¡Œçš„æ“ä½œã€‚å› æ­¤æ¯ä¸€ä¸ªå…·ä½“çš„ä»»åŠ¡ç±»éƒ½å¿…é¡»ç»§æ‰¿TimerTaskï¼Œç„¶åŽé‡å†™run()æ–¹æ³•ã€‚ å¦å¤–å®ƒè¿˜æœ‰ä¸¤ä¸ªéžæŠ½è±¡çš„æ–¹æ³•ï¼š boolean cancel()ï¼šå–æ¶ˆæ­¤è®¡æ—¶å™¨ä»»åŠ¡ã€‚ long scheduledExecutionTime()ï¼šè¿”å›žæ­¤ä»»åŠ¡æœ€è¿‘å®žé™…æ‰§è¡Œçš„å®‰æŽ’æ‰§è¡Œæ—¶é—´ã€‚ å®žä¾‹æŒ‡å®šå»¶è¿Ÿæ—¶é—´æ‰§è¡Œå®šæ—¶ä»»åŠ¡ 12345678910111213141516public class TimerTest01 &#123; Timer timer; public TimerTest01(int time)&#123; timer = new Timer(); timer.schedule(new TimerTaskTest01(), time * 1000); &#125; public static void main(String[] args) &#123; System.out.println("timer begin...."); new TimerTest01(3); &#125;&#125;public class TimerTaskTest01 extends TimerTask&#123; public void run() &#123; System.out.println("Time's up!!!!"); &#125;&#125; ç»“æžœ timer beginâ€¦.3ç§’åŽæ‰“å°ï¼šTimeâ€™s up!!!! åœ¨æŒ‡å®šæ—¶é—´æ‰§è¡Œå®šæ—¶ä»»åŠ¡ 1234567891011121314151617181920212223242526public class TimerTest02 &#123; Timer timer; public TimerTest02()&#123; Date time = getTime(); System.out.println("æŒ‡å®šæ—¶é—´time=" + time); timer = new Timer(); timer.schedule(new TimerTaskTest02(), time); &#125; public Date getTime()&#123; Calendar calendar = Calendar.getInstance(); calendar.set(Calendar.HOUR_OF_DAY, 11); calendar.set(Calendar.MINUTE, 39); calendar.set(Calendar.SECOND, 00); Date time = calendar.getTime(); return time; &#125; public static void main(String[] args) &#123; new TimerTest02(); &#125;&#125;public class TimerTaskTest02 extends TimerTask&#123; @Override public void run() &#123; System.out.println("æŒ‡å®šæ—¶é—´æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡..."); &#125;&#125; å½“æ—¶é—´åˆ°è¾¾11:39:00æ—¶å°±ä¼šæ‰§è¡Œè¯¥çº¿ç¨‹ä»»åŠ¡ï¼Œå½“ç„¶å¤§äºŽè¯¥æ—¶é—´ä¹Ÿä¼šæ‰§è¡Œï¼ï¼æ‰§è¡Œç»“æžœä¸ºï¼š æŒ‡å®šæ—¶é—´time=Tue Jun 10 11:39:00 CST 2014æŒ‡å®šæ—¶é—´æ‰§è¡Œçº¿ç¨‹ä»»åŠ¡â€¦ åœ¨å»¶è¿ŸæŒ‡å®šæ—¶é—´åŽä»¥æŒ‡å®šçš„é—´éš”æ—¶é—´å¾ªçŽ¯æ‰§è¡Œå®šæ—¶ä»»åŠ¡ 1234567891011121314151617public class TimerTest03 &#123; Timer timer; public TimerTest03()&#123; timer = new Timer(); timer.schedule(new TimerTaskTest03(), 1000, 2000); &#125; public static void main(String[] args) &#123; new TimerTest03(); &#125;&#125;public class TimerTaskTest03 extends TimerTask&#123; @Override public void run() &#123; Date date = new Date(this.scheduledExecutionTime()); System.out.println("æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼š" + date); &#125;&#125; ç»“æžœ æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:47 CST 2014æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:49 CST 2014æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:51 CST 2014æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:53 CST 2014æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:55 CST 2014æœ¬æ¬¡æ‰§è¡Œè¯¥çº¿ç¨‹çš„æ—¶é—´ä¸ºï¼šTue Jun 10 21:19:57 CST 2014â€¦â€¦â€¦â€¦â€¦.. å¯¹äºŽè¿™ä¸ªçº¿ç¨‹ä»»åŠ¡,å¦‚æžœæˆ‘ä»¬ä¸å°†è¯¥ä»»åŠ¡åœæ­¢,ä»–ä¼šä¸€ç›´è¿è¡Œä¸‹åŽ»ã€‚ å¯¹äºŽä¸Šé¢ä¸‰ä¸ªå®žä¾‹ï¼ŒLZåªæ˜¯ç®€å•çš„æ¼”ç¤ºäº†ä¸€ä¸‹ï¼ŒåŒæ—¶ä¹Ÿæ²¡æœ‰è®²è§£scheduleAtFixedRateæ–¹æ³•çš„ä¾‹å­ï¼Œå…¶å®žè¯¥æ–¹æ³•ä¸Žscheduleæ–¹æ³•ä¸€æ ·ï¼ åˆ†æžscheduleå’ŒscheduleAtFixedRate1ã€schedule(TimerTask task, Date time)ã€schedule(TimerTask task, long delay) å¯¹äºŽè¿™ä¸¤ä¸ªæ–¹æ³•è€Œè¨€ï¼Œå¦‚æžœæŒ‡å®šçš„è®¡åˆ’æ‰§è¡Œæ—¶é—´scheduledExecutionTime&lt;= systemCurrentTimeï¼Œåˆ™taskä¼šè¢«ç«‹å³æ‰§è¡Œã€‚scheduledExecutionTimeä¸ä¼šå› ä¸ºæŸä¸€ä¸ªtaskçš„è¿‡åº¦æ‰§è¡Œè€Œæ”¹å˜ã€‚ 2ã€schedule(TimerTask task, Date firstTime, long period)ã€schedule(TimerTask task, long delay, long period) è¿™ä¸¤ä¸ªæ–¹æ³•ä¸Žä¸Šé¢ä¸¤ä¸ªå°±æœ‰ç‚¹å„¿ä¸åŒçš„ï¼Œå‰é¢æè¿‡Timerçš„è®¡æ—¶å™¨ä»»åŠ¡ä¼šå› ä¸ºå‰ä¸€ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶é—´è¾ƒé•¿è€Œå»¶æ—¶ã€‚åœ¨è¿™ä¸¤ä¸ªæ–¹æ³•ä¸­ï¼Œæ¯ä¸€æ¬¡æ‰§è¡Œçš„taskçš„è®¡åˆ’æ—¶é—´ä¼šéšç€å‰ä¸€ä¸ªtaskçš„å®žé™…æ—¶é—´è€Œå‘ç”Ÿæ”¹å˜ï¼Œä¹Ÿå°±æ˜¯scheduledExecutionTime(n+1)=realExecutionTime(n)+periodTimeã€‚ä¹Ÿå°±æ˜¯è¯´å¦‚æžœç¬¬nä¸ªtaskç”±äºŽæŸç§æƒ…å†µå¯¼è‡´è¿™æ¬¡çš„æ‰§è¡Œæ—¶é—´è¿‡ç¨‹ï¼Œæœ€åŽå¯¼è‡´systemCurrentTime&gt;= scheduledExecutionTime(n+1)ï¼Œè¿™æ˜¯ç¬¬n+1ä¸ªtaskå¹¶ä¸ä¼šå› ä¸ºåˆ°æ—¶äº†è€Œæ‰§è¡Œï¼Œä»–ä¼šç­‰å¾…ç¬¬nä¸ªtaskæ‰§è¡Œå®Œä¹‹åŽå†æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™æ ·åŠ¿å¿…ä¼šå¯¼è‡´n+2ä¸ªçš„æ‰§è¡Œå®žçŽ°scheduledExecutionTimeæ”¾ç”Ÿæ”¹å˜å³scheduledExecutionTime(n+2) = realExecutionTime(n+1)+periodTimeã€‚æ‰€ä»¥è¿™ä¸¤ä¸ªæ–¹æ³•æ›´åŠ æ³¨é‡ä¿å­˜é—´éš”æ—¶é—´çš„ç¨³å®šã€‚ 3ã€scheduleAtFixedRate(TimerTask task, Date firstTime, long period)ã€scheduleAtFixedRate(TimerTask task, long delay, long period) åœ¨å‰é¢ä¹Ÿæè¿‡scheduleAtFixedRateä¸Žscheduleæ–¹æ³•çš„ä¾§é‡ç‚¹ä¸åŒï¼Œscheduleæ–¹æ³•ä¾§é‡ä¿å­˜é—´éš”æ—¶é—´çš„ç¨³å®šï¼Œè€ŒscheduleAtFixedRateæ–¹æ³•æ›´åŠ ä¾§é‡äºŽä¿æŒæ‰§è¡Œé¢‘çŽ‡çš„ç¨³å®šã€‚ä¸ºä»€ä¹ˆè¿™ä¹ˆè¯´ï¼ŒåŽŸå› å¦‚ä¸‹ã€‚åœ¨scheduleæ–¹æ³•ä¸­ä¼šå› ä¸ºå‰ä¸€ä¸ªä»»åŠ¡çš„å»¶è¿Ÿè€Œå¯¼è‡´å…¶åŽé¢çš„å®šæ—¶ä»»åŠ¡å»¶æ—¶ï¼Œè€ŒscheduleAtFixedRateæ–¹æ³•åˆ™ä¸ä¼šï¼Œå¦‚æžœç¬¬nä¸ªtaskæ‰§è¡Œæ—¶é—´è¿‡é•¿å¯¼è‡´systemCurrentTime&gt;= scheduledExecutionTime(n+1)ï¼Œåˆ™ä¸ä¼šåšä»»ä½•ç­‰å¾…ä»–ä¼šç«‹å³æ‰§è¡Œç¬¬n+1ä¸ªtaskï¼Œæ‰€ä»¥scheduleAtFixedRateæ–¹æ³•æ‰§è¡Œæ—¶é—´çš„è®¡ç®—æ–¹æ³•ä¸åŒäºŽscheduleï¼Œè€Œæ˜¯scheduledExecutionTime(n)=firstExecuteTime +n*periodTimeï¼Œè¯¥è®¡ç®—æ–¹æ³•æ°¸è¿œä¿æŒä¸å˜ã€‚æ‰€ä»¥scheduleAtFixedRateæ›´åŠ ä¾§é‡äºŽä¿æŒæ‰§è¡Œé¢‘çŽ‡çš„ç¨³å®šã€‚ Timerçš„ç¼ºé™·Timerçš„ç¼ºé™· Timerè®¡æ—¶å™¨å¯ä»¥å®šæ—¶ï¼ˆæŒ‡å®šæ—¶é—´æ‰§è¡Œä»»åŠ¡ï¼‰ã€å»¶è¿Ÿï¼ˆå»¶è¿Ÿ5ç§’æ‰§è¡Œä»»åŠ¡ï¼‰ã€å‘¨æœŸæ€§åœ°æ‰§è¡Œä»»åŠ¡ï¼ˆæ¯éš”ä¸ª1ç§’æ‰§è¡Œä»»åŠ¡ï¼‰ï¼Œä½†æ˜¯ï¼ŒTimerå­˜åœ¨ä¸€äº›ç¼ºé™·ã€‚é¦–å…ˆTimerå¯¹è°ƒåº¦çš„æ”¯æŒæ˜¯åŸºäºŽç»å¯¹æ—¶é—´çš„ï¼Œè€Œä¸æ˜¯ç›¸å¯¹æ—¶é—´ï¼Œæ‰€ä»¥å®ƒå¯¹ç³»ç»Ÿæ—¶é—´çš„æ”¹å˜éžå¸¸æ•æ„Ÿã€‚å…¶æ¬¡Timerçº¿ç¨‹æ˜¯ä¸ä¼šæ•èŽ·å¼‚å¸¸çš„ï¼Œå¦‚æžœTimerTaskæŠ›å‡ºçš„äº†æœªæ£€æŸ¥å¼‚å¸¸åˆ™ä¼šå¯¼è‡´Timerçº¿ç¨‹ç»ˆæ­¢ï¼ŒåŒæ—¶Timerä¹Ÿä¸ä¼šé‡æ–°æ¢å¤çº¿ç¨‹çš„æ‰§è¡Œï¼Œä»–ä¼šé”™è¯¯çš„ï¿½ï¿½ï¿½ä¸ºæ•´ä¸ªTimerçº¿ç¨‹éƒ½ä¼šå–æ¶ˆã€‚åŒæ—¶ï¼Œå·²ç»è¢«å®‰æŽ’å•å°šæœªæ‰§è¡Œçš„TimerTaskä¹Ÿä¸ä¼šå†æ‰§è¡Œäº†ï¼Œæ–°çš„ä»»åŠ¡ä¹Ÿä¸èƒ½è¢«è°ƒåº¦ã€‚æ•…å¦‚æžœTimerTaskæŠ›å‡ºæœªæ£€æŸ¥çš„å¼‚å¸¸ï¼ŒTimerå°†ä¼šäº§ç”Ÿæ— æ³•é¢„æ–™çš„è¡Œä¸ºã€‚ 1ã€Timerç®¡ç†æ—¶é—´å»¶è¿Ÿç¼ºé™· å‰é¢Timeråœ¨æ‰§è¡Œå®šæ—¶ä»»åŠ¡æ—¶åªä¼šåˆ›å»ºä¸€ä¸ªçº¿ç¨‹ä»»åŠ¡ï¼Œå¦‚æžœå­˜åœ¨å¤šä¸ªçº¿ç¨‹ï¼Œè‹¥å…¶ä¸­æŸä¸ªçº¿ç¨‹å› ä¸ºæŸç§åŽŸå› è€Œå¯¼è‡´çº¿ç¨‹ä»»åŠ¡æ‰§è¡Œæ—¶é—´è¿‡é•¿ï¼Œè¶…è¿‡äº†ä¸¤ä¸ªä»»åŠ¡çš„é—´éš”æ—¶é—´ï¼Œä¼šå‘ç”Ÿä¸€äº›ç¼ºé™·ï¼š 12345678910111213141516171819202122232425262728293031323334public class TimerTest04 &#123; private Timer timer; public long start; public TimerTest04()&#123; this.timer = new Timer(); start = System.currentTimeMillis(); &#125; public void timerOne()&#123; timer.schedule(new TimerTask() &#123; public void run() &#123; System.out.println("timerOne invoked ,the time:" + (System.currentTimeMillis() - start)); try &#123; Thread.sleep(4000); //çº¿ç¨‹ä¼‘çœ 3000 &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;, 1000); &#125; public void timerTwo()&#123; timer.schedule(new TimerTask() &#123; public void run() &#123; System.out.println("timerOne invoked ,the time:" + (System.currentTimeMillis() - start)); &#125; &#125;, 3000); &#125; public static void main(String[] args) throws Exception &#123; TimerTest04 test = new TimerTest04(); test.timerOne(); test.timerTwo(); &#125;&#125; æŒ‰ç…§æˆ‘ä»¬æ­£å¸¸æ€è·¯ï¼ŒtimerTwoåº”è¯¥æ˜¯åœ¨3såŽæ‰§è¡Œï¼Œå…¶ç»“æžœåº”è¯¥æ˜¯ï¼š timerOne invoked ,the time:1001timerOne invoked ,the time:3001ä½†æ˜¯äº‹ä¸Žæ„¿è¿ï¼ŒtimerOneç”±äºŽsleep(4000)ï¼Œä¼‘çœ äº†4Sï¼ŒåŒæ—¶Timerå†…éƒ¨æ˜¯ä¸€ä¸ªçº¿ç¨‹ï¼Œå¯¼è‡´timeOneæ‰€éœ€çš„æ—¶é—´è¶…è¿‡äº†é—´éš”æ—¶é—´ï¼Œç»“æžœï¼š timerOne invoked ,the time:1000timerOne invoked ,the time:5000 2ã€TimeræŠ›å‡ºå¼‚å¸¸ç¼ºé™· å¦‚æžœTimerTaskæŠ›å‡ºRuntimeExceptionï¼ŒTimerä¼šç»ˆæ­¢æ‰€æœ‰ä»»åŠ¡çš„è¿è¡Œã€‚å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425public class TimerTest04 &#123; private Timer timer; public TimerTest04()&#123; this.timer = new Timer(); &#125; public void timerOne()&#123; timer.schedule(new TimerTask() &#123; public void run() &#123; throw new RuntimeException(); &#125; &#125;, 1000); &#125; public void timerTwo()&#123; timer.schedule(new TimerTask() &#123; public void run() &#123; System.out.println("æˆ‘ä¼šä¸ä¼šæ‰§è¡Œå‘¢ï¼Ÿï¼Ÿ"); &#125; &#125;, 1000); &#125; public static void main(String[] args) &#123; TimerTest04 test = new TimerTest04(); test.timerOne(); test.timerTwo(); &#125;&#125; è¿è¡Œç»“æžœï¼štimerOneæŠ›å‡ºå¼‚å¸¸ï¼Œå¯¼è‡´timerTwoä»»åŠ¡ç»ˆæ­¢ã€‚ Exception in thread â€œTimer-0â€ java.lang.RuntimeException at com.chenssy.timer.TimerTest04$1.run(TimerTest04.java:25) at java.util.TimerThread.mainLoop(Timer.java:555) at java.util.TimerThread.run(Timer.java:505) å¯¹äºŽTimerçš„ç¼ºé™·ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ ScheduledThreadPoolExecutor æ¥æ›¿ä»£ã€‚Timeræ˜¯åŸºäºŽç»å¯¹æ—¶é—´çš„ï¼Œå¯¹ç³»ç»Ÿæ—¶é—´æ¯”è¾ƒæ•æ„Ÿï¼Œè€ŒScheduledThreadPoolExecutor åˆ™æ˜¯åŸºäºŽç›¸å¯¹æ—¶é—´ï¼›Timeræ˜¯å†…éƒ¨æ˜¯å•ä¸€çº¿ç¨‹ï¼Œè€ŒScheduledThreadPoolExecutorå†…éƒ¨æ˜¯ä¸ªçº¿ç¨‹æ± ï¼Œæ‰€ä»¥å¯ä»¥æ”¯æŒå¤šä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œã€‚ ç”¨ScheduledExecutorServiceæ›¿ä»£Timer è§£å†³é—®é¢˜ä¸€ï¼š 123456789101112131415161718192021222324252627282930313233public class ScheduledExecutorTest &#123; private ScheduledExecutorService scheduExec; public long start; ScheduledExecutorTest()&#123; this.scheduExec = Executors.newScheduledThreadPool(2); this.start = System.currentTimeMillis(); &#125; public void timerOne()&#123; scheduExec.schedule(new Runnable() &#123; public void run() &#123; System.out.println("timerOne,the time:" + (System.currentTimeMillis() - start)); try &#123; Thread.sleep(4000); &#125; catch (InterruptedException e) &#123; e.printStackTrace(); &#125; &#125; &#125;,1000,TimeUnit.MILLISECONDS); &#125; public void timerTwo()&#123; scheduExec.schedule(new Runnable() &#123; public void run() &#123; System.out.println("timerTwo,the time:" + (System.currentTimeMillis() - start)); &#125; &#125;,2000,TimeUnit.MILLISECONDS); &#125; public static void main(String[] args) &#123; ScheduledExecutorTest test = new ScheduledExecutorTest(); test.timerOne(); test.timerTwo(); &#125;&#125; ç»“æžœï¼š timerOne,the time:1003timerTwo,the time:2005 123456789101112131415161718192021222324252627public class ScheduledExecutorTest &#123; private ScheduledExecutorService scheduExec; public long start; ScheduledExecutorTest()&#123; this.scheduExec = Executors.newScheduledThreadPool(2); this.start = System.currentTimeMillis(); &#125; public void timerOne()&#123; scheduExec.schedule(new Runnable() &#123; public void run() &#123; throw new RuntimeException(); &#125; &#125;,1000,TimeUnit.MILLISECONDS); &#125; public void timerTwo()&#123; scheduExec.scheduleAtFixedRate(new Runnable() &#123; public void run() &#123; System.out.println("timerTwo invoked ....."); &#125; &#125;,2000,500,TimeUnit.MILLISECONDS); &#125; public static void main(String[] args) &#123; ScheduledExecutorTest test = new ScheduledExecutorTest(); test.timerOne(); test.timerTwo(); &#125;&#125; ç»“æžœï¼š timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦..timerTwo invoked â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦â€¦..]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ActiveMQ+Springå·¥ç¨‹åˆ›å»ºè¯¦è§£ï¼ˆé™„å·¥ç¨‹æ–‡ä»¶ï¼‰]]></title>
    <url>%2F2016%2F05%2F19%2Factivemq20160519%2F</url>
    <content type="text"><![CDATA[ActiveMQæ˜¯Apacheæ‰€æä¾›çš„ä¸€ä¸ªå¼€æºçš„æ¶ˆæ¯ç³»ç»Ÿï¼Œå®Œå…¨é‡‡ç”¨Javaæ¥å®žçŽ°ï¼Œå› æ­¤ï¼Œå®ƒèƒ½å¾ˆå¥½åœ°æ”¯æŒJ2EEæå‡ºçš„JMSï¼ˆJava Message Service,å³Javaæ¶ˆæ¯æœåŠ¡ï¼‰è§„èŒƒã€‚JMSæ˜¯ä¸€ç»„Javaåº”ç”¨ç¨‹åºæŽ¥å£ï¼Œå®ƒæä¾›æ¶ˆæ¯çš„åˆ›å»ºã€å‘é€ã€è¯»å–ç­‰ä¸€ç³»åˆ—æœåŠ¡ã€‚JMSæä¾›äº†ä¸€ç»„å…¬å…±åº”ç”¨ç¨‹åºæŽ¥å£å’Œå“åº”çš„è¯­æ³•ï¼Œç±»ä¼¼äºŽJavaæ•°æ®åº“çš„ç»Ÿä¸€è®¿é—®æŽ¥å£JDBC,å®ƒæ˜¯ä¸€ç§ä¸ŽåŽ‚å•†æ— å…³çš„APIï¼Œä½¿å¾—Javaç¨‹åºèƒ½å¤Ÿä¸Žä¸åŒåŽ‚å•†çš„æ¶ˆæ¯ç»„ä»¶å¾ˆå¥½åœ°è¿›è¡Œé€šä¿¡ã€‚ JMSæ”¯æŒä¸¤ç§æ¶ˆæ¯å‘é€å’ŒæŽ¥æ”¶æ¨¡åž‹ã€‚ä¸€ç§ç§°ä¸ºP2P(Ponit to Point)æ¨¡åž‹ï¼Œå³é‡‡ç”¨ç‚¹å¯¹ç‚¹çš„æ–¹å¼å‘é€æ¶ˆæ¯ã€‚P2Pæ¨¡åž‹æ˜¯åŸºäºŽé˜Ÿåˆ—çš„ï¼Œæ¶ˆæ¯ç”Ÿäº§è€…å‘é€æ¶ˆæ¯åˆ°é˜Ÿåˆ—ï¼Œæ¶ˆæ¯æ¶ˆè´¹è€…ä»Žé˜Ÿåˆ—ä¸­æŽ¥æ”¶æ¶ˆæ¯ï¼Œé˜Ÿåˆ—çš„å­˜åœ¨ä½¿å¾—æ¶ˆæ¯çš„å¼‚æ­¥ä¼ è¾“ç§°ä¸ºå¯èƒ½ï¼ŒP2Pæ¨¡åž‹åœ¨ç‚¹å¯¹ç‚¹çš„æƒ…å†µä¸‹è¿›è¡Œæ¶ˆæ¯ä¼ é€’æ—¶é‡‡ç”¨ã€‚ å¦ä¸€ç§ç§°ä¸ºPub/Sub(Publish/Subscribeï¼Œå³å‘å¸ƒ-è®¢é˜…)æ¨¡åž‹ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡åž‹å®šä¹‰äº†å¦‚ä½•å‘ä¸€ä¸ªå†…å®¹èŠ‚ç‚¹å‘å¸ƒå’Œè®¢é˜…æ¶ˆæ¯ï¼Œè¿™ä¸ªå†…å®¹èŠ‚ç‚¹ç§°ä¸ºtopic(ä¸»é¢˜)ã€‚ä¸»é¢˜å¯ä»¥è®¤ä¸ºæ˜¯æ¶ˆæ¯ä¼ é€’çš„ä¸­ä»‹ï¼Œæ¶ˆæ¯å‘å¸ƒè¿™å°†æ¶ˆæ¯å‘å¸ƒåˆ°æŸä¸ªä¸»é¢˜ï¼Œè€Œæ¶ˆæ¯è®¢é˜…è€…åˆ™ä»Žä¸»é¢˜è®¢é˜…æ¶ˆæ¯ã€‚ä¸»é¢˜ä½¿å¾—æ¶ˆæ¯çš„è®¢é˜…è€…ä¸Žæ¶ˆæ¯çš„å‘å¸ƒè€…äº’ç›¸ä¿æŒç‹¬ç«‹ï¼Œä¸éœ€è¦è¿›è¡ŒæŽ¥è§¦å³å¯ä¿è¯æ¶ˆæ¯çš„ä¼ é€’ï¼Œå‘å¸ƒ-è®¢é˜…æ¨¡åž‹åœ¨æ¶ˆæ¯çš„ä¸€å¯¹å¤šå¹¿æ’­æ—¶é‡‡ç”¨ã€‚ ActiveMQçš„å®‰è£…ä¸‹è½½æœ€æ–°çš„å®‰è£…åŒ…apache-activemq-5.13.2-bin.tar.gz ä¸‹è½½ä¹‹åŽè§£åŽ‹ï¼š tar -zvxf apache-activemq-5.13.2-bin.tar.gz ActiveMQç›®å½•å†…å®¹æœ‰ï¼š binç›®å½•åŒ…å«ActiveMQçš„å¯åŠ¨è„šæœ¬ confç›®å½•åŒ…å«ActiveMQçš„æ‰€æœ‰é…ç½®æ–‡ä»¶ dataç›®å½•åŒ…å«æ—¥å¿—æ–‡ä»¶å’ŒæŒä¹…æ€§æ¶ˆæ¯æ•°æ® example: ActiveMQçš„ç¤ºä¾‹ lib: ActiveMQè¿è¡Œæ‰€éœ€è¦çš„lib webapps: ActiveMQçš„webæŽ§åˆ¶å°å’Œä¸€äº›ç›¸å…³çš„demo ActiveMQçš„é»˜è®¤æœåŠ¡ç«¯å£ä¸º61616ï¼Œè¿™ä¸ªå¯ä»¥åœ¨conf/activemq.xmlé…ç½®æ–‡ä»¶ä¸­ä¿®æ”¹ï¼š 1234&lt;transportConnectors&gt; &lt;!-- DOS protection, limit concurrent connections to 1000 and frame size to 100MB --&gt; &lt;transportConnector name="openwire" uri="tcp://0.0.0.0:61616?maximumConnections=1000&amp;amp;wireFormat.maxFrameSize=104857600"/&gt;&lt;/transportConnectors&gt; JMSçš„è§„èŒƒæµç¨‹ èŽ·å¾—JMS connection factory. é€šè¿‡æˆ‘ä»¬æä¾›ç‰¹å®šçŽ¯å¢ƒçš„è¿žæŽ¥ä¿¡æ¯æ¥æž„é€ factoryã€‚ åˆ©ç”¨factoryæž„é€ JMS connection å¯åŠ¨connection é€šè¿‡connectionåˆ›å»ºJMS session. æŒ‡å®šJMS destination. åˆ›å»ºJMS produceræˆ–è€…åˆ›å»ºJMS messageå¹¶æä¾›destination. åˆ›å»ºJMS consumeræˆ–æ³¨å†ŒJMS message listener. å‘é€å’ŒæŽ¥æ”¶JMS message. å…³é—­æ‰€æœ‰JMSèµ„æºï¼ŒåŒ…æ‹¬connection, session, producer, consumerç­‰ã€‚ æ¡ˆä¾‹ï¼ˆæ•´åˆSpringï¼‰pom.xml 123456789101112131415161718192021&lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;4.11&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.apache.activemq&lt;/groupId&gt; &lt;artifactId&gt;activemq-all&lt;/artifactId&gt; &lt;version&gt;5.11.1&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;4.1.4.RELEASE&lt;/version&gt;&lt;/dependency&gt;&lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;4.1.4.RELEASE&lt;/version&gt;&lt;/dependency&gt; Queueç±»åž‹æ¶ˆæ¯ springé…ç½®æ–‡ä»¶ 123456789101112131415161718192021222324252627282930&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;!-- é…ç½®JMSè¿žæŽ¥å·¥åŽ‚ --&gt; &lt;bean id="connectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory"&gt; &lt;!-- ActiveMQæœåŠ¡çš„åœ°å€å’Œç«¯å£--&gt; &lt;property name="brokerURL" value="failover:(tcp://192.168.147.131:61616)" /&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆQueueï¼‰ --&gt; &lt;bean id="queueDestination" class="org.apache.activemq.command.ActiveMQQueue"&gt; &lt;!-- è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„åå­— --&gt; &lt;constructor-arg&gt; &lt;value&gt;testSpringQueue&lt;/value&gt; &lt;/constructor-arg&gt; &lt;/bean&gt;&lt;!-- å®šä¹‰æ¶ˆæ¯å‘å¸ƒï¼ˆPub/Subï¼‰ --&gt;&lt;!-- &lt;bean id="topicDestination" class="org.apache.activemq.command.ActiveMQTopic"&gt; --&gt;&lt;!-- &lt;constructor-arg&gt; --&gt;&lt;!-- &lt;value&gt;topic&lt;/value&gt; --&gt;&lt;!-- &lt;/constructor-arg&gt; --&gt;&lt;!-- &lt;/bean&gt; --&gt; &lt;!-- é…ç½®JMSæ¨¡æ¿ï¼ˆQueueï¼‰ï¼ŒSpringæä¾›çš„JMSå·¥å…·ç±»ï¼Œå®ƒå‘é€ã€æŽ¥æ”¶æ¶ˆæ¯ã€‚ --&gt; &lt;bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate"&gt; &lt;property name="connectionFactory" ref="connectionFactory" /&gt; &lt;property name="defaultDestination" ref="queueDestination" /&gt; &lt;property name="receiveTimeout" value="10000" /&gt; &lt;/bean&gt;&lt;/beans&gt; æŽ¨é€ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839package com.mq.spring.queue;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.jms.core.JmsTemplate;import org.springframework.jms.core.MessageCreator;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import javax.annotation.Resource;import javax.jms.*;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations=&#123;"classpath:spring-mq-queue.xml"&#125;)public class QueueSender &#123; @Resource private JmsTemplate jmsTemplate; @Test public void send()&#123; sendMqMessage(null,"spring activemq queue type message !"); &#125; /** * è¯´æ˜Ž:å‘é€çš„æ—¶å€™å¦‚æžœè¿™é‡Œæ²¡æœ‰æ˜¾ç¤ºçš„æŒ‡å®šdestination.å°†ç”¨spring xmlä¸­é…ç½®çš„destination * @param destination * @param message */ public void sendMqMessage(Destination destination, final String message)&#123; if(null == destination)&#123; destination = jmsTemplate.getDefaultDestination(); &#125; jmsTemplate.send(destination, new MessageCreator() &#123; public Message createMessage(Session session) throws JMSException &#123; return session.createTextMessage(message); &#125; &#125;); System.out.println("spring send message..."); &#125; public void setJmsTemplate(JmsTemplate jmsTemplate) &#123; this.jmsTemplate = jmsTemplate; &#125;&#125; æ¶ˆè´¹ä»£ç  123456789101112131415161718192021222324252627282930313233343536package com.mq.spring.queue;import org.junit.Test;import javax.jms.*;import org.junit.runner.RunWith;import org.springframework.jms.core.JmsTemplate;import org.springframework.jms.core.MessageCreator;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import javax.annotation.Resource;import javax.jms.Message;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations=&#123;"classpath:spring-mq-queue.xml"&#125;)public class QueueReceiver &#123; @Resource private JmsTemplate jmsTemplate; @Test public void receiveMqMessage()&#123; Destination destination = jmsTemplate.getDefaultDestination(); receive(destination); &#125; /** * æŽ¥å—æ¶ˆæ¯ */ public void receive(Destination destination) &#123; TextMessage tm = (TextMessage) jmsTemplate.receive(destination); try &#123; System.out.println("ä»Žé˜Ÿåˆ—" + destination.toString() + "æ”¶åˆ°äº†æ¶ˆæ¯ï¼š\t" + tm.getText()); &#125; catch (JMSException e) &#123; e.printStackTrace(); &#125; &#125; public void setJmsTemplate(JmsTemplate jmsTemplate) &#123; this.jmsTemplate = jmsTemplate; &#125;&#125; è¯´æ˜Ž:ä¸Šé¢çš„ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…ä½¿ç”¨åŒä¸€å¥—é…ç½®æ–‡ä»¶,ä½¿ç”¨ç‹¬ç«‹çš„ç¨‹åºåŽ»æŽ¥æ”¶æ¶ˆæ¯,spring jmsä¹Ÿæä¾›äº†æ¶ˆæ¯ç›‘å¬å¤„ç†.æŽ¥ä¸‹æ¥æˆ‘ä»¬æ¢æˆç›‘å¬å¼æ¶ˆè´¹ é…ç½®æ–‡ä»¶ 12345678910111213141516171819202122232425&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;!-- é…ç½®JMSè¿žæŽ¥å·¥åŽ‚ --&gt; &lt;bean id="connectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory"&gt; &lt;property name="brokerURL" value="failover:(tcp://192.168.147.131:61616)" /&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆQueueï¼‰ --&gt; &lt;bean id="queueDestination" class="org.apache.activemq.command.ActiveMQQueue"&gt; &lt;!-- è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„åå­— --&gt; &lt;constructor-arg&gt; &lt;value&gt;testSpringQueue&lt;/value&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- é…ç½®æ¶ˆæ¯é˜Ÿåˆ—ç›‘å¬è€…ï¼ˆQueueï¼‰ --&gt; &lt;bean id="consumerMessageListener" class="com.mq.spring.queue.ConsumerMessageListener" /&gt; &lt;!-- æ¶ˆæ¯ç›‘å¬å®¹å™¨ï¼ˆQueueï¼‰ï¼Œé…ç½®è¿žæŽ¥å·¥åŽ‚ï¼Œç›‘å¬çš„é˜Ÿåˆ—æ˜¯testSpringQueueï¼Œç›‘å¬å™¨æ˜¯ä¸Šé¢å®šä¹‰çš„ç›‘å¬å™¨ --&gt; &lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt; &lt;property name="connectionFactory" ref="connectionFactory" /&gt; &lt;property name="destination" ref="queueDestination" /&gt; &lt;property name="messageListener" ref="consumerMessageListener" /&gt; &lt;/bean&gt;&lt;/beans&gt; ç›‘å¬å™¨ä»£ç  1234567891011public class ConsumerMessageListener implements MessageListener&#123; @Override public void onMessage(Message message) &#123; TextMessage tm = (TextMessage) message; try &#123; System.out.println("ConsumerMessageListeneræ”¶åˆ°äº†æ–‡æœ¬æ¶ˆæ¯ï¼š\t" + tm.getText()); &#125; catch (JMSException e) &#123; e.printStackTrace(); &#125; &#125;&#125; è¿™æ ·æˆ‘ä»¬çš„æ¶ˆæ¯æ¶ˆè´¹å°±å¯ä»¥åœ¨ç›‘å¬å™¨ä¸­å¤„ç†æ¶ˆè´¹äº†.ç”Ÿäº§çš„ä»£ç ä¸å˜,ä¿®æ”¹å‘é€è€…çš„æ¶ˆæ¯ä½“å†…å®¹,æ‰§è¡Œç”Ÿäº§ç¨‹åº Topicç±»åž‹æ¶ˆæ¯ åœ¨ä½¿ç”¨ Spring JMSçš„æ—¶å€™ï¼Œä¸»é¢˜ï¼ˆ Topicï¼‰å’Œé˜Ÿåˆ—æ¶ˆæ¯çš„ä¸»è¦å·®å¼‚ä½“çŽ°åœ¨JmsTemplateä¸­ â€œpubSubDomainâ€æ˜¯å¦è®¾ç½®ä¸º Trueã€‚å¦‚æžœä¸º Trueï¼Œåˆ™æ˜¯ Topicï¼›å¦‚æžœæ˜¯falseæˆ–è€…é»˜è®¤ï¼Œåˆ™æ˜¯ queueã€‚ 1&lt;property name="pubSubDomain" value="true" /&gt; topicç±»åž‹æ¶ˆè´¹é…ç½®æ–‡ä»¶è¯´æ˜Ž 123456789101112131415161718192021222324252627282930313233&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd"&gt; &lt;!-- é…ç½®JMSè¿žæŽ¥å·¥åŽ‚ --&gt; &lt;bean id="connectionFactory" class="org.apache.activemq.ActiveMQConnectionFactory"&gt; &lt;property name="brokerURL" value="failover:(tcp://192.168.147.131:61616)" /&gt; &lt;/bean&gt; &lt;!-- å®šä¹‰æ¶ˆæ¯Destination --&gt; &lt;bean id="destination" class="org.apache.activemq.command.ActiveMQQueue"&gt; &lt;!-- è®¾ç½®æ¶ˆæ¯é˜Ÿåˆ—çš„åå­— --&gt; &lt;constructor-arg&gt; &lt;value&gt;testSpringTopic&lt;/value&gt; &lt;/constructor-arg&gt; &lt;/bean&gt; &lt;!-- é…ç½®JMSæ¨¡æ¿ï¼ˆQueueï¼‰ï¼ŒSpringæä¾›çš„JMSå·¥å…·ç±»ï¼Œå®ƒå‘é€ã€æŽ¥æ”¶æ¶ˆæ¯ã€‚ --&gt; &lt;bean id="jmsTemplate" class="org.springframework.jms.core.JmsTemplate"&gt; &lt;property name="connectionFactory" ref="connectionFactory" /&gt; &lt;property name="defaultDestination" ref="destination" /&gt; &lt;property name="receiveTimeout" value="10000" /&gt; &lt;/bean&gt; &lt;!-- é…ç½®æ¶ˆæ¯æ¶ˆè´¹ç›‘å¬è€… --&gt; &lt;bean id="consumerMessageListener" class="com.mq.spring.topic.ConsumerMessageListener" /&gt; &lt;!-- æ¶ˆæ¯ç›‘å¬å®¹å™¨ï¼Œé…ç½®è¿žæŽ¥å·¥åŽ‚,ç›‘å¬å™¨æ˜¯ä¸Šé¢å®šä¹‰çš„ç›‘å¬å™¨ --&gt; &lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt; &lt;property name="connectionFactory" ref="connectionFactory" /&gt; &lt;property name="destination" ref="destination" /&gt; &lt;!--ä¸»é¢˜ï¼ˆTopicï¼‰å’Œé˜Ÿåˆ—æ¶ˆæ¯çš„ä¸»è¦å·®å¼‚ä½“çŽ°åœ¨JmsTemplateä¸­"pubSubDomain"æ˜¯å¦è®¾ç½®ä¸ºTrueã€‚å¦‚æžœä¸ºTrueï¼Œåˆ™æ˜¯Topicï¼›å¦‚æžœæ˜¯falseæˆ–è€…é»˜è®¤ï¼Œåˆ™æ˜¯queue--&gt; &lt;property name="pubSubDomain" value="true" /&gt; &lt;property name="messageListener" ref="consumerMessageListener" /&gt; &lt;/bean&gt;&lt;/beans&gt; ç”Ÿäº§è€…ä»£ç  123456789101112131415161718192021222324252627282930313233343536373839404142package com.mq.spring.topic;import org.junit.Test;import org.junit.runner.RunWith;import org.springframework.jms.core.JmsTemplate;import org.springframework.jms.core.MessageCreator;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;import javax.annotation.Resource;import javax.jms.Destination;import javax.jms.JMSException;import javax.jms.Message;import javax.jms.Session;@RunWith(SpringJUnit4ClassRunner.class)@ContextConfiguration(locations=&#123;"classpath:spring-mq-topic.xml"&#125;)public class TopicSender &#123; @Resource private JmsTemplate jmsTemplate; @Test public void send()&#123; sendMqMessage(null,"spring activemq topic type message[with listener] !"); &#125; /** * è¯´æ˜Ž:å‘é€çš„æ—¶å€™å¦‚æžœè¿™é‡Œæ²¡æœ‰æ˜¾ç¤ºçš„æŒ‡å®šdestination.å°†ç”¨spring xmlä¸­é…ç½®çš„destination * @param destination * @param message */ public void sendMqMessage(Destination destination, final String message)&#123; if(null == destination)&#123; destination = jmsTemplate.getDefaultDestination(); &#125; jmsTemplate.send(destination, new MessageCreator() &#123; public Message createMessage(Session session) throws JMSException &#123; return session.createTextMessage(message); &#125; &#125;); System.out.println("spring send message..."); &#125; public void setJmsTemplate(JmsTemplate jmsTemplate) &#123; this.jmsTemplate = jmsTemplate; &#125;&#125; ç›‘å¬å™¨ä»£ç  1234567891011public class ConsumerMessageListener implements MessageListener&#123; @Override public void onMessage(Message message) &#123; TextMessage tm = (TextMessage) message; try &#123; System.out.println("ConsumerMessageListeneræ”¶åˆ°äº†æ–‡æœ¬æ¶ˆæ¯ï¼š\t" + tm.getText()); &#125; catch (JMSException e) &#123; e.printStackTrace(); &#125; &#125;&#125; å‚è€ƒèµ„æ–™ http://www.importnew.com/19767.html http://blog.csdn.net/u013256816/article/details/51161548 http://www.tuicool.com/articles/FVf26b http://haohaoxuexi.iteye.com/blog/1893038 Spring+ActiveMQ+Mysql é…ç½®JMS â€‹]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Lambdaè®©ç¼–ç¨‹å˜å¾—ç®€å•]]></title>
    <url>%2F2016%2F05%2F18%2Flambda20160518%2F</url>
    <content type="text"><![CDATA[Lambdaç›¸å½“äºŽå°±æ˜¯ä¸€ä¸ªåŒ¿åæ–¹æ³•ï¼Œå…¶åœ¨ä»£æ›¿åŒ¿åå†…éƒ¨ç±»åˆ›å»ºå¯¹è±¡çš„æ—¶å€™ï¼ŒLambdaè¡¨è¾¾å¼ä»£ç å—ä¼šä»£æ›¿å®žçŽ°æŠ½è±¡æ–¹æ³•çš„æ–¹æ³•ä½“ Lambdaè¡¨è¾¾å¼çš„ç›®æ ‡ç±»åž‹å¿…é¡»æ˜¯â€œå‡½æ•°å¼æŽ¥å£(FunctionalInterface)â€ã€‚å‡½æ•°å¼æŽ¥å£åªèƒ½åŒ…å«ä¸€ä¸ªæŠ½è±¡æ–¹æ³•æŽ¥å£ã€‚å‡½æ•°å¼æŽ¥å£å¯ä»¥åŒ…å«å¤šä¸ªé»˜è®¤æ–¹æ³•ã€ç±»æ–¹æ³•ã€ä½†åªèƒ½ä¸€ä¸ªæŠ½è±¡æ–¹æ³• å‡½æ•°å¼æŽ¥å£ æœ‰ä¸”åªæœ‰ä¸€ä¸ªæ²¡æœ‰defaultå…³é”®å­—ä¿®é¥°çš„æŽ¥å£ å¯ä»¥å¤šä¸ªdefaultå…³é”®å­—çš„æŠ½è±¡æ–¹æ³•ã€ç±»æ–¹æ³•ã€å˜é‡ è¯­æ³•ç»„æˆå…ƒç´  å½¢å‚åˆ—è¡¨ã€‚å½¢å‚å¯ä»¥çœç•¥æ•°æ®ç±»åž‹ã€‚è‹¥åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œå¯ä»¥å°†åœ†æ‹¬å·çœç•¥ ç®­å¤´(-&gt;) ä»£ç å—ã€‚å¦‚æžœåªæœ‰ä¸€æ¡è¯­å¥ï¼ŒLambdaè¡¨è¾¾å¼å¯ä»¥çœç•¥èŠ±æ‹¬å·ã€‚ä»£ç å—åªèƒ½æœ‰ä¸€æ¡returnè¯­å¥ï¼Œå¹¶ä¸”å¯ä»¥çœç•¥returnå…³é”®å­— 12345678910public class Lam &#123; @FunctionalInterface interface Try&#123; Integer ss(); &#125; public static void main(String[] args) &#123; Try i=()-&gt;"sa".indexOf("a"); System.out.println(i.ss()); &#125;&#125; Lambdaçš„ä»£ç å—ä¸­å°±æ˜¯ç”¨æ¥å®žçŽ°æŽ¥å£çš„æŠ½è±¡æ–¹æ³•ï¼Œè€Œä¸”æœ‰ä¸”åªèƒ½æœ‰ä¸€ä¸ªã€‚è‹¥æœ‰defaultå…³é”®å­—çš„æŠ½è±¡æ–¹æ³•æ˜¯ä¸å±žäºŽå‡½æ•°å¼æŽ¥å£(FunctionalInterface) å­˜åœ¨@FunctionalInterfaceæ³¨è§£çš„ä¸€å®šæ˜¯å‡½æ•°å¼æŽ¥å£ï¼Œæ²¡æœ‰@FunctionalInterfaceä¸ä¸€å®šå°±ä¸æ˜¯å‡½æ•°å¼æŽ¥å£ 1234567891011121314151617public class Lam &#123; @FunctionalInterface interface Try &#123; String s = "1"; Integer ss(); default Integer bb() &#123; return 0; &#125; &#125; public static void main(String[] args) &#123; Try i = () -&gt; "sa".indexOf("a"); System.out.println(i.s); System.out.println(i.ss()); &#125;&#125; æ–¹æ³•å¼•ç”¨ä¸Žæž„é€ å™¨å¼•ç”¨ ç§ç±» ç¤ºä¾‹ è¯´æ˜Ž å¯¹åº”çš„Lambdaè¡¨è¾¾å¼ å¼•ç”¨ç±»æ–¹æ³• ç±»å::ç±»æ–¹æ³• å‡½æ•°å¼æŽ¥å£ä¸­å®žçŽ°çš„æ–¹æ³•çš„å…¨éƒ¨å‚æ•°éƒ½ä¼ é€’ç»™ç±»æ–¹æ³•ä½œä¸ºå‚æ•° (a,b,â€¦)-&gt;ç±»å.ç±»æ–¹æ³•(a,b,â€¦) ç‰¹å®šå¯¹è±¡çš„å®žä¾‹æ–¹æ³• å¯¹è±¡::å®žä¾‹æ–¹æ³• å‡½æ•°å¼æŽ¥å£ä¸­å®žçŽ°çš„æ–¹æ³•çš„å…¨éƒ¨å‚æ•°éƒ½ä¼ é€’ç»™ç±»æ–¹æ³•ä½œä¸ºå‚æ•° (a,b,â€¦)-&gt;å¯¹è±¡.å®žä¾‹æ–¹æ³•(a,b,â€¦) å¼•ç”¨æŸç±»å¯¹è±¡çš„å®žä¾‹æ–¹æ³• ç±»å::å®žä¾‹æ–¹æ³• å‡½æ•°å¼æŽ¥å£ä¸­å®žçŽ°çš„æ–¹æ³•ç¬¬ä¸€ä¸ªå‚æ•°ä½œä¸ºè°ƒç”¨è€…ï¼Œä¹‹åŽçš„å‚æ•°éƒ½ä½œä¸ºæ–¹æ³•çš„å‚æ•° (a,b,â€¦)-&gt;a.å®žä¾‹æ–¹æ³•(b,â€¦) å¼•ç”¨æž„é€ æ–¹æ³• ç±»å::new å‡½æ•°å¼æŽ¥å£ä¸­å®žçŽ°çš„æ–¹æ³•çš„å…¨éƒ¨å‚æ•°éƒ½ä¼ é€’ç»™ç±»æ–¹æ³•ä½œä¸ºå‚æ•° (a,b,â€¦)-&gt;ç±»å.new(a,b,â€¦) ä½¿ç”¨::è¿™ç§æ–¹å¼ï¼ŒæŠ½è±¡æ–¹æ³•è‚¯å®šæ˜¯å­˜åœ¨å‚æ•°çš„ å…¶å®žä¸Šé¢ä¸‰ç±»å¯ä»¥å½’ä¸ºä¸€ç±»æ¥çœ‹å¾…ï¼Œè¿™æ˜¯å½¢å¼ä¸åŒè€Œå·² 12345678910111213141516public class Lam &#123; @FunctionalInterface interface Try &#123; String s = "1"; Integer ss(String s); default Integer sb() &#123; return 0; &#125; &#125; public static void main(String[] args) &#123; Try i = "sa"::indexOf; System.out.println(i.s); System.out.println(i.ss("a")); &#125; å¼•ç”¨æž„é€ æ–¹æ³• 12345678910111213141516public class Lam &#123; @FunctionalInterface interface Try &#123; String s = "1"; String ss(String s); default Integer sb() &#123; return 0; &#125; &#125; public static void main(String[] args) &#123; Try i = String::new; System.out.println(i.s); System.out.println(i.ss("a")); &#125; ç­‰ä»·äºŽ 12345678910111213141516171819202122public class Lam &#123; @FunctionalInterface interface Try &#123; String s = "1"; String ss(String s); default Integer sb() &#123; return 0; &#125; &#125; public static void main(String[] args) &#123; Try i = new Try()&#123; @Override public String ss(String s) &#123; return new String(s); &#125; &#125;; System.out.println(i.s); System.out.println(i.ss("a")); &#125; Lambdaè¡¨è¾¾å¼ä¸ŽåŒ¿åå‡½æ•°çš„å¼‚åŒç‚¹åŒ Lambdaè¡¨è¾¾å¼ä¸ŽåŒ¿åå†…éƒ¨ç±»ä¸€æ ·ï¼Œéƒ½å¯ä»¥ç›´æŽ¥è®¿é—®â€œeffectivly finalâ€çš„å±€éƒ¨å˜é‡ï¼Œä»¥åŠå¤–éƒ¨ç±»çš„æˆå‘˜å˜é‡ï¼ˆåŒ…æ‹¬å®žä¾‹å˜é‡å’Œç±»å˜é‡ï¼‰ Lambdaè¡¨è¾¾å¼åˆ›å»ºçš„å¯¹è±¡ä¸ŽåŒ¿åå†…éƒ¨ç±»ç”Ÿæˆçš„å¯¹è±¡ä¸€æ ·ï¼Œéƒ½å¯ä»¥ç›´æŽ¥è°ƒç”¨ä»ŽæŽ¥å£ä¸­ç»§æ‰¿çš„é»˜è®¤æ–¹æ³• å¼‚ åŒ¿åå†…éƒ¨ç±»å¯ä»¥ä¸ºä»»æ„æŽ¥å£åˆ›å»ºå®žä¾‹â€”â€”ä¸ç®¡æŽ¥å£åŒ…å«å¤šå°‘æŠ½è±¡æ–¹æ³•ï¼Œåªè¦åŒ¿åå†…éƒ¨ç±»å®žçŽ°æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•å³å¯ï¼›ä½†Lambdaè¡¨è¾¾å¼åªèƒ½ä¸ºå‡½æ•°å¼æŽ¥å£åˆ›å»ºå®žä¾‹ åŒ¿åå†…éƒ¨ç±»å¯ä»¥ä¸ºæŠ½è±¡ç±»ç”šè‡³æ™®é€šç±»åˆ›å»ºå®žä¾‹ï¼›ä½†Lambdaè¡¨è¾¾å¼åªèƒ½ä¸ºå‡½æ•°å¼æŽ¥å£åˆ›å»ºå®žä¾‹ åŒ¿åå†…éƒ¨ç±»å®žçŽ°çš„æŠ½è±¡æ–¹æ³•çš„æ–¹æ³•ä½“è¿è¡Œè°ƒç”¨æŽ¥å£ä¸­å®šä¹‰çš„é»˜è®¤æ–¹æ³•ï¼›ä½†Lambdaè¡¨è¾¾å¼çš„ä»£ç å—ä¸å…è®¸è°ƒç”¨æŽ¥å£ä¸­å®šä¹‰çš„é»˜è®¤æ–¹æ³•]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Dubbo+SpringMVCå·¥ç¨‹åˆ›å»ºè¯¦è§£ï¼ˆé™„å·¥ç¨‹æ–‡ä»¶ï¼‰]]></title>
    <url>%2F2016%2F05%2F17%2Fdubbo20160517%2F</url>
    <content type="text"><![CDATA[Dubboå‡ºçŽ°çš„ç›®çš„æ˜¯ä¸ºäº†åº”å¯¹çŽ°åœ¨é«˜å¹¶å‘ï¼Œé«˜æ•°æ®é‡è¯·æ±‚çš„é—®é¢˜ã€‚ç›®å‰çš„åž‚ç›´åº”ç”¨æž¶æž„å·²ç»æ— æ³•æ»¡è¶³çŽ°åœ¨å¤§æ•°æ®çš„å†²å‡»ï¼ŒSOAå°±åº”è¿è€Œç”Ÿï¼Œè€ŒDubboåœ¨å›½å†…ä½¿ç”¨çš„è¿˜æ˜¯æ¯”è¾ƒå¤šï¼Œç¨³å®šæ€§ä¹Ÿæ¯”è¾ƒä¸é”™ã€‚ æž¶æž„ èŠ‚ç‚¹è§’è‰²è¯´æ˜Žï¼š Provider: æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ã€‚Consumer: è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ã€‚Registry: æœåŠ¡æ³¨å†Œä¸Žå‘çŽ°çš„æ³¨å†Œä¸­å¿ƒã€‚Monitor: ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æŽ§ä¸­å¿ƒã€‚Container: æœåŠ¡è¿è¡Œå®¹å™¨ã€‚ è°ƒç”¨å…³ç³»è¯´æ˜Žï¼š æœåŠ¡å®¹å™¨è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚ æœåŠ¡æä¾›è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚ æœåŠ¡æ¶ˆè´¹è€…åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚ æ³¨å†Œä¸­å¿ƒè¿”å›žæœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æžœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºŽé•¿è¿žæŽ¥æŽ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚ æœåŠ¡æ¶ˆè´¹è€…ï¼Œä»Žæä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºŽè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æžœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚ æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æŽ§ä¸­å¿ƒã€‚ (1) è¿žé€šæ€§ï¼š æ³¨å†Œä¸­å¿ƒè´Ÿè´£æœåŠ¡åœ°å€çš„æ³¨å†Œä¸ŽæŸ¥æ‰¾ï¼Œç›¸å½“äºŽç›®å½•æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åªåœ¨å¯åŠ¨æ—¶ä¸Žæ³¨å†Œä¸­å¿ƒäº¤äº’ï¼Œæ³¨å†Œä¸­å¿ƒä¸è½¬å‘è¯·æ±‚ï¼ŒåŽ‹åŠ›è¾ƒå° ç›‘æŽ§ä¸­å¿ƒè´Ÿè´£ç»Ÿè®¡å„æœåŠ¡è°ƒç”¨æ¬¡æ•°ï¼Œè°ƒç”¨æ—¶é—´ç­‰ï¼Œç»Ÿè®¡å…ˆåœ¨å†…å­˜æ±‡æ€»åŽæ¯åˆ†é’Ÿä¸€æ¬¡å‘é€åˆ°ç›‘æŽ§ä¸­å¿ƒæœåŠ¡å™¨ï¼Œå¹¶ä»¥æŠ¥è¡¨å±•ç¤º æœåŠ¡æä¾›è€…å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œå…¶æä¾›çš„æœåŠ¡ï¼Œå¹¶æ±‡æŠ¥è°ƒç”¨æ—¶é—´åˆ°ç›‘æŽ§ä¸­å¿ƒï¼Œæ­¤æ—¶é—´ä¸åŒ…å«ç½‘ç»œå¼€é”€ æœåŠ¡æ¶ˆè´¹è€…å‘æ³¨å†Œä¸­å¿ƒèŽ·å–æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ï¼Œå¹¶æ ¹æ®è´Ÿè½½ç®—æ³•ç›´æŽ¥è°ƒç”¨æä¾›è€…ï¼ŒåŒæ—¶æ±‡æŠ¥è°ƒç”¨æ—¶é—´åˆ°ç›‘æŽ§ä¸­å¿ƒï¼Œæ­¤æ—¶é—´åŒ…å«ç½‘ç»œå¼€é”€ æ³¨å†Œä¸­å¿ƒï¼ŒæœåŠ¡æä¾›è€…ï¼ŒæœåŠ¡æ¶ˆè´¹è€…ä¸‰è€…ä¹‹é—´å‡ä¸ºé•¿è¿žæŽ¥ï¼Œç›‘æŽ§ä¸­å¿ƒé™¤å¤– æ³¨å†Œä¸­å¿ƒé€šè¿‡é•¿è¿žæŽ¥æ„ŸçŸ¥æœåŠ¡æä¾›è€…çš„å­˜åœ¨ï¼ŒæœåŠ¡æä¾›è€…å®•æœºï¼Œæ³¨å†Œä¸­å¿ƒå°†ç«‹å³æŽ¨é€äº‹ä»¶é€šçŸ¥æ¶ˆè´¹è€… æ³¨å†Œä¸­å¿ƒå’Œç›‘æŽ§ä¸­å¿ƒå…¨éƒ¨å®•æœºï¼Œä¸å½±å“å·²è¿è¡Œçš„æä¾›è€…å’Œæ¶ˆè´¹è€…ï¼Œæ¶ˆè´¹è€…åœ¨æœ¬åœ°ç¼“å­˜äº†æä¾›è€…åˆ—è¡¨ æ³¨å†Œä¸­å¿ƒå’Œç›‘æŽ§ä¸­å¿ƒéƒ½æ˜¯å¯é€‰çš„ï¼ŒæœåŠ¡æ¶ˆè´¹è€…å¯ä»¥ç›´è¿žæœåŠ¡æä¾›è€… (2) å¥çŠ¶æ€§ï¼š ç›‘æŽ§ä¸­å¿ƒå®•æŽ‰ä¸å½±å“ä½¿ç”¨ï¼Œåªæ˜¯ä¸¢å¤±éƒ¨åˆ†é‡‡æ ·æ•°æ® æ•°æ®åº“å®•æŽ‰åŽï¼Œæ³¨å†Œä¸­å¿ƒä»èƒ½é€šè¿‡ç¼“å­˜æä¾›æœåŠ¡åˆ—è¡¨æŸ¥è¯¢ï¼Œä½†ä¸èƒ½æ³¨å†Œæ–°æœåŠ¡ æ³¨å†Œä¸­å¿ƒå¯¹ç­‰é›†ç¾¤ï¼Œä»»æ„ä¸€å°å®•æŽ‰åŽï¼Œå°†è‡ªåŠ¨åˆ‡æ¢åˆ°å¦ä¸€å° æ³¨å†Œä¸­å¿ƒå…¨éƒ¨å®•æŽ‰åŽï¼ŒæœåŠ¡æä¾›è€…å’ŒæœåŠ¡æ¶ˆè´¹è€…ä»èƒ½é€šè¿‡æœ¬åœ°ç¼“å­˜é€šè®¯ æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œä»»æ„ä¸€å°å®•æŽ‰åŽï¼Œä¸å½±å“ä½¿ç”¨ æœåŠ¡æä¾›è€…å…¨éƒ¨å®•æŽ‰åŽï¼ŒæœåŠ¡æ¶ˆè´¹è€…åº”ç”¨å°†æ— æ³•ä½¿ç”¨ï¼Œå¹¶æ— é™æ¬¡é‡è¿žç­‰å¾…æœåŠ¡æä¾›è€…æ¢å¤ (3) ä¼¸ç¼©æ€§ï¼š æ³¨å†Œä¸­å¿ƒä¸ºå¯¹ç­‰é›†ç¾¤ï¼Œå¯åŠ¨æ€å¢žåŠ æœºå™¨éƒ¨ç½²å®žä¾‹ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯å°†è‡ªåŠ¨å‘çŽ°æ–°çš„æ³¨å†Œä¸­å¿ƒ æœåŠ¡æä¾›è€…æ— çŠ¶æ€ï¼Œå¯åŠ¨æ€å¢žåŠ æœºå™¨éƒ¨ç½²å®žä¾‹ï¼Œæ³¨å†Œä¸­å¿ƒå°†æŽ¨é€æ–°çš„æœåŠ¡æä¾›è€…ä¿¡æ¯ç»™æ¶ˆè´¹è€… (4) å‡çº§æ€§ï¼š å½“æœåŠ¡é›†ç¾¤è§„æ¨¡è¿›ä¸€æ­¥æ‰©å¤§ï¼Œå¸¦åŠ¨ITæ²»ç†ç»“æž„è¿›ä¸€æ­¥å‡çº§ï¼Œéœ€è¦å®žçŽ°åŠ¨æ€éƒ¨ç½²ï¼Œè¿›è¡ŒæµåŠ¨è®¡ç®—ï¼ŒçŽ°æœ‰åˆ†å¸ƒå¼æœåŠ¡æž¶æž„ä¸ä¼šå¸¦æ¥é˜»åŠ›ï¼š å¯ä»¥å¾—å‡ºï¼Œæ³¨å†Œä¸­å¿ƒè‹¥å®•æœºï¼Œåªè¦æ²¡æœ‰æ³¨å†Œæ–°çš„æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…è¿˜æ˜¯å¯ä»¥æ ¹æ®æœ¬åœ°ç¼“å­˜è¿›è¡Œæ²Ÿé€šã€‚å¹¶ä¸”æ³¨å†Œä¸­å¿ƒä¸æ˜¯è¯·æ±‚è½¬å‘ä¸­å¿ƒï¼Œæ‰€ä»¥åŽ‹åŠ›æ˜¯æ¯”è¾ƒå°çš„ã€‚ æ­å»ºDubboå·¥ç¨‹1ã€ZooKeeperçš„é…ç½®å®‰è£… http://blog.csdn.net/u013142781/article/details/50395650 2ã€Dubbo-adminé…ç½®å®‰è£… http://blog.csdn.net/u013142781/article/details/50396621 3ã€å·¥ç¨‹APIå·¥ç¨‹åˆ›å»º å·¥ç¨‹ä½¿ç”¨Maven+SpringMVCçš„æ–¹å¼æž„å»º ITestService.java 12345package com.gege.service;public interface ITestService &#123; public String getName();&#125; DubboInit.java 1234567891011121314151617181920212223242526272829303132333435363738394041424344package com.gege.tool;import javax.servlet.ServletException;import javax.servlet.http.HttpServlet;import org.apache.commons.lang.exception.ExceptionUtils;import org.slf4j.Logger;import org.slf4j.LoggerFactory;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;public class DubboInit extends HttpServlet &#123; /** * */ private static final long serialVersionUID = 8279515033200832L; private Logger logger = (Logger) LoggerFactory.getLogger(DubboInit.class); /** * å¯åŠ¨dubboå®¹å™¨ */ public void init() throws ServletException &#123; try &#123; startApplicationContext(); &#125; catch (Exception e) &#123; e.printStackTrace(); logger.error(ExceptionUtils.getFullStackTrace(e)); &#125; &#125; public static ApplicationContext applicationContext = null; /** * å¯åŠ¨springå®¹å™¨ * @return */ public static ApplicationContext startApplicationContext() &#123; if (applicationContext == null) &#123; applicationContext = new ClassPathXmlApplicationContext("classpath*:applicationContext.xml"); &#125; return applicationContext; &#125;;&#125; pom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;api&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;spring.version&gt;3.2.8.RELEASE&lt;/spring.version&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;junit&lt;/groupId&gt; &lt;artifactId&gt;junit&lt;/artifactId&gt; &lt;version&gt;3.8.1&lt;/version&gt; &lt;scope&gt;test&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;servlet-api&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!-- springç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-orm&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-lang&lt;/groupId&gt; &lt;artifactId&gt;commons-lang&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;configuration&gt; &lt;source&gt;1.7&lt;/source&gt; &lt;target&gt;1.7&lt;/target&gt; &lt;encoding&gt;utf8&lt;/encoding&gt; &lt;fileNameMapping&gt;no-version&lt;/fileNameMapping&gt; &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/build&gt;&lt;/project&gt; 4ã€DubboæœåŠ¡æä¾›è€…å·¥ç¨‹åˆ›å»ºä¸Žé…ç½® å·¥ç¨‹ä½¿ç”¨Maven+SpringMVCçš„æ–¹å¼æž„å»º pom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;provider&lt;/artifactId&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;spring.version&gt;3.2.8.RELEASE&lt;/spring.version&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;!-- æ·»åŠ dubboä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;dubbo&lt;/artifactId&gt; &lt;version&gt;2.5.3&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;!-- æ·»åŠ zkå®¢æˆ·ç«¯ä¾èµ– --&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt; &lt;artifactId&gt;zkclient&lt;/artifactId&gt; &lt;version&gt;0.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- springç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-orm&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;api&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;servlet-api&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;1.2.14&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cglib&lt;/groupId&gt; &lt;artifactId&gt;cglib&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-lang&lt;/groupId&gt; &lt;artifactId&gt;commons-lang&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;taglibs&lt;/groupId&gt; &lt;artifactId&gt;standard&lt;/artifactId&gt; &lt;version&gt;1.1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;resources&gt; &lt;resource&gt; //é™æ€èµ„æºæ–‡ä»¶æ‰«æåœ°å€ &lt;directory&gt;$&#123;project.basedir&#125;/src/main/resources&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;*.*&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;/build&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;local&lt;/id&gt; &lt;properties&gt; //è¿™æ˜¯zookeeperçš„åœ°å€ï¼Œè¦æ ¹æ®å®žé™…æƒ…å†µè¿›è¡Œé…ç½®ï¼Œé»˜è®¤zookeeper://127.0.0.1:2181 &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; //dubboæš´éœ²çš„ç«¯å£é…ç½® &lt;dubbo.gege.port&gt;29014&lt;/dubbo.gege.port&gt; //å·¥ç¨‹çš„æœåŠ¡é›†åˆï¼Œ$&#123;user.name&#125;è¡¨ç¤ºå½“å‰PCçš„UserName &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; //dubboæœåŠ¡ç‰ˆæœ¬å· &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;dev&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.port&gt;29014&lt;/dubbo.gege.port&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;test&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.port&gt;29014&lt;/dubbo.gege.port&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;product&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.port&gt;29014&lt;/dubbo.gege.port&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; TestServiceImpl.java 123456789101112package com.gege.service.impl;import org.springframework.stereotype.Service;import com.gege.service.ITestService;@Servicepublic class TestServiceImpl implements ITestService &#123; public String getName() &#123; return "gege"; &#125;&#125; applicationContext.xml 1234567891011121314151617181920212223242526272829303132333435&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:task="http://www.springframework.org/schema/task" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd"&gt; &lt;task:annotation-driven /&gt; //æ³¨è§£æ‰«æ &lt;context:component-scan base-package="com.gege"/&gt; &lt;context:annotation-config /&gt; &lt;bean class="org.springframework.beans.factory.annotation.AutowiredAnnotationBeanPostProcessor" /&gt; &lt;bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt; &lt;property name="locations"&gt; &lt;list&gt; &lt;value&gt;classpath*:statics.properties&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;import resource="dubbo-provider.xml"/&gt; &lt;/beans&gt; dubbo-provider.xml 12345678910111213141516&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt; &lt;dubbo:application name="provider" /&gt; &lt;dubbo:registry protocol="dubbo" address="$&#123;dubbo.gege.address&#125;" port="$&#123;dubbo.gege.port&#125;" /&gt; &lt;dubbo:protocol name="dubbo" port="$&#123;dubbo.gege.port&#125;" /&gt; &lt;dubbo:monitor protocol="registry" /&gt; &lt;dubbo:service ref="testServiceImpl" interface="com.gege.service.ITestService" group="$&#123;dubbo.gege.group&#125;" version="$&#123;dubbo.gege.version&#125;"/&gt; &lt;/beans&gt; log4j.properties 1234567891011121314151617181920212223log4j.rootLogger=debug, stdout, Rlog4j.appender.stdout=org.apache.log4j.ConsoleAppenderlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout#Pattern to output the caller's file name and line number.log4j.appender.stdout.layout.ConversionPattern=[%d] %t (%F:%L) %-5p - %m%nlog4j.appender.R.Encoding=UTF-8log4j.appender.R=org.apache.log4j.DailyRollingFileAppenderlog4j.appender.R.DatePattern='_'yyyy-MM-dd_HH'.log'log4j.appender.R.File=$&#123;catalina.home&#125;/logs/1.0_order_providerlog4j.appender.R.ImmediateFlush=truelog4j.appender.R.MaxFileSize=10000KB# Keep one backup filelog4j.appender.R.MaxBackupIndex=20log4j.appender.R.layout=org.apache.log4j.PatternLayoutlog4j.appender.R.layout.ConversionPattern=[%d] %t %c (%F:%L) %-5p - %m%nlog4j.category.com.cheguo=infolog4j.category.org.springframework=infolog4j.category.freemarker=info statics.properties 1234567dubbo.gege.address=$&#123;dubbo.gege.address&#125;dubbo.gege.port=$&#123;dubbo.gege.port&#125;dubbo.gege.version=$&#123;dubbo.gege.version&#125;dubbo.gege.group=$&#123;dubbo.gege.group&#125;dubbo.gege.check=falsedubbo.gege.retries=0dubbo.gege.timeout=10000 web.xml 123456789101112&lt;!DOCTYPE web-app PUBLIC "-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN" "http://java.sun.com/dtd/web-app_2_3.dtd" &gt;&lt;web-app&gt; &lt;display-name&gt;provider&lt;/display-name&gt; &lt;servlet&gt; &lt;servlet-name&gt;dubboService&lt;/servlet-name&gt; &lt;servlet-class&gt;com.gege.tool.DubboInit&lt;/servlet-class&gt; &lt;load-on-startup&gt;1&lt;/load-on-startup&gt; &lt;/servlet&gt;&lt;/web-app&gt; 5ã€DubboæœåŠ¡æ¶ˆè´¹è€…å·¥ç¨‹åˆ›å»ºä¸Žé…ç½® pom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;consumer&lt;/artifactId&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;properties&gt; &lt;spring.version&gt;3.2.8.RELEASE&lt;/spring.version&gt; &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt; &lt;/properties&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;dubbo&lt;/artifactId&gt; &lt;version&gt;2.5.3&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.sgroschupf&lt;/groupId&gt; &lt;artifactId&gt;zkclient&lt;/artifactId&gt; &lt;version&gt;0.1&lt;/version&gt; &lt;/dependency&gt; &lt;!-- springç›¸å…³ --&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jdbc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-tx&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-orm&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-test&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;$&#123;spring.version&#125;&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;provider&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.gege&lt;/groupId&gt; &lt;artifactId&gt;api&lt;/artifactId&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;servlet-api&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;1.2.14&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cglib&lt;/groupId&gt; &lt;artifactId&gt;cglib&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-lang&lt;/groupId&gt; &lt;artifactId&gt;commons-lang&lt;/artifactId&gt; &lt;version&gt;2.5&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;taglibs&lt;/groupId&gt; &lt;artifactId&gt;standard&lt;/artifactId&gt; &lt;version&gt;1.1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.slf4j&lt;/groupId&gt; &lt;artifactId&gt;slf4j-log4j12&lt;/artifactId&gt; &lt;version&gt;1.7.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;resources&gt; &lt;resource&gt; &lt;directory&gt;$&#123;project.basedir&#125;/src/main/resources&lt;/directory&gt; &lt;includes&gt; &lt;include&gt;*.*&lt;/include&gt; &lt;/includes&gt; &lt;filtering&gt;true&lt;/filtering&gt; &lt;/resource&gt; &lt;/resources&gt; &lt;/build&gt; &lt;profiles&gt; &lt;profile&gt; &lt;id&gt;local&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;activation&gt; &lt;activeByDefault&gt;true&lt;/activeByDefault&gt; &lt;/activation&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;dev&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;test&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;profile&gt; &lt;id&gt;product&lt;/id&gt; &lt;properties&gt; &lt;dubbo.gege.address&gt;zookeeper://127.0.0.1:2181&lt;/dubbo.gege.address&gt; &lt;dubbo.gege.group&gt;$&#123;user.name&#125;&lt;/dubbo.gege.group&gt; &lt;dubbo.gege.version&gt;1.0.0&lt;/dubbo.gege.version&gt; &lt;/properties&gt; &lt;/profile&gt; &lt;/profiles&gt;&lt;/project&gt; applicationContext.xml 12345678910111213141516171819202122232425262728293031323334&lt;?xml version="1.0" encoding="UTF-8" ?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:task="http://www.springframework.org/schema/task" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd"&gt; &lt;task:annotation-driven /&gt; &lt;context:component-scan base-package="com.gege"/&gt; &lt;context:annotation-config /&gt; &lt;bean id="propertyConfigurer" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"&gt; &lt;property name="locations"&gt; &lt;list&gt; &lt;value&gt;classpath*:statics.properties&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;import resource="dubbo-customer.xml"/&gt;&lt;/beans&gt; dubbo-customer.xml 123456789101112131415161718&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:dubbo="http://code.alibabatech.com/schema/dubbo" xmlns:context="http://www.springframework.org/schema/context" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd"&gt; &lt;dubbo:application name="consumer"&gt;&lt;/dubbo:application&gt; &lt;!-- ä½¿ç”¨zookeeperæ³¨å†Œä¸­å¿ƒæš´éœ²æœåŠ¡åœ°å€ --&gt; &lt;dubbo:registry id="gege_center" protocol="dubbo" address="$&#123;dubbo.gege.address&#125;" /&gt; &lt;dubbo:provider group="$&#123;dubbo.gege.group&#125;" version="$&#123;dubbo.gege.version&#125;" registry="gege_center"/&gt; &lt;dubbo:consumer group="$&#123;dubbo.gege.group&#125;" version="$&#123;dubbo.gege.version&#125;" registry="gege_center" check="false" /&gt; &lt;!-- å£°æ˜Žéœ€è¦å¼•ç”¨çš„æœåŠ¡æŽ¥å£ --&gt; &lt;dubbo:reference id="testService" interface="com.gege.service.ITestService" retries="$&#123;dubbo.gege.retries&#125;" timeout="$&#123;dubbo.gege.timeout&#125;"/&gt;&lt;/beans&gt; log4j.properties åŒä¸Š statics.properties 12345dubbo.gege.address=$&#123;dubbo.gege.address&#125;dubbo.gege.group=$&#123;dubbo.gege.group&#125;dubbo.gege.version=$&#123;dubbo.gege.version&#125;dubbo.gege.retries=0dubbo.gege.timeout=10000 ConsumerServiceTest.java 1234567891011121314151617181920212223package com.gege.service;import java.io.IOException;import org.apache.log4j.Logger;import org.springframework.context.support.ClassPathXmlApplicationContext;public class ConsumerServiceTest &#123; Logger logger=Logger.getLogger(ConsumerServiceTest.class); public static void main(String[] args) &#123; ClassPathXmlApplicationContext context = new ClassPathXmlApplicationContext( new String[] &#123; "applicationContext.xml" &#125;); context.start(); ITestService testService = (ITestService) context.getBean("testService"); System.out.println(testService.getName()); try &#123; System.in.read(); &#125; catch (IOException e) &#123; e.printStackTrace(); &#125; &#125;&#125; 6ã€è¿è¡Œæµ‹è¯• è¿è¡Œzookeeperï¼ŒåŒå‡»zkServer.cmd è¿è¡Œdubbo-adminï¼ŒåŒå‡»Tomcat7w.exeï¼Œç‚¹å‡»start åœ¨eclipseä¸­ç”¨tomcatè¿è¡ŒæœåŠ¡æä¾›è€…ï¼Œå¯èƒ½å­˜åœ¨è¶…æ—¶ï¼Œé…ç½®tomcatçš„timeouté…ç½®å°±å¯ä»¥äº† åœ¨eclipseä¸­ç”¨tomcatè¿è¡ŒæœåŠ¡æ¶ˆè´¹è€… æ¶ˆè´¹è€…å·¥ç¨‹çš„ConsumerServiceTestä¸‹ï¼Œå³é”® å°±å¯ä»¥æŸ¥çœ‹æ˜¯å¦æˆåŠŸ æ­£å¸¸ç»“æžœï¼š gege æ›´å¤šå†…å®¹å¯ä»¥å…³æ³¨å¾®ä¿¡å…¬ä¼—å·ï¼Œæˆ–è€…è®¿é—®AppZoneç½‘ç«™ ä»¥ä¸Šã§ã™(Ending) ã‚ã‚ŠãŒã©ã†(Thank You)]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[SpringAOPé¢å‘åˆ‡é¢è¯¦è§£ï¼ˆå¸¦å®žä¾‹ï¼‰]]></title>
    <url>%2F2016%2F05%2F13%2Faop20160513%2F</url>
    <content type="text"><![CDATA[äº†è§£AOPçš„ç›¸å…³æœ¯è¯­1.é€šçŸ¥(Advice): é€šçŸ¥å®šä¹‰äº†åˆ‡é¢æ˜¯ä»€ä¹ˆï¼Œä»¥åŠä½•æ—¶ä½¿ç”¨ã€‚æè¿°äº†åˆ‡é¢è¦å®Œæˆçš„å·¥ä½œå’Œä½•æ—¶éœ€è¦æ‰§è¡Œè¿™ä¸ªå·¥ä½œã€‚ 2.è¿žæŽ¥ç‚¹(Joinpoint): ç¨‹åºèƒ½å¤Ÿåº”ç”¨é€šçŸ¥çš„ä¸€ä¸ªâ€œæ—¶æœºâ€ï¼Œè¿™äº›â€œæ—¶æœºâ€å°±æ˜¯è¿žæŽ¥ç‚¹ï¼Œä¾‹å¦‚æ–¹æ³•è¢«è°ƒç”¨æ—¶ã€å¼‚å¸¸è¢«æŠ›å‡ºæ—¶ç­‰ç­‰ã€‚ 3.åˆ‡å…¥ç‚¹(Pointcut): é€šçŸ¥å®šä¹‰äº†åˆ‡é¢è¦å‘ç”Ÿçš„â€œæ•…äº‹â€å’Œæ—¶é—´ï¼Œé‚£ä¹ˆåˆ‡å…¥ç‚¹å°±å®šä¹‰äº†â€œæ•…äº‹â€å‘ç”Ÿçš„åœ°ç‚¹ï¼Œä¾‹å¦‚æŸä¸ªç±»æˆ–æ–¹æ³•çš„åç§°ï¼ŒSpringä¸­å…è®¸æˆ‘ä»¬æ–¹ä¾¿çš„ç”¨æ­£åˆ™è¡¨è¾¾å¼æ¥æŒ‡å®šï¼ˆåˆ‡é¢åœ¨å“ªä¸ªæ–¹æ³•çš„å‰æˆ–åŽåšå‡ºçš„é‚£ä¸ªæ–¹æ³•ç‚¹ï¼‰ 4.åˆ‡é¢(Aspect): é€šçŸ¥å’Œåˆ‡å…¥ç‚¹å…±åŒç»„æˆäº†åˆ‡é¢ï¼šæ—¶é—´ã€åœ°ç‚¹å’Œè¦å‘ç”Ÿçš„â€œæ•…äº‹â€ï¼Œäº‹åŠ¡ç®¡ç†æ˜¯J2EEåº”ç”¨ä¸­ä¸€ä¸ªå¾ˆå¥½çš„æ¨ªåˆ‡å…³æ³¨ç‚¹ä¾‹å­ï¼Œåˆ‡é¢ç”¨Springçš„Advisoræˆ–æ‹¦æˆªå™¨å®žçŽ° 5.å¼•å…¥(Introduction): å¼•å…¥å…è®¸æˆ‘ä»¬å‘çŽ°æœ‰çš„ç±»æ·»åŠ æ–°çš„æ–¹æ³•å’Œå±žæ€§(Springæä¾›äº†ä¸€ä¸ªæ–¹æ³•æ³¨å…¥çš„åŠŸèƒ½ï¼‰ 6.ç›®æ ‡(Target): å³è¢«é€šçŸ¥çš„å¯¹è±¡ï¼Œå¦‚æžœæ²¡æœ‰AOP,é‚£ä¹ˆå®ƒçš„é€»è¾‘å°†è¦äº¤å‰åˆ«çš„äº‹åŠ¡é€»è¾‘ï¼Œæœ‰äº†AOPä¹‹åŽå®ƒå¯ä»¥åªå…³æ³¨è‡ªå·±è¦åšçš„äº‹ï¼ˆAOPè®©ä»–åšçˆ±åšçš„äº‹ï¼‰ 7.ä»£ç†(proxy): åº”ç”¨é€šçŸ¥çš„å¯¹è±¡ï¼Œè¯¦ç»†å†…å®¹å‚è§è®¾è®¡æ¨¡å¼é‡Œé¢çš„ä»£ç†æ¨¡å¼ 8.ç»‡å…¥(Weaving): æŠŠåˆ‡é¢åº”ç”¨åˆ°ç›®æ ‡å¯¹è±¡æ¥åˆ›å»ºæ–°çš„ä»£ç†å¯¹è±¡çš„è¿‡ç¨‹ï¼Œç»‡å…¥ä¸€èˆ¬å‘ç”Ÿåœ¨å¦‚ä¸‹å‡ ä¸ªæ—¶æœº: (1)ç¼–è¯‘æ—¶ï¼šå½“ä¸€ä¸ªç±»æ–‡ä»¶è¢«ç¼–è¯‘æ—¶è¿›è¡Œç»‡å…¥ï¼Œè¿™éœ€è¦ç‰¹æ®Šçš„ç¼–è¯‘å™¨æ‰å¯ä»¥åšçš„åˆ°ï¼Œä¾‹å¦‚AspectJçš„ç»‡å…¥ç¼–è¯‘å™¨ (2)ç±»åŠ è½½æ—¶ï¼šä½¿ç”¨ç‰¹æ®Šçš„ClassLoaderåœ¨ç›®æ ‡ç±»è¢«åŠ è½½åˆ°ç¨‹åºä¹‹å‰å¢žå¼ºç±»çš„å­—èŠ‚ä»£ç  (3)è¿è¡Œæ—¶ï¼šåˆ‡é¢åœ¨è¿è¡Œçš„æŸä¸ªæ—¶åˆ»è¢«ç»‡å…¥,SpringAOPå°±æ˜¯ä»¥è¿™ç§æ–¹å¼ç»‡å…¥åˆ‡é¢çš„ï¼ŒåŽŸç†åº”è¯¥æ˜¯ä½¿ç”¨äº†JDKçš„åŠ¨æ€ä»£ç†æŠ€æœ¯ å­˜åœ¨çš„å®žçŽ°æ–¹å¼ 1.ç»å…¸çš„åŸºäºŽä»£ç†çš„AOP2.@AspectJæ³¨è§£é©±åŠ¨çš„åˆ‡é¢3.çº¯POJOåˆ‡é¢4.æ³¨å…¥å¼AspectJåˆ‡é¢ å®žçŽ°æ­¥éª¤ 1.åˆ›å»ºé€šçŸ¥ï¼šå®žçŽ°è¿™å‡ ä¸ªæŽ¥å£ï¼ŒæŠŠå…¶ä¸­çš„æ–¹æ³•å®žçŽ°äº†2.å®šä¹‰åˆ‡ç‚¹å’Œé€šçŸ¥è€…ï¼šåœ¨Springé…åˆ¶æ–‡ä»¶ä¸­é…ç½®è¿™äº›ä¿¡æ¯3.ä½¿ç”¨ProxyFactoryBeanæ¥ç”Ÿæˆä»£ç† èŒƒä¾‹ä¾‹å­æˆ‘æ˜¯åŸºäºŽmavenå’ŒSpringæ³¨è§£çš„æ–¹å¼ï¼Œç”¨POJOå®žçŽ° å·¥ç¨‹çš„ä¸»è¦æ–‡ä»¶çš„é…ç½® pom.xml 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169&lt;project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd"&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;imooc&lt;/groupId&gt; &lt;artifactId&gt;springmaven&lt;/artifactId&gt; &lt;packaging&gt;war&lt;/packaging&gt; &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt; &lt;name&gt;springmaven Maven Webapp&lt;/name&gt; &lt;url&gt;http://maven.apache.org&lt;/url&gt; &lt;properties&gt; &lt;finalName&gt;SSHMJ-FRANK&lt;/finalName&gt; &lt;/properties&gt; &lt;repositories&gt; &lt;repository&gt; &lt;id&gt;mav&lt;/id&gt; &lt;name&gt;sss&lt;/name&gt; &lt;url&gt;http://mvnrepository.com&lt;/url&gt; &lt;releases&gt; &lt;enabled&gt;true&lt;/enabled&gt; &lt;/releases&gt; &lt;snapshots&gt; &lt;enabled&gt;false&lt;/enabled&gt; &lt;/snapshots&gt; &lt;layout&gt;default&lt;/layout&gt; &lt;/repository&gt; &lt;/repositories&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aop&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-asm&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-aspects&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-beans&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-context-support&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-expression&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-instrument&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-instrument-tomcat&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.aspectj&lt;/groupId&gt; &lt;artifactId&gt;aspectjweaver&lt;/artifactId&gt; &lt;version&gt;1.6.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-pool&lt;/groupId&gt; &lt;artifactId&gt;commons-pool&lt;/artifactId&gt; &lt;version&gt;1.5.3&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-collections&lt;/groupId&gt; &lt;artifactId&gt;commons-collections&lt;/artifactId&gt; &lt;version&gt;3.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;log4j&lt;/groupId&gt; &lt;artifactId&gt;log4j&lt;/artifactId&gt; &lt;version&gt;1.2.16&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-jms&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-oxm&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-web&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-webmvc-portlet&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;artifactId&gt;spring-struts&lt;/artifactId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;commons-httpclient&lt;/groupId&gt; &lt;artifactId&gt;commons-httpclient&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;ognl&lt;/groupId&gt; &lt;artifactId&gt;ognl&lt;/artifactId&gt; &lt;version&gt;2.6.9&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.0.1&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;jstl&lt;/artifactId&gt; &lt;version&gt;1.2&lt;/version&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;cglib&lt;/groupId&gt; &lt;artifactId&gt;cglib&lt;/artifactId&gt; &lt;version&gt;2.2&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; &lt;build&gt; &lt;pluginManagement&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt; &lt;artifactId&gt;maven-site-plugin&lt;/artifactId&gt; &lt;version&gt;3.4&lt;/version&gt; &lt;/plugin&gt; &lt;/plugins&gt; &lt;/pluginManagement&gt; &lt;finalName&gt;springmaven&lt;/finalName&gt; &lt;/build&gt;&lt;/project&gt; 1234567891011121314151617181920212223242526272829```xml&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;web-app xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot; xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot; version=&quot;3.0&quot;&gt;&lt;!-- å·¥ç¨‹å --&gt; &lt;display-name&gt;springmaven&lt;/display-name&gt; &lt;listener&gt; &lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt; &lt;/listener&gt; &lt;!-- springé…ç½®æ–‡ä»¶çš„é…ç½® --&gt; &lt;context-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/context-param&gt;&lt;!-- springmvcçš„é…ç½®çŽ¯å¢ƒ --&gt; &lt;servlet&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:spring-servlet.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;2&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;spring&lt;/servlet-name&gt; &lt;url-pattern&gt;*.html&lt;/url-pattern&gt; &lt;/servlet-mapping&gt;&lt;/web-app&gt; applicationContext.xml 123456789101112131415161718192021222324252627&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:aop="http://www.springframework.org/schema/aop" xmlns:tx="http://www.springframework.org/schema/tx" xmlns:task="http://www.springframework.org/schema/task" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd http://www.springframework.org/schema/task http://www.springframework.org/schema/task/spring-task-3.0.xsd"&gt; &lt;context:component-scan base-package="com.service" /&gt; &lt;aop:aspectj-autoproxy /&gt; &lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect ref="preDo"&gt; &lt;aop:pointcut expression="execution(* com.service.ToDo.toEat(..))" id="register" /&gt; &lt;aop:before method="toPre" pointcut-ref="register" /&gt; &lt;/aop:aspect&gt; &lt;/aop:config&gt;&lt;/beans&gt; spring-servlet.xml 1234567891011121314151617181920212223&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:context="http://www.springframework.org/schema/context" xmlns:mvc="http://www.springframework.org/schema/mvc" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc-3.0.xsd"&gt; &lt;!-- don't handle the static resource --&gt; &lt;mvc:default-servlet-handler /&gt; &lt;!-- if you use annotation you must configure following setting --&gt; &lt;mvc:annotation-driven /&gt; &lt;bean class="org.springframework.web.servlet.view.InternalResourceViewResolver" id="internalResourceViewResolver"&gt; &lt;property name="viewClass" value="org.springframework.web.servlet.view.JstlView"&gt;&lt;/property&gt;&lt;!-- å‰ç¼€ --&gt; &lt;property name="prefix" value="/WEB-INF/jsp/" /&gt;&lt;!-- åŽç¼€ --&gt; &lt;property name="suffix" value=".jsp" /&gt; &lt;/bean&gt;&lt;/beans&gt; IToDo.java åˆ‡å…¥ç‚¹(Pointcut)æŽ¥å£ 123456package com.service.imp;public interface IToDo &#123; public String toEat();&#125; ToDo.java 123456789101112131415package com.service;import org.springframework.stereotype.Service;import com.service.imp.IToDo;@Servicepublic class ToDo implements IToDo &#123; @Override public String toEat() &#123; System.out.println("åƒè‹¹æžœ"); return "åƒè‹¹æžœ"; &#125;&#125; IPreDo.java 123456package com.service.imp;public interface IPreDo &#123; public String toPre();&#125; application.java ç”¨äºŽæµ‹è¯• 1234567891011121314package springmaven;import org.springframework.context.ApplicationContext;import org.springframework.context.support.ClassPathXmlApplicationContext;import com.service.imp.IToDo;public class application &#123; public static void main(String[] args) &#123; ApplicationContext appCtx = new ClassPathXmlApplicationContext("applicationContext.xml"); IToDo tdo = (IToDo)appCtx.getBean("toDo"); tdo.toEat(); &#125;&#125; å·¥ç¨‹å›¾ç‰‡ è¿”å›žçš„ç»“æžœ 12æ´—æ‰‹åƒè‹¹æžœ ä¸»è¦çš„é…ç½®è®²è§£12345678&lt;aop:aspectj-autoproxy /&gt;&lt;aop:config proxy-target-class="true"&gt; &lt;aop:aspect ref="preDo"&gt; &lt;aop:pointcut expression="execution(* com.service.ToDo.toEat(..))" id="register" /&gt; &lt;aop:before method="toPre" pointcut-ref="register" /&gt; &lt;/aop:aspect&gt;&lt;/aop:config&gt; &lt;aop:aspectj-autoproxy /&gt;:ä¼šè‡ªåŠ¨ä¸ºspringå®¹å™¨ä¸­é‚£äº›é…ç½®@aspectJåˆ‡é¢çš„beanåˆ›å»ºä»£ç†ï¼Œç»‡å…¥åˆ‡é¢ï¼Œæˆ‘è¿™é‡Œæ²¡æœ‰ä½¿ç”¨æ³¨è§£çš„æ–¹å¼ï¼Œä½¿ç”¨äº†xmlé…ç½®çš„æ–¹å¼ã€‚ &lt;aop:config&gt;:å°±æ˜¯ç”¨æ¥é…ç½®aspectJåˆ‡é¢ proxy-target-class:è®¾ç½®ä»£ç†æ¨¡å¼ã€‚å½“poxy-target-class=&quot;true&quot;æ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨CGLibåŠ¨æ€ä»£ç†æŠ€æœ¯ç»‡å…¥å¢žå¼ºã€‚è®¾ç½®ä¸ºfalseæ—¶ï¼Œè¡¨ç¤ºä½¿ç”¨jdkåŠ¨æ€ä»£ç†ç»‡å…¥å¢žå¼ºï¼Œå¦‚æžœç›®æ ‡ç±»æ²¡æœ‰å£°æ˜ŽæŽ¥å£ï¼Œåˆ™springå°†è‡ªåŠ¨ä½¿ç”¨CGLibåŠ¨æ€ä»£ç†ã€‚ &lt;aop:aspect ref=&quot;preDo&quot;&gt;:è®¾ç½®åˆ‡é¢ï¼Œrefæ˜¯åˆ‡é¢Beançš„idå &lt;aop:pointcut expression=&quot;execution(* com.service.ToDo.toEat(..))&quot; id=&quot;register&quot; /&gt;:è¿™é‡Œè®¾ç½®åˆ‡å…¥ç‚¹ï¼Œexpressionè®¾ç½®åˆ‡é¢æ¤å…¥çš„åˆ‡å…¥ç‚¹çš„æ–¹æ³•åœ°å€ &lt;aop:before method=&quot;toPre&quot; pointcut-ref=&quot;register&quot; &gt;:åœ¨æ‰§è¡Œåˆ‡å…¥ç‚¹æ–¹æ³•ä¹‹å‰æ‰§è¡Œåˆ‡é¢æ–¹æ³•ï¼Œmethodä¸ºåˆ‡é¢ä¸­çš„æ‰§è¡Œæ–¹æ³•ï¼Œpointcut-refä¸Žåˆ‡ç‚¹çš„idä¸€è‡´å°±å¯ä»¥äº† &lt;aop:advisor&gt; å®šä¹‰ä¸€ä¸ªAOPé€šçŸ¥è€…&lt;aop:after&gt; åŽé€šçŸ¥&lt;aop:after-returning&gt; è¿”å›žåŽé€šçŸ¥&lt;aop:after-throwing&gt; æŠ›å‡ºåŽé€šçŸ¥&lt;aop:around&gt; å‘¨å›´é€šçŸ¥&lt;aop:aspect&gt;å®šä¹‰ä¸€ä¸ªåˆ‡é¢&lt;aop:before&gt;å‰é€šçŸ¥&lt;aop:config&gt;é¡¶çº§é…ç½®å…ƒç´ ï¼Œç±»ä¼¼äºŽè¿™ç§ä¸œè¥¿&lt;aop:pointcut&gt;å®šä¹‰ä¸€ä¸ªåˆ‡ç‚¹ å‚è€ƒèµ„æ–™ï¼šSpringå®žçŽ°AOPçš„4ç§æ–¹å¼ proxy-target-class]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexoè®©åšå®¢æ¢¦å˜çš„ç®€å•]]></title>
    <url>%2F2016%2F05%2F12%2Fhexo20160512%2F</url>
    <content type="text"><![CDATA[ä¹‹å‰å†™è¿‡ä¸€ç¯‡å…³äºŽoctopressåˆ›å»ºä¸ªäººæŠ€æœ¯åšå®¢çš„æ–‡ç« ï¼Œå¾ˆå¤šæœ‹å‹è¯´æ­¥éª¤å¥½å¤æ‚å•Šï¼ˆå¿ƒå¡žï¼‰ï¼è¿™æ¬¡ï¼Œä¸ºäº†æ»¡è¶³è¿™ç¾¤æœ‹å‹ï¼Œè¿™é‡Œæˆ‘è¦æ•™å¤§å®¶çš„æ˜¯ç”¨Hexoå»ºä¸ªäººæŠ€æœ¯åšå®¢ã€‚ 1ã€å®‰è£…GITå’ŒNode.JSè¿™ä¸€æ­¥æˆ‘ä¸æƒ³å±•å¼€å¤ªå¤šï¼Œå› ä¸ºçœŸçš„å¾ˆç®€å•ï¼Œå…³äºŽGITçš„é…ç½®æˆ‘åœ¨ä¹‹å‰çš„æ–‡ç« ä¸­å·²ç»æåˆ°è¿‡äº†ï¼Œçœ‹å®˜å¯ä»¥æŸ¥çœ‹åŽ†å²æ–‡ç«  2ã€å®‰è£…Hexoåœ¨æ¡Œé¢ä¸‹ä½¿ç”¨GIT Bashè¾“å…¥ä¸‹é¢ä»£ç ï¼Œå®žçŽ°Hexoçš„å®‰è£… 1$ sudo npm install hexo-cli -g åˆå§‹åŒ–è‡ªå·±çš„ä¸ªäººåšå®¢ ä½¿ç”¨GIT Bashåˆ‡æ¢åˆ°ä½ å¸Œæœ›å®‰è£…ä¸ªäººåšå®¢çš„æ–‡ä»¶å¤¹ä¸‹ 1$ hexo init username.github.io usernameå°±æ˜¯Githubä¸­çš„ç”¨æˆ·åï¼Œè¯¦ç»†æŸ¥çœ‹ 3ã€ä¸»é¢˜çš„å®‰è£…åœ¨å®Œæˆä¸Šä¸€æ­¥åŽï¼Œå…¶å®žå°±å¯ä»¥è¿è¡ŒæŸ¥çœ‹é¡µé¢äº†ï¼Œè¿™ä¸€æ­¥è®©ä½ å®žçŽ°å®‰è£…è‡ªå·±å–œæ¬¢çš„ä¸»é¢˜ï¼Œçœ‹å®˜å¯ä»¥åœ¨Githubç½‘ç«™ä¸­è¾“å…¥hexoå…³é”®å­—ï¼Œå¯ä»¥æœç´¢åˆ°å¾ˆå¤šç›¸å…³ä¸»é¢˜ï¼ŒæŒ‘é€‰ä¸€ä¸ªå°±å¯ä»¥äº† æˆ‘è¿™é‡Œä½¿ç”¨NEXTè¿™ä¸ªä¸»é¢˜è¿›è¡Œè®²è§£ï¼Œå…¶ä»–çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚ ä½¿ç”¨GIT Bashåˆ‡æ¢åˆ°ä½ åˆšæ‰ä¸ªäººåšå®¢å®‰è£…ç›®å½• 12$ cd username.github.io$ git clone https://github.com/iissnan/hexo-theme-next themes/next å®Œæˆä¸Šé¢æ­¥éª¤ï¼Œä¼šåœ¨themeçš„ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ªnextæ–‡ä»¶ï¼Œè¯´æ˜Žä¸»é¢˜ä¸‹è½½æˆåŠŸäº†ï¼Œä½†çŽ°åœ¨è¿˜æ²¡æœ‰é…ç½®å®Œæˆ åœ¨username.github.ioæ–‡ä»¶ä¸‹æœ‰ä¸€ä¸ª_config.ymlæ–‡ä»¶ï¼Œç¼–è¾‘å®ƒ å°†themeçš„valueè®¾ä¸ºè‡ªå·±çš„ä¸»é¢˜åï¼Œè¿™é‡Œæ˜¯nextâ€”â€”å®Œæˆä¸»é¢˜çš„é…ç½® å°†deployçš„valueè¿›è¡Œé…ç½®â€”â€”å®Œæˆä¸»é¢˜å‘å¸ƒåœ°å€é…ç½® 1234567891011# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: next# Deployment## Docs: https://hexo.io/docs/deployment.htmldeploy: type: git repo: git@github.com:username/username.github.io.git branch: master 4ã€åˆ›å»ºæ–‡ç« åœ¨username.github.io/source/_postsç›®å½•ä¸‹åˆ›å»ºä½ è‡ªå·±çš„æ–‡ç« ï¼Œæ–‡ç« æ ¼å¼ä¸ºMarkdownçš„.mdæ ¼å¼ 1234---title: Hexoè®©åšå®¢æ¢¦å˜çš„ç®€å•date: 2016-05-12--- title:æ–‡ç« åï¼Œdate:å‘å¸ƒçš„æ—¥æœŸ 5ã€å‘å¸ƒåˆ°Githubå®‰è£…è‡ªåŠ¨éƒ¨ç½²å‘å¸ƒå·¥å…· ä½¿ç”¨GIT Bashåˆ‡æ¢åˆ°username.github.ioç›®å½•ä¸‹ 1$ npm install hexo-deployer-git --save ç¼–è¯‘ 1$ hexo generate æœ¬åœ°æµ‹è¯• 1$ hexo s -p 4000 -p:è®¾ç½®ç«¯å£å·ï¼Œé»˜è®¤ä¸º4000ï¼Œä½¿ç”¨é»˜è®¤ç«¯å£å¯ä»¥çœç•¥ å‘å¸ƒåˆ°Github 1$ hexo d è¿™é‡Œç‰¹åˆ«è¦æé†’ä¸€ä¸‹ä¸è¦å¿˜è®°åœ¨username.github.ioæ–‡ä»¶ä¸‹_config.ymlæ–‡ä»¶ï¼Œé…ç½®deploy 6ã€å¤‡ä»½æˆ‘ä»¬å¸¸å¸¸å¯èƒ½ä¼šé‡åˆ°ç³»ç»Ÿé‡è£…æˆ–è€…æ¢ç”µè„‘ç¼–è¾‘çš„åœºæ™¯ï¼Œå¤‡ä»½å˜å¾—å°¤ä¸ºé‡è¦ï¼Œè¿™é‡Œä»‹ç»ä¸€ä¸ªhexo-git-backupå¤‡ä»½å·¥å…· å¤§å®¶å¯ä»¥æ ¹æ®è‡ªå·±çš„å®žé™…æƒ…å†µï¼Œå‚ç…§README.mdè¯´æ˜Žè¿›è¡Œé…ç½® 7ã€èŽ·å–å¤‡ä»½ï¼Œå®žçŽ°è¿˜åŽŸ æ“ä½œæ­¥éª¤1ï¼Œ2 å°†Githubçš„å¤‡ä»½cloneåˆ°æœ¬åœ° 12$ git@github.com:username/username.github.io.git$ git checkout branchname branchname:å¤‡ä»½åˆ†æ”¯å 8ã€å¸®åŠ©æ–‡æ¡£hexoé…ç½®nexté…ç½® ä»¥ä¸Šã§ã™(Ending) ã‚ã‚ŠãŒã©ã†(Thank You)]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Mavençš„pomæ–‡ä»¶é‚£äº›äº‹]]></title>
    <url>%2F2016%2F05%2F05%2Fpom20160505%2F</url>
    <content type="text"><![CDATA[pom.xmlæ–‡ä»¶1234&lt;groupId&gt;org.son.nexus&lt;/groupId&gt;//é¡¹ç›®éš¶å±žçš„å®žé™…é¡¹ç›®å&lt;artifactId&gt;nexus-indexer&lt;/artifactId&gt;//å®žé™…é¡¹ç›®ä¸­çš„ä¸€ä¸ªmavené¡¹ç›®æ¨¡å—åç§°&lt;version&gt;2.0.0&lt;/version&gt;//ç‰ˆæœ¬å·&lt;packaging&gt;jar&lt;/packaging&gt;//å½“å‰mavené¡¹ç›®æ‰“åŒ…çš„æ–¹å¼ï¼Œé»˜è®¤ä¸ºjar ä»¥ä¸Šçš„é…ç½®ä¼šèŽ·å¾—ä¸€ä¸ª-.æ ¼å¼çš„åŒ…//nexus-indexer-2.0.0.jar jdk7//ç”¨äºŽå®šä¹‰æž„å»ºè¾“å‡ºçš„ä¸€äº›é™„å±žçš„æž„å»ºã€‚classifieræ˜¯ä¸èƒ½ç›´æŽ¥å®šä¹‰çš„ï¼Œåªèƒ½å­˜åœ¨é™„åŠ çš„æž„ä»¶ï¼ˆæ’ä»¶ï¼‰æ—¶ï¼Œæ‰èƒ½ï¼ˆå¿…é¡»ï¼‰æ·»åŠ ã€‚åœ¨åŒ…åä¸Šä¹Ÿä¼šæœ‰æ‰€æçŽ°ï¼ˆnexus-indexer-2.0.0-javadoc.jarï¼‰ jaråŒ…åœ¨ä»“åº“ä¸­çš„è·¯å¾„è§„å¾‹ï¼šgroupId/artifactId/version/groupId-version ä¾èµ–ä»“åº“groupIdã€artifactIdã€versionä¸ºåŸºæœ¬åæ ‡ typeä¸ºä¾èµ–ç±»åž‹ï¼Œé»˜è®¤ä¸ºjar scopeä¸ºä¾èµ–èŒƒå›´ compileï¼šç¼–è¯‘ï¼Œæµ‹è¯•ï¼Œè¿è¡Œä¸‰ç§classpathéƒ½æœ‰æ•ˆ testï¼šåªå¯¹æµ‹è¯•æœ‰æ•ˆ providedï¼šç¼–è¯‘å’Œæµ‹è¯•æœ‰æ•ˆ runtimeï¼šæµ‹è¯•å’Œè¿è¡Œæœ‰æ•ˆ systemï¼šç³»ç»Ÿä¾èµ–ï¼Œä¾èµ–çš„åŒ…æ˜¯ä»Žè®¡ç®—æœºæœ¬åœ°å¯¼å…¥ï¼Œä¸ŽsystemPathé…åˆä½¿ç”¨ â€‹ &lt;systemPath&gt;${java.home}/lib/rt.jar&lt;/systemPath&gt; â€‹ &lt;scope&gt;system&lt;/scope&gt; ä¼ é€’æ€§ä¾èµ–mavené»˜è®¤å°±æ˜¯æ”¯æŒçš„ã€‚ ä»€ä¹ˆæ˜¯ä¼ é€’æ€§ä¾èµ–ï¼Ÿ æ¯”å¦‚ï¼šçŽ°åœ¨è¦å¯¼å…¥A.jaråŒ…ï¼Œä½†A.jaræœ‰ä¾èµ–äºŽB.jarï¼Œåœ¨mavenä¸­å°±ä¼šé»˜è®¤å¯¼å…¥B.jarï¼Œè€Œä¸éœ€è¦æ‰‹åŠ¨åŽ»å¯¼å…¥ã€‚ scopeæœ€å¥½è®¾ä¸ºcompile ä¼ é€’æ€§ä¾èµ–å­˜åœ¨ä¸€ä¸ªé—®é¢˜ï¼šå·¥ç¨‹ä¸­å­˜åœ¨ä¸¤ä¸ªjaråˆ†åˆ«ä¾èµ–çš„æ˜¯B.jarçš„ä¸åŒç‰ˆæœ¬jaråŒ…ï¼Œå°±ä¼šå‡ºçŽ°é”™è¯¯ã€‚ optionalï¼šå¯é€‰ä¾èµ–ï¼Œtrue ä¸ä¼šä¼ é€’ï¼Œfalseä¼šä¼ é€’ï¼ˆé»˜è®¤ï¼‰ 123456&lt;dependency&gt;&lt;groupId&gt;mysql&lt;/groupId&gt;&lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;&lt;version&gt;5.1.10&lt;/version&gt;&lt;optional&gt;true&lt;/optional&gt;&lt;/dependency&gt; å½“å…¶ä»–é¡¹ç›®Cä¾èµ–Bé¡¹ç›®æ—¶ï¼Œmysql-connector-javaçš„ä¾èµ–ä¸ä¼šå‘ç”Ÿä¼ é€’ç»™C ä¼˜ç‚¹ï¼š å‡å°‘å†²çªï¼Œä¸ç”¨çš„åŠŸèƒ½ä¸ä¼ é€’ ä¸€ä¸ªjaråº”è¯¥åªæœ‰ ä¸€ä¸ªèŒè´£åŽŸåˆ™ exclusionsæŽ’é™¤ä¾èµ–ç”¨äºŽæ›¿æ¢æŸä¸ª ä¾èµ–ä¸­çš„ä¾èµ–åŒ…ä½œç”¨ 123456789101112131415161718&lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-B&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt;//å¯ä»¥æœ‰å¤šä¸ª &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-C&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-B&lt;/artifactId&gt; &lt;version&gt;1.1.0&lt;/version&gt; &lt;/dependency&gt;&lt;/dependencies&gt; è¯¥ä¾‹å­çš„æ„æ€ï¼šä¸æƒ³ä½¿ç”¨project-Bä¸­ç‰ˆæœ¬çš„project-Cä¾èµ–åŒ…ï¼Œè€Œå°†å…¶çŽ¯å«1.1.0çš„project-CåŒ… å½’ç±»ä¾èµ–åœºæ™¯ï¼šå­˜åœ¨ä¸€ç¾¤ç‰ˆæœ¬å·ä¸€è‡´çš„ä¾èµ–ï¼Œæƒ³é€šè¿‡ä¸€ä¸ªç»Ÿä¸€çš„é…ç½®ï¼Œå°†å…¶ç»Ÿä¸€é…ç½®å’Œä¿®æ”¹ 123&lt;properties&gt; &lt;spring&gt;2.5.6&lt;/spring&gt;&lt;/properties&gt; è°ƒç”¨æ–¹å¼ 1&lt;version&gt;$&#123;spring&#125;&lt;/version&gt; éƒ¨ç½²è‡³è¿œç¨‹ä»“åº“ä¿®æ”¹å·¥ç¨‹ä¸­çš„pomæ–‡ä»¶ 12345678910111213141516&lt;project&gt; .... &lt;distributionManagement&gt; &lt;repository&gt; //å‘å¸ƒç‰ˆæœ¬æž„ä»¶çš„ä»“åº“ &lt;id&gt;&lt;/id&gt; //è¿œç¨‹ä»“åº“çš„å”¯ä¸€æ ‡è¯† &lt;name&gt;&lt;/name&gt; //è‡ªå®šä¹‰ &lt;url&gt;&lt;/url&gt; //è¯¥ä»“åº“åœ°å€ &lt;/repository&gt; &lt;snapshotRepository&gt;//å¿«ç…§ç‰ˆæœ¬çš„è®¾ç½® &lt;id&gt;&lt;/id&gt; &lt;name&gt;&lt;/name&gt; &lt;url&gt;&lt;/url&gt; &lt;/snapshotRepository&gt; &lt;/distributionManagement&gt; ....&lt;/project&gt; å¦‚æžœéœ€è¦è®¤è¯ï¼Œåˆ™åœ¨setting.xmlæ–‡ä»¶ä¸­å¢žåŠ ä¸€ä¸ªå…ƒç´ è¿›è¡Œé…ç½® åœ¨é…ç½®å®ŒæˆåŽï¼Œæ‰§è¡Œmvn clean deploy å°±ä¼šæ ¹æ®å½“å‰ç‰ˆæœ¬ç±»åž‹ï¼Œå‘å¸ƒåˆ°ç›¸åº”çš„ä»“åº“ä¸­ å¿«ç…§ç‰ˆæœ¬ å¿«ç…§ä¸æ˜¯æ­£å¼ç‰ˆæœ¬ï¼Œå½“è®¾ä¸ºå¸¦æœ‰SNAPSHOTçš„versionæ—¶ï¼Œå³ä¸ºå¿«ç…§ç‰ˆæœ¬ï¼Œæ¯æ¬¡å‘ä»“åº“éƒ¨ç½²æ˜¯ï¼Œä¼šè‡ªåŠ¨æ‰“ä¸Šæ—¶é—´æˆ³ï¼Œå…¶ä»–å¼•ç”¨å¿«ç…§ç›¸åŒç‰ˆæœ¬æ—¶ä¼šè‡ªåŠ¨ä¸‹è½½æ›´æ–° ä¾‹å¦‚ï¼š2.1-SNAPSHOTæ—¶ï¼Œåˆ™ä¼šä¸‹è½½2.1-20091214ä¹‹ç±»çš„æž„ä»¶ åœ¨mavenæœ¬åœ°ä»“åº“çš„groupId/artifactId/versionæ–‡ä»¶è·¯å¾„ä¸‹ä¼šå­˜åœ¨maven-metadata.xmlæ–‡ä»¶ï¼Œä¼šè®°å½•ç‰ˆæœ¬ä¿¡æ¯ 12345678910111213&lt;?xml version="1.0" encoding="UTF-8"?&gt;&lt;metadata&gt; &lt;groupId&gt;com.android.support&lt;/groupId&gt; &lt;artifactId&gt;multidex&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;versioning&gt; &lt;versions&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;version&gt;1.0.1&lt;/version&gt; &lt;/versions&gt; &lt;lastUpdated&gt;20141209014044&lt;/lastUpdated&gt; &lt;/versioning&gt;&lt;/metadata&gt; mavenç”Ÿå‘½å‘¨æœŸmavençš„ç”Ÿå‘½å‘¨æœŸæ˜¯æŠ½è±¡çš„ï¼Œå…¶å®žé™…è¡Œä¸ºéƒ½æ˜¯ç”±æ’ä»¶æ¥å®Œæˆçš„ã€‚ mavençš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä¸åšä»»ä½•å®žé™…å·¥ä½œï¼Œå®žé™…ä»»åŠ¡éƒ½ç”±æ’ä»¶å®Œæˆã€‚ mavenå…·æœ‰ä¸‰ä¸ªç‹¬ç«‹çš„ç”Ÿå‘½å‘¨æœŸï¼šcleanã€defeatã€site 1ã€cleanç”Ÿå‘½å‘¨æœŸï¼šæ¸…ç†é¡¹ç›®ï¼ŒåŒ…å«ä¸‰ä¸ªphaseã€‚ 1ï¼‰pre-cleanï¼šæ‰§è¡Œæ¸…ç†å‰éœ€è¦å®Œæˆçš„å·¥ä½œ 2ï¼‰cleanï¼šæ¸…ç†ä¸Šä¸€æ¬¡æž„å»ºç”Ÿæˆçš„æ–‡ä»¶ 3ï¼‰post-cleanï¼šæ‰§è¡Œæ¸…ç†åŽéœ€è¦å®Œæˆçš„å·¥ä½œ 2ã€defaultç”Ÿå‘½å‘¨æœŸï¼šæž„å»ºé¡¹ç›®ï¼Œé‡è¦çš„phaseå¦‚ä¸‹ã€‚ 1ï¼‰validateï¼šéªŒè¯å·¥ç¨‹æ˜¯å¦æ­£ç¡®ï¼Œæ‰€æœ‰éœ€è¦çš„èµ„æºæ˜¯å¦å¯ç”¨ã€‚2ï¼‰compileï¼šç¼–è¯‘é¡¹ç›®çš„æºä»£ç ã€‚3ï¼‰testï¼šä½¿ç”¨åˆé€‚çš„å•å…ƒæµ‹è¯•æ¡†æž¶æ¥æµ‹è¯•å·²ç¼–è¯‘çš„æºä»£ç ã€‚è¿™äº›æµ‹è¯•ä¸éœ€è¦å·²æ‰“åŒ…å’Œå¸ƒç½²ã€‚4ï¼‰Packageï¼šæŠŠå·²ç¼–è¯‘çš„ä»£ç æ‰“åŒ…æˆå¯å‘å¸ƒçš„æ ¼å¼ï¼Œæ¯”å¦‚jarã€‚5ï¼‰integration-testï¼šå¦‚æœ‰éœ€è¦ï¼Œå°†åŒ…å¤„ç†å’Œå‘å¸ƒåˆ°ä¸€ä¸ªèƒ½å¤Ÿè¿›è¡Œé›†æˆæµ‹è¯•çš„çŽ¯å¢ƒã€‚6ï¼‰verifyï¼šè¿è¡Œæ‰€æœ‰æ£€æŸ¥ï¼ŒéªŒè¯åŒ…æ˜¯å¦æœ‰æ•ˆä¸”è¾¾åˆ°è´¨é‡æ ‡å‡†ã€‚7ï¼‰installï¼šæŠŠåŒ…å®‰è£…åˆ°mavenæœ¬åœ°ä»“åº“ï¼Œå¯ä»¥è¢«å…¶ä»–å·¥ç¨‹ä½œä¸ºä¾èµ–æ¥ä½¿ç”¨ã€‚8ï¼‰Deployï¼šåœ¨é›†æˆæˆ–è€…å‘å¸ƒçŽ¯å¢ƒä¸‹æ‰§è¡Œï¼Œå°†æœ€ç»ˆç‰ˆæœ¬çš„åŒ…æ‹·è´åˆ°è¿œç¨‹çš„repositoryï¼Œä½¿å¾—å…¶ä»–çš„å¼€å‘è€…æˆ–è€…å·¥ç¨‹å¯ä»¥å…±äº«ã€‚ 3ã€siteç”Ÿå‘½å‘¨æœŸï¼šå»ºç«‹å’Œå‘å¸ƒé¡¹ç›®ç«™ç‚¹ï¼Œphaseå¦‚ä¸‹ 1ï¼‰pre-siteï¼šç”Ÿæˆé¡¹ç›®ç«™ç‚¹ä¹‹å‰éœ€è¦å®Œæˆçš„å·¥ä½œ 2ï¼‰siteï¼šç”Ÿæˆé¡¹ç›®ç«™ç‚¹æ–‡æ¡£ 3ï¼‰post-siteï¼šç”Ÿæˆé¡¹ç›®ç«™ç‚¹ä¹‹åŽéœ€è¦å®Œæˆçš„å·¥ä½œ 4ï¼‰site-deployï¼šå°†é¡¹ç›®ç«™ç‚¹å‘å¸ƒåˆ°æœåŠ¡å™¨ å‘½ä»¤è¡Œè¾“å…¥ï¼š$mvn clean å…¶å®žè°ƒç”¨çš„æ˜¯cleanç”Ÿå‘½å‘¨æœŸçš„cleané˜¶æ®µï¼Œæ‰§è¡Œäº†pre-cleanå’Œclean è€Œè¿™äº›å‘½ä»¤å…¶å®žæ˜¯ç”±æ’ä»¶æä¾›åŠŸèƒ½çš„ã€‚ è‡ªå®šä¹‰ç»‘å®šæ’ä»¶123456789101112131415161718&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;//mavenå®˜æ–¹ï¼Œå®˜æ–¹çš„å¯ä»¥çœç•¥è¯¥æ ‡ç­¾ &lt;artifactId&gt;maven-source-plugin&lt;/artifactId&gt;//æ’ä»¶ &lt;version&gt;2.1.1&lt;/version&gt;//æ²¡æœ‰versionæ—¶ï¼Œä¼šé»˜è®¤ä¸‹è½½æœ€æ–°çš„releaseç‰ˆæœ¬ &lt;executions&gt;//é…ç½®æ‰§è¡Œnä¸ªä»»åŠ¡ &lt;execution&gt; &lt;id&gt;attach-sources&lt;/id&gt;//å¯ä»¥ä»»æ„ &lt;phase&gt;verify&lt;/phase&gt;//ç»‘å®šåˆ°verifyç”Ÿå‘½å‘¨æœŸï¼Œåœ¨æ­¤æ—¶æ‰ä¼šèµ·ä½œç”¨ &lt;goals&gt; &lt;goal&gt;jar-no-fork&lt;/goal&gt;//å¯ç”¨è¯¥æ’ä»¶çš„jar-no-forkåŠŸèƒ½ &lt;/goals&gt; &lt;/execution&gt; &lt;/executions&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; å› ä¸ºä¸€ä¸ªæ’ä»¶å¯èƒ½å­˜åœ¨å¤šä¸ªåŠŸèƒ½ï¼Œä½†æˆ‘ä»¬å¹¶ä¸ä¸€å®šæ‰€æœ‰çš„åŠŸèƒ½éƒ½éœ€è¦ï¼Œæ‰€ä»¥è®¾å®šgoalæ ‡ç­¾ï¼Œè¡¨ç¤ºæˆ‘ä»¬è¦å®žçŽ°çš„åŠŸèƒ½ã€‚ æ’ä»¶é…ç½®å‘½ä»¤è¡Œé…ç½®ï¼š$mvn install -Dt æ’ä»¶ç›¸å…³å‚æ•° //é€‚ç”¨äºŽå½“æ¯æ¬¡è¿è¡Œæ—¶ï¼Œè¿™ä¸ªæ’ä»¶çš„é…ç½®éƒ½ä¼šå˜çš„æƒ…å†µ pomä¸­å…¨å±€é…ç½®ï¼š 123456789101112&lt;build&gt; &lt;plugins&gt; &lt;plugin&gt; &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt; &lt;version&gt;3.1&lt;/version&gt; &lt;configuration&gt; &lt;source&gt;1.7&lt;/source&gt; //jdk1.7 &lt;target&gt;1.7&lt;/target&gt; //ç¼–è¯‘åŽjdk1.7 &lt;/configuration&gt; &lt;/plugin&gt; &lt;/plugins&gt;&lt;/build&gt; èšåˆï¼ˆå¤šæ¨¡å—ï¼‰æ„ä¹‰ï¼šä¸€æ¬¡æž„å»ºæ‰€æœ‰æƒ³è¦æž„å»ºçš„é¡¹ç›® 1234567891011&lt;project&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.son.nexus&lt;/groupId&gt; &lt;artifactId&gt;nexus-indexer&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;packaging&gt;pom&lt;/packaging&gt;//æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªmavenå·¥ç¨‹ &lt;modules&gt; &lt;module&gt;account-email&lt;/module&gt;//æƒ³è¦æž„å»ºçš„é¡¹ç›®ï¼Œè¿™é‡Œå†™çš„æ˜¯å½“å‰pomæ–‡ä»¶ä¸‹çš„ç›¸å¯¹è·¯å¾„åœ°å€ &lt;module&gt;account-persilist&lt;/module&gt; &lt;/modules&gt;&lt;/project&gt; èšåˆpomæ–‡ä»¶çš„packagingæ ‡ç­¾ä¸€å®šè¦æ˜¯pomï¼Œå…¶å·¥ç¨‹å°±åªæ˜¯ä¸€ä¸ªpomæ–‡ä»¶ï¼Œæ²¡æœ‰å…¶ä»–çš„å®žçŽ°ä»£ç  ä¸€èˆ¬æ¥è¯´æ¨¡å—å¤„çš„ç›®å½•ååº”ä¸Žå…¶artifactIdä¸€è‡´ èšåˆæ¨¡å—ä¸Žå…¶ä»–æ¨¡å—çš„ç›®å½•ç»“æž„å¹¶éžä¸€å®šè¦çˆ¶å­å…³ç³» ç»§æ‰¿çˆ¶pom 12345678910111213141516171819202122232425&lt;project&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.son.nexus&lt;/groupId&gt; &lt;artifactId&gt;nexus-indexer&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;packaging&gt;pom&lt;/packaging&gt;//æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªmavenå·¥ç¨‹ &lt;dependencies&gt; &lt;dependency&gt; &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-B&lt;/artifactId&gt; &lt;version&gt;1.0.0&lt;/version&gt; &lt;exclusions&gt; &lt;exclusion&gt; &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-C&lt;/artifactId&gt; &lt;/exclusion&gt; &lt;/exclusions&gt; &lt;/dependency&gt; &lt;dependency&gt; &lt;groupId&gt;com.juv&lt;/groupId&gt; &lt;artifactId&gt;project-B&lt;/artifactId&gt; &lt;version&gt;1.1.0&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/project&gt; çˆ¶pomçš„packagingä¹Ÿæ˜¯pom å­pom 12345678910111213&lt;project&gt; &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt; &lt;groupId&gt;org.son.nexus&lt;/groupId&gt; &lt;artifactId&gt;nexus-B&lt;/artifactId&gt; &lt;version&gt;2.0.0&lt;/version&gt; &lt;packaging&gt;jar&lt;/packaging&gt; &lt;parent&gt; &lt;groupId&gt;org.son.nexus&lt;/groupId&gt; &lt;artifactId&gt;nexus-C&lt;/artifactId&gt; &lt;version&gt;1.0.0-SNAPSHOT&lt;/version&gt; &lt;relativePath&gt;../pom.xml&lt;/relativePath&gt;//ç›¸å¯¹è·¯å¾„ &lt;/parent&gt;&lt;/project&gt; å­pomçš„packagingåˆ™ä¸ä¸€å®šè¦æ˜¯pomï¼Œä½†ä¸€å®šæœ‰parentæ ‡ç­¾ å­ç±»çš„groupIdå’Œversionä¹Ÿå¯ä»¥ç»§æ‰¿ä¸Žçˆ¶pomæ–‡ä»¶ æ ‡ç­¾ä½œç”¨ï¼šå½“å­ç±»ä¸éœ€è¦çˆ¶pomä¸­çš„æŸäº›ä¾èµ–çš„æ—¶ï¼Œå°±å¯ä»¥ä½¿ç”¨ã€‚ çˆ¶pom 123456789&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; è¢«æ ‡ç­¾æ‰€åŒ…è£¹çš„ä¾èµ–æ˜¯ä¸ä¼šä¸»åŠ¨è¢«åŠ è½½è¿›å…¥å­pomä¸­ï¼Œåªæœ‰å­pomä¸­æ˜¾å¼å†æ¬¡å£°æ˜Žçš„æ—¶å€™æ‰ä¼šè¢«ä¾èµ– å­pom 123456&lt;dependencies&gt; &lt;dependency&gt; &lt;artifactId&gt;spring-core&lt;/artifactId&gt; &lt;groupId&gt;org.springframework&lt;/groupId&gt; &lt;/dependency&gt;&lt;/dependencies&gt; å¯ä»¥çœç•¥versionç­‰å…¶ä»–é…ç½®ï¼Œå› ä¸ºçˆ¶pomä¸­å·²ç»é…ç½®è¿‡äº† è‹¥æƒ³èŽ·å–çˆ¶pomä¸­æ‰€æœ‰çš„dependencyManagementä¸­çš„æž„ä»¶é…ç½®ï¼Œåˆ™åœ¨å­pomä¸­å¦‚ä¸‹é…ç½® 1234567891011&lt;dependencyManagement&gt; &lt;dependencies&gt; &lt;dependency&gt; &lt;artifactId&gt;account-parent&lt;/artifactId&gt; &lt;groupId&gt;com.juvenxu.accout&lt;/groupId&gt; &lt;version&gt;3.1.1.RELEASE&lt;/version&gt; &lt;type&gt;pom&lt;/type&gt; &lt;scope&gt;import&lt;/scope&gt; &lt;/dependency&gt; &lt;/dependencies&gt;&lt;/dependencyManagement&gt; é…ç½®çˆ¶pomçš„ä¸€äº›ä¿¡æ¯ æ’ä»¶ç®¡ç†çˆ¶pomä¸­çš„æ’ä»¶ä¸æƒ³åœ¨å­ç±»ä¸­é»˜è®¤ä½¿ç”¨ è·Ÿä¾èµ–ç®¡ç†ä¸€æ ·ï¼Œè¢«åŒ…è£¹çš„æ’ä»¶é…ç½®ä¸ä¼šè¢«å­pomä¸»åŠ¨èŽ·å–ï¼Œåªæœ‰å½“å­pomä¸­å£°æ˜Žäº†è¯¥æ’ä»¶çš„groupIdå’ŒartifactIdåŽï¼Œæ‰ä¼šè¢«ç»§æ‰¿ ä¸€ä¸ªpomæ–‡ä»¶æ—¢å¯ä»¥æ˜¯èšåˆä¹Ÿå¯ä»¥æ˜¯çˆ¶pom ååº”å †åœ¨èšåˆæž„å»ºæ—¶ï¼Œæž„ä»¶æ¨¡å—çš„å…ˆåŽé¡ºåºçš„æŽ’åˆ—ã€‚ æŒ‰ä¹¦å†™çš„å…ˆåŽé¡ºåºè¿›è¡Œæž„å»º åŠ æ–™åŒºå¦‚æžœåŒä¸€ä¸ªé¡¹ç›®ä¸­å­˜åœ¨å¤šä¸ªæ¨¡å—ç›¸äº’ä¾èµ–æ—¶å€™ï¼Œversionå’ŒgroupIdå¯ä»¥ä½¿ç”¨\${project.groupId}ï¼ˆå½“å‰æ¨¡å—çš„groupIdï¼‰å’Œ${project.verison}ï¼Œè¿™æ ·å°±ä¸ç”¨ä¸æ–­çš„æ›´æ”¹äº†ã€‚ æ ‡ç­¾ç”¨æ¥ç¡®å®šæœ€ç»ˆåŒ…å ä»¥ä¸Šã§ã™(Ending) ã‚ã‚ŠãŒã©ã†(Thank You)]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¶…è¶Šsublimeçš„Visual Studio Code]]></title>
    <url>%2F2016%2F04%2F20%2Ffist%2F</url>
    <content type="text"><![CDATA[åœ¨ Build 2015 å¤§ä¼šä¸Šï¼Œå¾®è½¯é™¤äº†å‘å¸ƒäº† æ–°çš„ Windows 10 ç³»ç»Ÿå¤–ï¼Œæœ€å¤§çš„æƒŠå–œèŽ«è¿‡äºŽå®£å¸ƒæŽ¨å‡ºå…è´¹è·¨å¹³å°çš„ Visual Studio Code ç¼–è¾‘å™¨äº†ï¼ç»è¿‡ä¸€å¹´çš„æ›´æ–°æ¢ä»£ï¼ŒçŽ°åœ¨è¿Žæ¥1.0æ­£å¼ç‰ˆã€‚ å…¶åŠŸèƒ½éžå¸¸å¼ºå¤§ï¼Œç”šè‡³å¯ä»¥è¯´æ¯”Sublimeè¿˜è¦å¼ºå¤§ã€‚åŠŸèƒ½åˆ—è¡¨ï¼š è¯­æ³•é«˜äº® ä»£ç è¡¥å…¨ æ‹¬å·è‡ªåŠ¨åŒ¹é… ä»£ç å¯¹æ¯” Diff(æˆ‘çš„æœ€çˆ±) GIT æ”¯æŒæ’ä»¶å®‰è£… è‡ªå®šä¹‰çƒ­é”® ä»£ç ç‰‡æ®µ ä»£ç è°ƒè¯• èµ„æºç®¡ç† æ”¯æŒå•å±åŒæ—¶æ˜¾ç¤ºå¤šä¸ªé¡µé¢ï¼ˆCTRL+Cåˆ©å™¨ï¼‰ æ”¯æŒå›¾ç‰‡çš„æµè§ˆ è€Œä¸”æ”¯æŒä¸­æ–‡ï¼ˆè‰¯å¿ƒå•Šï¼‰ æ”¯æŒä¸»é¢˜æ›´æ¢ ä»£ç Fomat ä»¥ä¸Šçš„åŠŸèƒ½ï¼Œä½œä¸ºç¨‹åºå‘˜çš„ä½ è‚¯å®šå°±ä¼šæœ‰å†²åŠ¨åŽ»ä¸‹è½½ä¸€ä¸ªè¯•è¯•äº†ï¼ å¦‚æžœä½ æ˜¯Linuxçš„ç”¨æˆ·ï¼Œåˆ«æ‹…å¿ƒï¼Œå®ƒæ”¯æŒä¸‰å¤§ç³»ç»Ÿã€‚ Visual Studio Codeåœ¨ä½¿ç”¨è¿‡åŽï¼Œå®Œå…¨è§‰å¾—çš„å°±æ˜¯ä¸€ä¸ªIDEï¼ŒçœŸçš„å®ƒå¼ºå¤§ï¼Œè€Œä¸”è½¯ä»¶æ˜¯ç§’å¼€çš„ã€‚ å®ƒå€¼å¾—ä½ æ‹¥æœ‰ï¼ ä»¥ä¸Šã§ã™(Ending) ã‚ã‚ŠãŒã©ã†(Thank You)]]></content>
      <tags>
        <tag>it</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[æ•™ä½ å¦‚ä½•å»ºé«˜é€¼æ ¼ä¸ªäººç½‘ç«™]]></title>
    <url>%2F2016%2F04%2F20%2Foctopress%2F</url>
    <content type="text"><![CDATA[ä»Žå¤§å­¦å¼€å§‹æˆ‘å°±å¸Œæœ›èƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ä¸ªäººç½‘ç«™ï¼Œè§‰å¾—é‚£æ ·çœŸçš„å¾ˆé…·ï¼Œå°±è‡ªå­¦äº†HTMLå’ŒJavaç¼–ç¨‹ï¼Œä»Žæ­¤è¸ä¸Šäº†ç å†œæ¬ç –çš„ä¸å½’è·¯ã€‚ã€‚ã€‚ã€‚çŽ°å¦‚ä»Šï¼Œå»ºä¸€ä¸ªç½‘ç«™çš„æˆæœ¬çœŸçš„æ˜¯å¤ªä½Žäº†ï¼Œç‰¹åˆ«æ˜¯æœ‰äº†GitHubä»¥åŽï¼Œä¸æ‡‚ä»£ç çš„å­©å­éƒ½å¯ä»¥è‡ªå·±å»ºç«™äº†ã€‚å¥½ï¼ŒåºŸè¯å°±æ”¾åˆ°æœ€åŽè¯´ã€‚ ä¸€ã€Gitå®‰è£…é…ç½®1ã€å®‰è£…Gitè½¯ä»¶ 2ã€åœ¨Githubä¸Šæ³¨å†Œä¸€ä¸ªå¸å· åœ°å€ï¼šGithub 3ã€åœ¨æ¡Œé¢æ‰“å¼€Gitï¼Œè¿›è¡Œè®¾ç½® 12git config --global user.name "username"//githubçš„å¸å·ågit config --global user.email "username@163.com"//githubçš„é‚®ç®±åœ°å€ 4ã€ç”Ÿæˆsshå¯†é’¥ 1ssh-keygen -t rsa -C "username@163.com"//githubé‚®ç®±åœ°å€ æŽ¥ç€ä¼šæé†’ä½ è¾“å…¥åå­—å’Œå¯†ç ï¼Œå¯ä»¥ä¸ºç©ºä¼šåœ¨Cç›˜çš„è¯¥ç”µè„‘ç”¨æˆ·ä¸‹é¢ç”Ÿæˆä¸€ä¸ª.sshæ–‡ä»¶ï¼Œå…¶ä¸­çš„id_rsaå’Œid_rsa.pubï¼Œid_rsaè¦å¥½å¥½ä¿å­˜ï¼Œid_rsa.pubç”¨æ¥åœ¨githubç½‘ç«™åšé…ç½®ç”¨ 5ã€é…ç½®github ä½¿ç”¨Add SSH keyï¼Œtittleå¯ä»¥éšæ„è¾“ï¼Œå°†id_rsa.pubä¸­çš„å¯†é’¥ä¿å­˜åˆ°è¿™é‡Œè®¾ç½®å®ŒæˆåŽï¼Œå¯ä»¥åœ¨æœ¬åœ°è¾“å…¥ 1ssh -T git@github.com å…¶ä¼šå°†githubä¸­çš„å…¬é’¥ä¸Žæœ¬åœ°çš„ç§é’¥è¿›è¡ŒåŒ¹é…ï¼ŒæˆåŠŸåˆ™ä¼šè¿”å›žæˆåŠŸä¿¡æ¯ äºŒã€å®‰è£…Ruby1ã€åœ¨å®‰è£…Rubyæ—¶ä¸€å®šè¦å‹¾é€‰Add RubyExcutables to your Pathï¼Œå¦åˆ™è‡ªå·±è¦é…ç½®çŽ¯å¢ƒå˜é‡2ã€æŸ¥çœ‹æ˜¯å¦å®‰è£…æˆåŠŸ 1ruby -v ä¸‰ã€å®‰è£…devkitå››ã€å°†Rubyä¸Ždevkitå…³è”èµ·æ¥1ã€åœ¨devkitå®‰è£…ç›®å½•ä¸‹ 1ruby dk.rb init ä¼šç”Ÿæˆä¸€ä¸ªconfig.ymlæˆåŠŸçš„æƒ…å†µä¸‹åœ¨è¯¥æ–‡ä»¶ä¸‹é¢ä¼šæœ‰ä¸€è¡Œæ˜¯å…³äºŽrubyçš„å®‰è£…è·¯å¾„çš„æ•°æ®å¦‚æžœå¤±è´¥ä¹Ÿæ²¡äº‹ï¼Œåªè¦é€šè¿‡æ‰‹åŠ¨è¾“å…¥å°±è¡Œäº† 2ã€åœ¨devkitå®‰è£…ç›®å½•ä¸‹ 1ruby dk.rb install äº”ã€å®‰è£…é…ç½®octopress1ã€å…‹éš†octopressï¼Œåˆ‡æ¢åˆ°è‡ªå·±è¦å®‰è£…çš„æ–‡ä»¶ä¸‹ 1git clone git://github.com/imathis/octopress.git octopress 2ã€åœ¨octopressçš„æ–‡ä»¶æ ¹ç›®å½•ä¸‹ 1gen sources -a http://gems.ruby-china.org/ ä¸€ä¸ªå›½å†…çš„è½¯ä»¶æºç§»é™¤è‡ªå¸¦çš„è½¯ä»¶æºï¼Œå› ä¸ºåœ¨å›½å†…ä¼šè¢«å¢™ 1gem sources -r http://rubygems.org æŸ¥çœ‹è½¯ä»¶æº 1gem sources -l 3ã€ä¿®æ”¹octopressæ–‡ä»¶ä¸‹é¢çš„Gemfileæ–‡ä»¶ä¸­çš„sourceåœ°å€ï¼Œä¹Ÿæ”¹ä¸ºhttp://gems.ruby-china.org/å¦‚æžœä¸Šé¢çš„å‘½ä»¤å­˜åœ¨æ‰§è¡Œé”™è¯¯ï¼Œå¯ä»¥ä½¿ç”¨windowsè‡ªå¸¦çš„CMDå‘½ä»¤è¡ŒåŽ»æ‰§è¡Œ 4ã€åœ¨octopressä¸‹ 1gem install bundle è¿‡ç¨‹æœ‰ç‚¹é•¿ï¼Œä¼šæœ‰successfulæŽ¥ç€æ‰§è¡Œ 1bundle install è¿‡ç¨‹æœ‰ç‚¹é•¿æœ€åŽ 1rake install ä¼šç”Ÿæˆsourceå’Œpublicæ–‡ä»¶ï¼Œsourceæ˜¯æºä»£ç çš„æ–‡ä»¶ï¼Œè€Œpublicæ˜¯ç”Ÿæˆçš„æ–‡ä»¶ 5ã€ç¼–è¯‘octopress åœ¨octopressæ–‡ä»¶ä¸‹ 1rake generator è¯¥æŒ‡ä»¤ä¼šç¼–è¯‘ä¿®æ”¹çš„å†…å®¹ï¼Œç”Ÿæˆå¥½çš„æ–‡ä»¶ä¼šåœ¨publicæ–‡ä»¶ä¸‹ 6ã€è¿è¡Œ åœ¨octopressæ–‡ä»¶ä¸‹ 1rake preview ä¼šä½¿ç”¨4000ç«¯å£ï¼Œå¼€ä¸€ä¸ªæœåŠ¡ä½¿ç”¨localhost:4000è®¿é—® å…­ã€éƒ¨ç½²åˆ°Githubç½‘ç«™ä¸ŠåŽ»1ã€åœ¨Githubä¸­åˆ›å»ºä¸€ä¸ªusername.github.ioçš„ä»“åº“ï¼Œusernameä¸ºç”¨æˆ·è‡ªå·±çš„Githubå¸å·å 2ã€åœ¨octopressæ–‡ä»¶ä¸‹ 1rake setup_github_pages ä¼šæç¤ºä½ è¾“å…¥githubä¸­çš„gitåœ°å€ ä¼šåˆ›å»º_deployæ–‡ä»¶ï¼Œå¹¶ä¸”è·ŸGithubç»‘å®šå¥½äº†å¦‚æžœä¸Šé¢çš„æŒ‡ä»¤ä¸èµ·ä½œç”¨ï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„æ–¹å¼ 1rake setup_github_pages[githubä¸­username.github.ioä»“åº“çš„sshåœ°å€] 3ã€ä½¿ç”¨rake generator 4ã€ä½¿ç”¨rake deployï¼Œå°†æœ¬åœ°ç¼–è¯‘å¥½çš„æ–‡ä»¶ä¸Šä¼ åˆ°Githubä¸­ ä¸ƒã€å°†sourceç›®å½•ä»£ç ä¸Šä¼ åˆ°Githubåˆ†æ”¯123git add .git commit -m 'your message'//æ³¨é‡Šgit push origin source ç›¸å…³è½¯ä»¶ä¸‹è½½åœ°å€ï¼šè½¯ä»¶ å­¦ä¹ ç½‘ç«™ï¼šjekyll ä»¥ä¸Šã§ã™(Ending) ã‚ã‚ŠãŒã©ã†(Thank You)]]></content>
      <tags>
        <tag>code</tag>
      </tags>
  </entry>
</search>
